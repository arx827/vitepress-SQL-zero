import{_ as t,c as s,o as l,a}from"./app.12066fee.js";const g=JSON.parse('{"title":"第 3 章 彙總與排序","description":"","frontmatter":{"title":"第 3 章 彙總與排序"},"headers":[{"level":2,"title":"3-1 查詢時彙總資料","slug":"_3-1-查詢時彙總資料","link":"#_3-1-查詢時彙總資料","children":[{"level":3,"title":"彙總函數","slug":"彙總函數","link":"#彙總函數","children":[]},{"level":3,"title":"計算資料表的紀錄筆數","slug":"計算資料表的紀錄筆數","link":"#計算資料表的紀錄筆數","children":[]},{"level":3,"title":"計算 NULL 以外的紀錄筆數","slug":"計算-null-以外的紀錄筆數","link":"#計算-null-以外的紀錄筆數","children":[]},{"level":3,"title":"求得總計","slug":"求得總計","link":"#求得總計","children":[]},{"level":3,"title":"求得平均值","slug":"求得平均值","link":"#求得平均值","children":[]},{"level":3,"title":"求得最大、最小值","slug":"求得最大、最小值","link":"#求得最大、最小值","children":[]},{"level":3,"title":"排除重複值再使用彙總函數 (DISTINCT 關鍵字)","slug":"排除重複值再使用彙總函數-distinct-關鍵字","link":"#排除重複值再使用彙總函數-distinct-關鍵字","children":[]}]},{"level":2,"title":"3-2 資料分群","slug":"_3-2-資料分群","link":"#_3-2-資料分群","children":[{"level":3,"title":"GROUP BY 子句","slug":"group-by-子句","link":"#group-by-子句","children":[]},{"level":3,"title":"彙總鍵包含 NULL 的狀況","slug":"彙總鍵包含-null-的狀況","link":"#彙總鍵包含-null-的狀況","children":[]},{"level":3,"title":"使用 WHERE 子句時 GROUP BY 的作用","slug":"使用-where-子句時-group-by-的作用","link":"#使用-where-子句時-group-by-的作用","children":[]},{"level":3,"title":"彙總函數與 GROUP BY 子句的常見錯誤","slug":"彙總函數與-group-by-子句的常見錯誤","link":"#彙總函數與-group-by-子句的常見錯誤","children":[]}]},{"level":2,"title":"3-3 對彙總結果指定條件","slug":"_3-3-對彙總結果指定條件","link":"#_3-3-對彙總結果指定條件","children":[{"level":3,"title":"HAVING子句","slug":"having子句","link":"#having子句","children":[]},{"level":3,"title":"可寫在 HAVING 子句的元素","slug":"可寫在-having-子句的元素","link":"#可寫在-having-子句的元素","children":[]},{"level":3,"title":"適合以 WHERE 子句取代 HAVING 子句的條件","slug":"適合以-where-子句取代-having-子句的條件","link":"#適合以-where-子句取代-having-子句的條件","children":[]}]},{"level":2,"title":"3-4 查詢結果排序","slug":"_3-4-查詢結果排序","link":"#_3-4-查詢結果排序","children":[{"level":3,"title":"ORDER BY 子句","slug":"order-by-子句","link":"#order-by-子句","children":[]},{"level":3,"title":"指定升冪或降冪","slug":"指定升冪或降冪","link":"#指定升冪或降冪","children":[]},{"level":3,"title":"指定多個排序鍵","slug":"指定多個排序鍵","link":"#指定多個排序鍵","children":[]},{"level":3,"title":"NULL 的順序","slug":"null-的順序","link":"#null-的順序","children":[]},{"level":3,"title":"使用欄位別名指定排序鍵","slug":"使用欄位別名指定排序鍵","link":"#使用欄位別名指定排序鍵","children":[]},{"level":3,"title":"ORDER BY 子句可使用的欄位","slug":"order-by-子句可使用的欄位","link":"#order-by-子句可使用的欄位","children":[]},{"level":3,"title":"請勿使用欄位編號","slug":"請勿使用欄位編號","link":"#請勿使用欄位編號","children":[]}]},{"level":2,"title":"自我練習","slug":"自我練習","link":"#自我練習","children":[]}],"relativePath":"guide/chapter_3.md"}'),e={name:"guide/chapter_3.md"},n=a(`<h1 id="第-3-章-彙總與排序" tabindex="-1">第 3 章 彙總與排序 <a class="header-anchor" href="#第-3-章-彙總與排序" aria-hidden="true">#</a></h1><h2 id="_3-1-查詢時彙總資料" tabindex="-1">3-1 查詢時彙總資料 <a class="header-anchor" href="#_3-1-查詢時彙總資料" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>計算資料表欄位的總計值或平均值等統計操作，需要利用彙總函數 (<code>Aggregate Function</code>、<code>Group Function</code>)</li><li>彙總函數的統計結果基本上會排除 <code>NULL</code>，不過，只有 COUNT 函數的「 <code>COUNT(*)</code> 」用法，會計算包含 <code>NULL</code> 的所有紀錄筆數。</li><li>排除重複值進行統計時，需要使用 <code>DISTINCT</code> 關鍵字。</li></ul></div><h3 id="彙總函數" tabindex="-1">彙總函數 <a class="header-anchor" href="#彙總函數" aria-hidden="true">#</a></h3><p>想利用 SQL 對資料執行某些操作或計算的時候，需要使用到名為「 <code>函數 (Function)</code> 」的輔助工具。</p><p>想執行 「 計算資料表總共有多少筆紀錄 」的操作時，可以使用 <code>COUNT 函數</code>，主要用來 <code>計算數量</code>。</p><p>SQL 還準備了許多可以用於統計資料的函數：</p><ul><li><code>COUNT</code>：計算資料表的紀錄筆數 (列數)。</li><li><code>SUM</code>：計算資料表數值欄位的總計。</li><li><code>AVG</code>：計算資料表數值欄位的平均值。</li><li><code>MAX</code>：列出資料表任意欄位全部資料的最大值。</li><li><code>MIN</code>：列出資料表任意欄位全部資料的最小值。</li></ul><p>這些統計用的函數稱為「 彙總函數 」。實際上所有的彙總函數，都具有將篩選目標的多筆資料輸出成 1 筆紀錄的功用。</p><h3 id="計算資料表的紀錄筆數" tabindex="-1">計算資料表的紀錄筆數 <a class="header-anchor" href="#計算資料表的紀錄筆數" aria-hidden="true">#</a></h3><p>以 <code>COUNT 函數</code> 來說，若輸入資料表的欄位，它便會輸出紀錄的筆數。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-1</p><p>計算所有紀錄筆數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">count</th></tr></thead><tbody><tr><td style="text-align:center;">8</td></tr></tbody></table></div><blockquote><p><code>COUNT( )</code> 中的星號(*)，代表「 所有欄位 」的意思。表示要把所有欄位傳遞給 COUNT 函數。</p></blockquote><p>傳遞給函數的數值資料稱為「 <code>參數(Parameter)</code> 」，</p><p>而函數輸出的數值資料稱為「 <code>回傳值(Return Value)</code> 」。</p><h3 id="計算-null-以外的紀錄筆數" tabindex="-1">計算 NULL 以外的紀錄筆數 <a class="header-anchor" href="#計算-null-以外的紀錄筆數" aria-hidden="true">#</a></h3><p>如果想要計算某個欄位除了 <code>NULL</code> 以外有多少筆紀錄的時候，則可以在括號中寫入查詢對象的欄位名稱。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-2</p><p>計算所有紀錄筆數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(buying_price)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">count</th></tr></thead><tbody><tr><td style="text-align:center;">6</td></tr></tbody></table></div><p>由於 <code>COUNT</code> 函數的參數若指定不同欄位將產生不同結果，所以撰寫時必須特別留意。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-3</p><p>只有 NULL 的資料表 (NullTbl)</p><table><thead><tr><th style="text-align:center;">col_1</th></tr></thead><tbody><tr><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"></td></tr></tbody></table><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">), </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(col_1)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> NullTbl;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">count</th><th style="text-align:center;">count</th></tr></thead><tbody><tr><td style="text-align:center;">3</td><td style="text-align:center;">0</td></tr></tbody></table><p>從上面的例子可以知道，即使是對相同的資料表同樣使用 <code>COUNT 函數</code>，也會因為不同的參數而獲得不同的結果。</p><p>以欄位名稱做為參數的時候，由於只會計算 <code>NULL</code> 以外的資料，所以得到 「 0 筆紀錄 」的結果。</p></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-1</p><p><code>COUNT 函數</code> 的參數不同將獲得不同的結果。</p><p><code>COUNT(*)</code> 會計算包含 <code>NULL</code> 的紀錄筆數，</p><p>而 <code>COUNT(欄位名稱)</code> 則會排除 <code>NULL</code> 的紀錄筆數。</p></div><h3 id="求得總計" tabindex="-1">求得總計 <a class="header-anchor" href="#求得總計" aria-hidden="true">#</a></h3><p><code>SUM 函數</code> 能算出總和。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-4</p><p>求得 販售單價 的總計</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(sell_price)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">sum</th></tr></thead><tbody><tr><td style="text-align:center;">16780</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">範例 3-5</p><p>求得 販售單價 和 購入單價 的總計</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(sell_price), </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(buying_price)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">sum</th><th style="text-align:center;">sum</th></tr></thead><tbody><tr><td style="text-align:center;">16780</td><td style="text-align:center;">12210</td></tr></tbody></table></div><blockquote><p>所有的 <code>彙總函數</code> 以參數形式接收欄位名稱的時候，在開始計算之前都會先排除 <code>NULL</code> 的資料，並不是把 <code>NULL</code> 當作 0 處理。</p></blockquote><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-2</p><p><code>彙總函數</code> 會排除 <code>NULL</code> 資料，不過只有「 <code>COUNT(*)</code> 」例外，不會排除 <code>NULL</code> 。</p></div><h3 id="求得平均值" tabindex="-1">求得平均值 <a class="header-anchor" href="#求得平均值" aria-hidden="true">#</a></h3><p><code>AVG 函數</code> 能求得平均值。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-6</p><p>求得 販售單價 的平均值</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">AVG</span><span style="color:#A6ACCD;">(sell_price)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">avg</th></tr></thead><tbody><tr><td style="text-align:center;">2097.5000000000000000</td></tr></tbody></table></div><p>其實就是一般 <code>(數值總計) / (數值個數)</code> 的 平均值計算公式。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-7</p><p>求得 販售單價 和 購入單價 的平均值</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">AVG</span><span style="color:#A6ACCD;">(sell_price), </span><span style="color:#82AAFF;">AVG</span><span style="color:#A6ACCD;">(buying_price)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">avg</th><th style="text-align:center;">avg</th></tr></thead><tbody><tr><td style="text-align:center;">2097.5000000000000000</td><td style="text-align:center;">2035.0000000000000000</td></tr></tbody></table></div><p>和 <code>SUM 函數</code> 的處理方式相同，會先排除 <code>NULL</code> 資料再進行計算。</p><h3 id="求得最大、最小值" tabindex="-1">求得最大、最小值 <a class="header-anchor" href="#求得最大、最小值" aria-hidden="true">#</a></h3><p>想在多筆紀錄中找出欄位的最大值和最小值，可以分別使用 <code>MAX</code> 和 <code>MIN</code> 的函數。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-8</p><p>求得 販售單價 的最大值、購入單價的最小值</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MAX</span><span style="color:#A6ACCD;">(sell_price), </span><span style="color:#82AAFF;">MIN</span><span style="color:#A6ACCD;">(buying_price)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">max</th><th style="text-align:center;">min</th></tr></thead><tbody><tr><td style="text-align:center;">6800</td><td style="text-align:center;">320</td></tr></tbody></table></div><blockquote><ul><li><code>SUM</code>、<code>AVG</code> 函數只能應用於數值型別的欄位。</li><li><code>MAX</code>、<code>MIN</code> 函數原則上可以適用各種資料型別的欄位。</li></ul></blockquote><div class="warning custom-block"><p class="custom-block-title">範例 3-9</p><p>求得 登錄日期 的最大值和最小值</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">MAX</span><span style="color:#A6ACCD;">(reg_date), </span><span style="color:#82AAFF;">MIN</span><span style="color:#A6ACCD;">(reg_date)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">max</th><th style="text-align:center;">min</th></tr></thead><tbody><tr><td style="text-align:center;">2009-11-11</td><td style="text-align:center;">2008-04-28</td></tr></tbody></table></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-3</p><p><code>MAX</code>、<code>MIN</code> 函數可以適用絕大部分的資料型別，而 <code>SUM</code>、<code>AVG</code> 函數僅適用於數值型別。</p></div><h3 id="排除重複值再使用彙總函數-distinct-關鍵字" tabindex="-1">排除重複值再使用彙總函數 (DISTINCT 關鍵字) <a class="header-anchor" href="#排除重複值再使用彙總函數-distinct-關鍵字" aria-hidden="true">#</a></h3><div class="warning custom-block"><p class="custom-block-title">範例 3-10</p><p>排除重複值再計算筆數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">DISTINCT</span><span style="color:#A6ACCD;"> shohin_catalg)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">count</th></tr></thead><tbody><tr><td style="text-align:center;">3</td></tr></tbody></table></div><blockquote><p><code>DISTINCT</code> 必須寫在函數名稱後方的括號之中，一開始先排除 <code>shohin_catalg</code> 欄位的重複值，然後再計算排除後的紀錄筆數。</p></blockquote><div class="danger custom-block"><p class="custom-block-title">範例 3-11</p><p>錯誤用法：先計算紀錄筆數再排除重複值</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT DISTINCT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(shohin_catalg)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">count</th></tr></thead><tbody><tr><td style="text-align:center;">8</td></tr></tbody></table></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-4</p><p>想計算內容值總類的數量時，需要對 <code>COUNT 函數</code> 的參數冠上 <code>DISTINCT</code>。</p></div><p><code>DISTINCT</code> 關鍵字，同樣適用於其他彙總函數。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-12</p><p>有無 DISTINCT 的差異 (SUM 函數)</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(sell_price), </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">DISTINCT</span><span style="color:#A6ACCD;"> sell_price)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">sum</th><th style="text-align:center;">sum</th></tr></thead><tbody><tr><td style="text-align:center;">16780</td><td style="text-align:center;">16280</td></tr></tbody></table><p>右側 加上了 <code>DISTINCT</code>，少了重複值的加總。</p></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-5</p><p>想排除重複值再進行彙總，需要對彙總函數的參數冠上 <code>DISTINCT</code>。</p></div><h2 id="_3-2-資料分群" tabindex="-1">3-2 資料分群 <a class="header-anchor" href="#_3-2-資料分群" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li><code>GROUP BY</code> 子句 可以像切蛋糕一樣把資料表區分切開。如果搭配彙總函數使用 <code>GROUP BY</code> 子句，便能先將資料「 按照各商品分類 」或「 按照個登錄日期 」等方式進行分群，再執行彙總計算。</li><li>彙總鍵包含 <code>NULL</code> 時，彙總之後的結果也會出現「 未知 」紀錄 (空白)。</li><li>搭配彙總函數使用 <code>GROUP BY</code> 子句的時候，必須注意下列 4 項重點： <ol><li><code>GROUP BY</code> 子句，只能指定寫在 <code>SELECT</code> 子句中的元素。</li><li><code>GROUP BY</code> 子句中，不能使用 <code>SELECT</code> 子句中取的別名。</li><li><code>GROUP BY</code> 子句，無法排序彙總結果。</li><li><code>WHERE</code> 子句中，不能寫入彙總函數。</li></ol></li></ul></div><h3 id="group-by-子句" tabindex="-1">GROUP BY 子句 <a class="header-anchor" href="#group-by-子句" aria-hidden="true">#</a></h3><p>意思是「按照～區分群組」。</p><div class="warning custom-block"><p class="custom-block-title">語法 3-1</p><p>以 GROUP BY 子句進行彙總</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱3</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, ...</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">資料表名稱</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱3</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, ...;</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">範例 3-13</p><p>按照各商品分類分別計算紀錄筆數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_catalg</th><th style="text-align:center;">count</th></tr></thead><tbody><tr><td>衣物</td><td style="text-align:center;">2</td></tr><tr><td>辦公用品</td><td style="text-align:center;">2</td></tr><tr><td>廚房用品</td><td style="text-align:center;">4</td></tr></tbody></table></div><p>先前沒有使用 <code>GROUP BY 子句</code> 的時候，<code>COUNT 函數</code> 的執行結果只有 1 行，這是因為沒有 <code>GROUP BY 子句</code> 的時候，整個資料表被視為單一的群組，而相對地使用 <code>GROUP BY 子句</code> 之後，資料表中的資料會先被區分成數個群組。</p><p><code>GROUP BY 子句</code> 中所指定的欄位稱為 <code>彙總鍵</code> 或 <code>群組化欄位</code>，這是用來指定如何分割資料表非常重要的欄位。</p><p><code>GROUP BY 子句</code> 會先將資料分組，然後 <code>COUNT 函數</code> 再分別計算每組分類的紀錄筆數。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-6</p><p><code>GROUP 子句</code> 是能分割資料表的刀子。</p></div><blockquote><p>SQL 子句的撰寫順序</p><ol><li><code>SELECT</code></li><li><code>FROM</code></li><li><code>WHERE</code></li><li><code>GROUP BY</code></li></ol></blockquote><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-7</p><p>SQL 敘述中的子句撰寫順序不可改變，不能任意更換！</p></div><h3 id="彙總鍵包含-null-的狀況" tabindex="-1">彙總鍵包含 NULL 的狀況 <a class="header-anchor" href="#彙總鍵包含-null-的狀況" aria-hidden="true">#</a></h3><div class="warning custom-block"><p class="custom-block-title">範例 3-14</p><p>按照各購入單價分別計算紀錄筆數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> buying_price, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> buying_price;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:right;">buying_price</th><th style="text-align:center;">count</th></tr></thead><tbody><tr><td style="text-align:right;"></td><td style="text-align:center;">2</td></tr><tr><td style="text-align:right;">320</td><td style="text-align:center;">1</td></tr><tr><td style="text-align:right;">500</td><td style="text-align:center;">1</td></tr><tr><td style="text-align:right;">5000</td><td style="text-align:center;">1</td></tr><tr><td style="text-align:right;">2800</td><td style="text-align:center;">2</td></tr><tr><td style="text-align:right;">790</td><td style="text-align:center;">1</td></tr></tbody></table><p>當彙總鍵中包含 <code>NULL</code> 資料的時候，所有的 <code>NULL</code> 都會被一併分類至名為「 <code>NULL</code> 」的資料群組。</p></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-8</p><p>彙總鍵包含 <code>NULL</code> 時，結果也會出現「 未知 」紀錄 (空白)。</p></div><h3 id="使用-where-子句時-group-by-的作用" tabindex="-1">使用 WHERE 子句時 GROUP BY 的作用 <a class="header-anchor" href="#使用-where-子句時-group-by-的作用" aria-hidden="true">#</a></h3><div class="warning custom-block"><p class="custom-block-title">語法 3-2</p><p>使用 <code>WHERE</code> 和 <code>GROUP BY</code> 子句進行彙總</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱3</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, ...,</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">資料表名稱</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">條件式</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱3</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, ...;</span></span>
<span class="line"></span></code></pre></div></div><p>會先按照 <code>WHERE 子句</code>所指定的條件留下符合的紀錄，然後再進行彙總的動作。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-15</p><p>合併使用 <code>WHERE</code> 和 <code>GROUP BY</code> 子句</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> buying_price, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> buying_price;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:right;">buying_price</th><th style="text-align:center;">count</th></tr></thead><tbody><tr><td style="text-align:right;">500</td><td style="text-align:center;">1</td></tr><tr><td style="text-align:right;">2800</td><td style="text-align:center;">1</td></tr></tbody></table><p>合併使用 <code>WHERE</code> 和 <code>GROUP BY</code> 子句時，<code>SELECT 敘述</code> 的執行順序：</p><p><code>FROM</code> -&gt; <code>WHERE</code> -&gt; <code>GROUP BY</code> -&gt; <code>SELECT</code>。</p></div><p>SQL 敘述，在外觀上的排列順序，與 DBMS 內部的執行順序並不一致。</p><h3 id="彙總函數與-group-by-子句的常見錯誤" tabindex="-1">彙總函數與 GROUP BY 子句的常見錯誤 <a class="header-anchor" href="#彙總函數與-group-by-子句的常見錯誤" aria-hidden="true">#</a></h3><ul><li><h4 id="常見錯誤-1-select-子句-中寫入多餘的欄位" tabindex="-1"><span class="red">常見錯誤 1</span> - <code>SELECT 子句</code> 中寫入多餘的欄位 <a class="header-anchor" href="#常見錯誤-1-select-子句-中寫入多餘的欄位" aria-hidden="true">#</a></h4><p>合併使用 <code>GROUP BY 子句</code> 和 <code>COUNT</code> 之類的彙總函數時，可以寫在 <code>SELECT 子句</code> 中的元素非常有限，實際上只有下列 3 種元素能寫入 <code>SELECT 子句</code>：</p><ul><li>常數</li><li>彙總函數</li><li><code>GROUP BY 子句</code> 所指定的欄位名稱 (亦即 <code>彙總鍵</code>)</li></ul><p><code>常數</code>：即 123 之類的數值、或 &#39;測試&#39; 這類的字串等。</p><p>將彙總鍵以外的欄位名稱寫入 <code>SELECT 子句</code> 中。在大部分的 DBMS 上執行會有錯誤，而在 <code>MySQL(MariaDB)</code> 則會得到不太正確的結果。</p><div class="danger custom-block"><p class="custom-block-title">範例 3-16</p><p>在 <code>SELECT 子句</code> 寫入彙總鍵以外的欄位名稱</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, buying_price, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> buying_price;</span></span>
<span class="line"></span></code></pre></div><p>執行結果 ( 在 MariaDB 上執行，購入單價為 <code>NULL</code> 的商品只有叉子，少列了刀子 )</p><table><thead><tr><th>shohin_name</th><th style="text-align:right;">buying_price</th><th style="text-align:center;">COUNT(*)</th></tr></thead><tbody><tr><td>叉子</td><td style="text-align:right;">NULL</td><td style="text-align:center;">2</td></tr><tr><td>打孔機</td><td style="text-align:right;">320</td><td style="text-align:center;">1</td></tr><tr><td>T恤</td><td style="text-align:right;">500</td><td style="text-align:center;">1</td></tr><tr><td>刨絲器</td><td style="text-align:right;">790</td><td style="text-align:center;">1</td></tr><tr><td>襯衫</td><td style="text-align:right;">2800</td><td style="text-align:center;">2</td></tr><tr><td>壓力鍋</td><td style="text-align:right;">5000</td><td style="text-align:center;">1</td></tr></tbody></table><p><code>GROUP BY 子句</code> 中沒有 <code>shohin_name</code> 這個欄位名稱，所以不能把 <code>shohin_name</code> 寫入 <code>SELECT 子句</code> 中。</p></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-9</p><p>使用 <code>GROUP BY 子句</code> 的時候，<code>SELECT 子句</code> 中不能寫入彙總鍵以外的欄位名稱。</p></div></li><li><h4 id="常見錯誤-2-group-by-子句-中寫入在-select-子句-取的別名" tabindex="-1"><span class="red">常見錯誤 2</span> - <code>GROUP BY 子句</code> 中寫入在 <code>SELECT 子句</code> 取的別名 <a class="header-anchor" href="#常見錯誤-2-group-by-子句-中寫入在-select-子句-取的別名" aria-hidden="true">#</a></h4><p>如果對 <code>SELECT 子句</code> 中的項目使用「 <code>AS</code> 」這個關鍵字，便能賦予顯示用的別名。 不過，<code>GROUP BY 子句</code> 中不能使用別名來代替原本的名稱，<code>SELECT 敘述</code> 將產生錯誤。</p><div class="danger custom-block"><p class="custom-block-title">範例 3-17</p><p><code>GROUP BY 子句</code> 使用欄位的別名，將產生錯誤</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> sc, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> sc;</span></span>
<span class="line"></span></code></pre></div><p>在 <code>GROUP BY 子句</code> 執行的時間點上，<code>DBMS</code> 尚未執行 <code>SELECT 子句</code> 的內容，不知道別名所代表的意義。</p><p>如果使用 <code>MySQL (MariaDB)</code>，這樣的寫法不會產生錯誤，此種寫法無法適用於所有的 <code>DBMS</code>，建議最好不要使用</p><p>執行結果 ( 在 MariaDB 上執行 )</p><table><thead><tr><th>sc</th><th style="text-align:center;">COUNT(*)</th></tr></thead><tbody><tr><td>衣物</td><td style="text-align:center;">2</td></tr><tr><td>辦公用品</td><td style="text-align:center;">2</td></tr><tr><td>廚房用品</td><td style="text-align:center;">4</td></tr></tbody></table></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-10</p><p><code>GROUP BY 子句</code> 不能使用 <code>SELECT 子句</code> 中賦予的別名。</p></div></li><li><h4 id="常見錯誤-3-group-by-子句-會排序其結果" tabindex="-1"><span class="red">常見錯誤 3</span> - <code>GROUP BY 子句</code> 會排序其結果？ <a class="header-anchor" href="#常見錯誤-3-group-by-子句-會排序其結果" aria-hidden="true">#</a></h4><p>使用 <code>GROUP BY 子句</code> 篩選結果時，這些紀錄的順序呈現是 <code>隨機決定</code> 的。</p><p>如果想要對其排列順序按照某種規則進行<code>排序</code>，必須在 <code>SELECT 敘述</code> 中，增加特定的語法。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-11</p><p>即使使用 <code>GROUP BY 子句</code>，畫面上的結果也不會進行排序。</p></div></li><li><h4 id="常見錯誤-4-將彙總函數寫在-where-子句-中" tabindex="-1"><span class="red">常見錯誤 4</span> - 將彙總函數寫在 <code>WHERE 子句</code> 中 <a class="header-anchor" href="#常見錯誤-4-將彙總函數寫在-where-子句-中" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">範例 3-18</p><p><code>GROUP BY 子句</code> 使用欄位的別名，將產生錯誤</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_catalg</th><th style="text-align:center;">COUNT(*)</th></tr></thead><tbody><tr><td>衣物</td><td style="text-align:center;">2</td></tr><tr><td>辦公用品</td><td style="text-align:center;">2</td></tr><tr><td>廚房用品</td><td style="text-align:center;">4</td></tr></tbody></table></div><p>再來或許會想要「 篩選出計算結果剛好有 2 筆紀錄的群組 」，為了在篩選時指定條件，可能會想到使用 <code>WHERE 子句</code>。</p><div class="danger custom-block"><p class="custom-block-title">範例 3-19</p><p>在 <code>WHERE 子句</code> 中，寫入彙總函數將會發生錯誤</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">ERROR </span><span style="color:#F78C6C;">1111</span><span style="color:#A6ACCD;"> (HY000): Invalid </span><span style="color:#F78C6C;">use</span><span style="color:#A6ACCD;"> of group </span><span style="color:#F78C6C;">function</span></span>
<span class="line"></span></code></pre></div><p>實際上，可以寫入 <code>COUNT</code> 等彙總函數的地方，</p><p>只有 <code>SELECT 子句</code> 和 <code>HAVING 子句</code> 以及 <code>ORDER BY 子句</code> 而已。</p></div><p><code>HAVING 子句</code> 便是可以對分群後的資料指定條件。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-12</p><p>可以寫入彙總函數的地方，只有 <code>SELECT 子句</code> 和 <code>HAVING 子句</code> 以及 <code>ORDER BY 子句</code>。</p></div></li></ul><blockquote><h3 id="column-distinct-與-group-by" tabindex="-1">COLUMN - DISTINCT 與 GROUP BY <a class="header-anchor" href="#column-distinct-與-group-by" aria-hidden="true">#</a></h3><div class="warning custom-block"><p class="custom-block-title">範例 3-A</p><p>DISTINCT 和 GROUP BY 具有相同效果</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT DISTINCT</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 或</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_catalg</th></tr></thead><tbody><tr><td>衣物</td></tr><tr><td>辦公用品</td></tr><tr><td>廚房用品</td></tr></tbody></table></div><p><code>DISTINCT</code> 與 <code>GROUP BY</code> 子句，同樣會把 <code>NULL</code> 資料彙整在一起，而針對多個欄位進行篩選時的結果也完全相同，執行速度也幾乎不分上下。</p><ul><li>對於「 想從篩選結果排除重複資料 」的需求，應該採用 <code>DISTINCT</code>，</li><li>而對於「 想取得彙總後的結果 」的需求，應該選擇 <code>GROUP BY 子句</code>。</li></ul></blockquote><h2 id="_3-3-對彙總結果指定條件" tabindex="-1">3-3 對彙總結果指定條件 <a class="header-anchor" href="#_3-3-對彙總結果指定條件" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>使用 <code>COUNT</code> 等函數彙總資料表的資料時，若想對篩選結果指定條件，不能使用 <code>WHERE 子句</code>，必須改用 <code>HAVING 子句</code>。</li><li><code>彙總函數</code> 可以寫在 <code>SELECT 子句</code>、<code>HAVING 子句</code> 和 <code>ORDER BY 子句</code> 中。</li><li><code>HAVING 子句</code> 應該寫在 <code>GROUP BY 子句之後</code>。</li><li><code>WHERE 子句</code> 用來「 對紀錄指定條件 」，而 <code>HAVING 子句</code> 則是「 對資料群組指定條件 」。</li></ul></div><h3 id="having子句" tabindex="-1">HAVING子句 <a class="header-anchor" href="#having子句" aria-hidden="true">#</a></h3><p>對資料群組指定條件的方法。</p><p><code>WHERE 子句</code>，只能對「 各筆資料 」指定條件。</p><p>而想對分群後的資料指定條件，必須使用 <code>HAVING 子句</code> 來對資料群組指定條件。</p><div class="warning custom-block"><p class="custom-block-title">語法 3-3</p><p>HAVING 子句</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱3</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">,...</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">資料表名稱</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱3</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">,...</span></span>
<span class="line"><span style="color:#F78C6C;">HAVING</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">針對資料群組的條件</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span></code></pre></div></div><p><code>HAVING 子句</code> 的撰寫位置，必須在 <code>GROUP BY 子句</code> 之後。</p><p>使用 <code>HAVING 子句</code> 時，<code>SELECT 敘述</code> 的撰寫順序：</p><p><code>SELECT</code> -&gt; <code>FROM</code> -&gt; <code>WHERE</code> -&gt; <code>GROUP BY</code> -&gt; <code>HAVING</code>。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-13</p><p><code>HAVING 子句</code>，必須寫在 <code>GROUP BY 子句</code> 之後。</p></div><div class="warning custom-block"><p class="custom-block-title">範例 3-20</p><p>以商品分類進行分群彙總、篩選出「 當中含有 2 筆紀錄 」的群組</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">HAVING</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">) </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_catalg</th><th style="text-align:center;">count</th></tr></thead><tbody><tr><td>衣物</td><td style="text-align:center;">2</td></tr><tr><td>辦公用品</td><td style="text-align:center;">2</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">範例 3-21</p><p>沒有 HAVING 子句進行篩選的狀況</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_catalg</th><th style="text-align:center;">count</th></tr></thead><tbody><tr><td>衣物</td><td style="text-align:center;">2</td></tr><tr><td>辦公用品</td><td style="text-align:center;">2</td></tr><tr><td>廚房用品</td><td style="text-align:center;">4</td></tr></tbody></table></div><p>此次同樣以商品分類欄位進行分群，不過條件改為「 販售單價的平均值大於 2500 元 」。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-22</p><p>尚未加上 HAVING 子句進行篩選</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">AVG</span><span style="color:#A6ACCD;">(sell_price)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_catalg</th><th style="text-align:right;">avg</th></tr></thead><tbody><tr><td>衣物</td><td style="text-align:right;">2500.0000000000000000</td></tr><tr><td>辦公用品</td><td style="text-align:right;">300.0000000000000000</td></tr><tr><td>廚房用品</td><td style="text-align:right;">2795.0000000000000000</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">範例 3-23</p><p>以 HAVING 子句設定條件進行篩選</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">AVG</span><span style="color:#A6ACCD;">(sell_price)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">HAVING</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">AVG</span><span style="color:#A6ACCD;">(sell_price) </span><span style="color:#89DDFF;">&gt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2500</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_catalg</th><th style="text-align:right;">avg</th></tr></thead><tbody><tr><td>衣物</td><td style="text-align:right;">2500.0000000000000000</td></tr><tr><td>廚房用品</td><td style="text-align:right;">2795.0000000000000000</td></tr></tbody></table></div><h3 id="可寫在-having-子句的元素" tabindex="-1">可寫在 HAVING 子句的元素 <a class="header-anchor" href="#可寫在-having-子句的元素" aria-hidden="true">#</a></h3><p>與加上 <code>GROUP BY 子句</code> 的 <code>SELECT 子句</code> 相同，能寫入 <code>HAVING 子句</code> 的元素同樣有所限制，兩者限制完全相同：</p><ul><li>常數</li><li>彙總函數</li><li><code>GROUP BY 子句</code> 所指定的欄位名稱 (亦即 <code>彙總鍵</code>)</li></ul><div class="danger custom-block"><p class="custom-block-title">範例 3-21</p><p>HAVING 子句 的錯誤用法</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">HAVING</span><span style="color:#A6ACCD;"> shohin_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">鋼珠筆</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果 (於 MariaDB 上執行)</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">#</span><span style="color:#F78C6C;">1054</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> Unknown column </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">shohin_name</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">in</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">having clause</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div><p>由於 <code>GROUP BY 子句</code> 當中並沒有包含名為 <code>shohin_name (商品名稱)</code> 的欄位，因此不能將此欄位寫入 <code>HAVING 子句</code> 中。</p></div><p>當在使用 <code>HAVING 子句</code> 時，建議可以想成「 當分組彙總資料的前半段動作完成之後，<code>HAVING 子句</code> 是針對分組後的資料指定條件 」</p><h3 id="適合以-where-子句取代-having-子句的條件" tabindex="-1">適合以 WHERE 子句取代 HAVING 子句的條件 <a class="header-anchor" href="#適合以-where-子句取代-having-子句的條件" aria-hidden="true">#</a></h3><p>某些條件可以寫成 <code>HAVING 子句</code>，也可以寫成 <code>WHERE 子句</code>，而這樣的條件便是「 針對彙總鍵的條件 」。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-25</p><p>將條件寫成 HAVING 子句</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">HAVING</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_catalg</th><th style="text-align:center;">count</th></tr></thead><tbody><tr><td>衣物</td><td style="text-align:center;">2</td></tr></tbody></table></div><p>相同結果</p><div class="warning custom-block"><p class="custom-block-title">範例 3-26</p><p>將條件寫成 WHERE 子句的狀況</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_catalg</th><th style="text-align:center;">count</th></tr></thead><tbody><tr><td>衣物</td><td style="text-align:center;">2</td></tr></tbody></table></div><p><code>WHERE 子句</code> 和 <code>HAVING 子句</code> 基本上被賦予了不同的角色定位。</p><ul><li><code>WHERE 子句</code> = 對紀錄指定條件</li><li><code>HAVING 子句</code> = 對資料群組指定條件</li></ul><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-14</p><p>針對彙總鍵的條件應該寫成 <code>WHERE 子句</code>，而不是 <code>HAVING 子句</code>。</p></div><blockquote><h3 id="column-where-子句-與-having-子句-的執行速度" tabindex="-1">COLUMN - WHERE 子句 與 HAVING 子句 的執行速度 <a class="header-anchor" href="#column-where-子句-與-having-子句-的執行速度" aria-hidden="true">#</a></h3><ul><li><p>可以寫成 <code>WHERE 子句</code>、也能寫成 <code>HAVING 子句</code> 的條件，應該盡量選擇 <code>WHERE 子句</code> 的另外 1 個原因，便是效能上的考量，也就是執行速度上的差異。 <code>WHERE 子句</code> 的處理速度較快、取得結果所需的時間較短。</p></li><li><p>使用 <code>COUNT</code> 等函數來彙總資料表中的資料時，<code>DBMS</code> 內部需要進行「 排序 」的動作、排列各筆紀錄的先後順序，而這樣的排序處理會對硬體效能產生相當大的負擔，也就是屬於相當「 吃重 」的處理動作，因此，可以盡量減少需要排序的紀錄筆數，執行速度也會比較快。</p></li><li><p>若使用 <code>WHERE 子句</code> 來指定條件，因為進行排序前，會先挑選出符合的紀錄，所以進行排序的紀錄筆數較少，而另一方面，<code>HAVING 子句</code> 需要先完成排序、進行資料分群之後，才會按照條件挑選紀錄，因此需要排序更多的紀錄筆數。</p></li><li><p>而且，<code>WHERE 子句</code> 在速度上佔有優勢的另外 1 個理由，便是 <code>WHERE 子句</code> 條件中的欄位如果有建立「 索引 (Index) 」，那麼處理速度還可以獲得大幅度的提升。作為 <code>DBMS</code> 提升效能的方法，這項名為 <code>索引</code> 的技術相當普及，而且產生的效果相當顯著。</p></li></ul></blockquote><h2 id="_3-4-查詢結果排序" tabindex="-1">3-4 查詢結果排序 <a class="header-anchor" href="#_3-4-查詢結果排序" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>想要排列查詢結果需要使用 <code>ORDER BY 子句</code>。</li><li>在 <code>ORDER BY 子句</code> 的欄位名稱後方，可加上 <code>ASC</code> 關鍵字指定升冪順序，或加上 <code>DESC</code> 關鍵字指定降冪順序。</li><li><code>ORDER BY 子句</code> 當中可以指定多個排序鍵。</li><li>當排序鍵欄位含有 <code>NULL</code> 的資料時，會被統一放在最前或最後。</li><li><code>ORDER BY 子句</code> 中，可以使用 <code>SELECT 子句</code> 所取得的欄位別名。</li><li><code>ORDER BY 子句</code> 中，可以使用 <code>SELECT 子句</code> 所沒有的欄位和彙總函數。</li><li><code>ORDER BY 子句</code> 中，不能使用欄位編號。</li></ul></div><h3 id="order-by-子句" tabindex="-1">ORDER BY 子句 <a class="header-anchor" href="#order-by-子句" aria-hidden="true">#</a></h3><div class="warning custom-block"><p class="custom-block-title">範例 3-27</p><p>列出商品ID、商品名稱、販售單價和購入單價</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name, sell_price, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th style="text-align:right;">sell_price</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>0001</td><td>T恤</td><td style="text-align:right;">1000</td><td style="text-align:right;">500</td></tr><tr><td>0002</td><td>打孔機</td><td style="text-align:right;">500</td><td style="text-align:right;">320</td></tr><tr><td>0003</td><td>襯衫</td><td style="text-align:right;">4000</td><td style="text-align:right;">2800</td></tr><tr><td>0004</td><td>菜刀</td><td style="text-align:right;">3000</td><td style="text-align:right;">2800</td></tr><tr><td>0005</td><td>壓力鍋</td><td style="text-align:right;">6800</td><td style="text-align:right;">5000</td></tr><tr><td>0006</td><td>叉子</td><td style="text-align:right;">500</td><td style="text-align:right;"></td></tr><tr><td>0007</td><td>刨絲器</td><td style="text-align:right;">880</td><td style="text-align:right;">790</td></tr><tr><td>0008</td><td>鋼珠筆</td><td style="text-align:right;">100</td><td style="text-align:right;"></td></tr></tbody></table><p>乍看之下，似乎是由商品ID排序(升冪)，不過這只是偶然出現的狀況，排列順序其實是 <code>隨機決定</code> 的。</p></div><p>一般來說，從資料表篩選資料的時候，如果沒有特別指定順序，將無法預料各筆紀錄會按照什麼樣的順序排列，即使是完全相同的 <code>SELECT 敘述</code>，每次執行的時候或許都會獲得不同的排列順序。</p><p>可以在 <code>SELECT 敘述</code> 的最後加上 <code>ORDER BY 子句</code>，藉以明確指定各筆紀錄的排列順序。</p><div class="warning custom-block"><p class="custom-block-title">語法 3-4</p><p>ORDER BY 子句</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱3</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">,...</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">資料表名稱</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">排列基準的欄位名稱1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">排列基準的欄位名稱2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">,...;</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">範例 3-28</p><p>按照販售單價由低排至高 (升冪)</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name, sell_price, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> sell_price;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th style="text-align:right;">sell_price</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>0008</td><td>鋼珠筆</td><td style="text-align:right;">100</td><td style="text-align:right;"></td></tr><tr><td>0006</td><td>叉子</td><td style="text-align:right;">500</td><td style="text-align:right;"></td></tr><tr><td>0002</td><td>打孔機</td><td style="text-align:right;">500</td><td style="text-align:right;">320</td></tr><tr><td>0007</td><td>刨絲器</td><td style="text-align:right;">880</td><td style="text-align:right;">790</td></tr><tr><td>0001</td><td>T恤</td><td style="text-align:right;">1000</td><td style="text-align:right;">500</td></tr><tr><td>0004</td><td>菜刀</td><td style="text-align:right;">3000</td><td style="text-align:right;">2800</td></tr><tr><td>0003</td><td>襯衫</td><td style="text-align:right;">4000</td><td style="text-align:right;">2800</td></tr><tr><td>0005</td><td>壓力鍋</td><td style="text-align:right;">6800</td><td style="text-align:right;">5000</td></tr></tbody></table></div><p><code>ORDER BY 子句</code> 必須寫在整段 <code>SELECT 敘述</code> 的最後位置，對 <code>DBMS</code> 來說，排序各筆紀錄的步驟是回傳結果的最後 1 道手續。</p><p>寫在 <code>ORDER BY 子句</code> 中的欄位名稱，稱為「 排序鍵 」。</p><blockquote><p>子句的撰寫順序</p><ol><li><code>SELECT 子句</code></li><li><code>FROM 子句</code></li><li><code>WHERE 子句</code></li><li><code>GROUP BY 子句</code></li><li><code>HAVING 子句</code></li><li><code>ORDER BY 子句</code></li></ol></blockquote><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-15</p><p><code>ORDER BY 子句</code> 必定寫在 <code>SELECT 敘述</code> 的最後位置。</p></div><h3 id="指定升冪或降冪" tabindex="-1">指定升冪或降冪 <a class="header-anchor" href="#指定升冪或降冪" aria-hidden="true">#</a></h3><p><code>降冪</code> 的排序方式，在欄位名稱後方加上 <code>DESC</code> 關鍵字。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-29</p><p>按照販售單價由高排至低 (<code>降冪</code>)</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name, sell_price, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#F78C6C;">DESC</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th style="text-align:right;">sell_price</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>0005</td><td>壓力鍋</td><td style="text-align:right;">6800</td><td style="text-align:right;">5000</td></tr><tr><td>0003</td><td>襯衫</td><td style="text-align:right;">4000</td><td style="text-align:right;">2800</td></tr><tr><td>0004</td><td>菜刀</td><td style="text-align:right;">3000</td><td style="text-align:right;">2800</td></tr><tr><td>0001</td><td>T恤</td><td style="text-align:right;">1000</td><td style="text-align:right;">500</td></tr><tr><td>0007</td><td>刨絲器</td><td style="text-align:right;">880</td><td style="text-align:right;">790</td></tr><tr><td>0002</td><td>打孔機</td><td style="text-align:right;">500</td><td style="text-align:right;">320</td></tr><tr><td>0006</td><td>叉子</td><td style="text-align:right;">500</td><td style="text-align:right;"></td></tr><tr><td>0008</td><td>鋼珠筆</td><td style="text-align:right;">100</td><td style="text-align:right;"></td></tr></tbody></table></div><p>SQL 也備有名為 <code>ASC</code> 的關鍵字，不過沒有加上關鍵字的時候，預設即為 <code>升冪</code> 的排序方式。</p><p><code>ASC</code> 和 <code>DESC</code> 分別是英文單字 <code>Ascendent</code> 以及 <code>Descendent</code>。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-16</p><p><code>ORDER BY 子句</code> 沒有特別指定順序時，預設為 <code>升冪</code> 排序。</p></div><p>由於 <code>ASC</code> 和 <code>DESC</code> 關鍵字是分別附加在各欄位名稱之後，所以可以做到指定某個欄位為 <code>升冪</code>、同時另一個欄位 <code>降冪</code> 排序。</p><h3 id="指定多個排序鍵" tabindex="-1">指定多個排序鍵 <a class="header-anchor" href="#指定多個排序鍵" aria-hidden="true">#</a></h3><p>指定一個排序鍵時，當有相同值的先後順序，還是會獲得 <code>隨機決定</code> 的順序。</p><p>如果想針對這樣「 同順位 」的值，指定更加細緻的排列順序，需要再增加 1 個排序鍵。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-30</p><p>按照販售單價和商品 ID 做升冪排序</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name, sell_price, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> sell_price, shohin_id;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th style="text-align:right;">sell_price</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>0008</td><td>鋼珠筆</td><td style="text-align:right;">100</td><td style="text-align:right;"></td></tr><tr><td>0002</td><td>打孔機</td><td style="text-align:right;">500</td><td style="text-align:right;">320</td></tr><tr><td>0006</td><td>叉子</td><td style="text-align:right;">500</td><td style="text-align:right;"></td></tr><tr><td>0007</td><td>刨絲器</td><td style="text-align:right;">880</td><td style="text-align:right;">790</td></tr><tr><td>0001</td><td>T恤</td><td style="text-align:right;">1000</td><td style="text-align:right;">500</td></tr><tr><td>0004</td><td>菜刀</td><td style="text-align:right;">3000</td><td style="text-align:right;">2800</td></tr><tr><td>0003</td><td>襯衫</td><td style="text-align:right;">4000</td><td style="text-align:right;">2800</td></tr><tr><td>0005</td><td>壓力鍋</td><td style="text-align:right;">6800</td><td style="text-align:right;">5000</td></tr></tbody></table></div><p><code>ORDER BY 子句</code> 中可以指定多個排序鍵，左側的排序鍵會被優先拿來排列順序，如果該排序鍵欄位具有相同的數值資料，再參考其右側的排序鍵完成第 2 階段的排序。</p><h3 id="null-的順序" tabindex="-1">NULL 的順序 <a class="header-anchor" href="#null-的順序" aria-hidden="true">#</a></h3><p>不能對 <code>NULL</code> 使用比較運算子，也就是說，無法排出 <code>NULL</code> 和數值之間的先後順序，也無法和文字和日期做比較，因此，如果指定含有 <code>NULL</code> 的欄位作為排序鍵，那麼 <code>NULL</code> 會被統一放在最前面或最後面的位置。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-31</p><p>按照 購入單價 做升冪排序</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name, sell_price, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> buying_price;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th style="text-align:right;">sell_price</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>0002</td><td>打孔機</td><td style="text-align:right;">500</td><td style="text-align:right;">320</td></tr><tr><td>0001</td><td>T恤</td><td style="text-align:right;">1000</td><td style="text-align:right;">500</td></tr><tr><td>0007</td><td>刨絲器</td><td style="text-align:right;">880</td><td style="text-align:right;">790</td></tr><tr><td>0003</td><td>襯衫</td><td style="text-align:right;">4000</td><td style="text-align:right;">2800</td></tr><tr><td>0004</td><td>菜刀</td><td style="text-align:right;">3000</td><td style="text-align:right;">2800</td></tr><tr><td>0005</td><td>壓力鍋</td><td style="text-align:right;">6800</td><td style="text-align:right;">5000</td></tr><tr><td>0006</td><td>叉子</td><td style="text-align:right;">500</td><td style="text-align:right;"></td></tr><tr><td>0008</td><td>鋼珠筆</td><td style="text-align:right;">100</td><td style="text-align:right;"></td></tr></tbody></table></div><p>放在最前面或最後面並沒有一定的準則，由於其中也有些 <code>DBMS</code> 允許自行指定排在前面或後面，建議可以查閱目前所使用 <code>DBMS</code> 的功能說明。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-17</p><p>排序鍵含有 <code>NULL</code> 的時候，<code>NULL</code> 會被統一放在最前或最後。</p></div><h3 id="使用欄位別名指定排序鍵" tabindex="-1">使用欄位別名指定排序鍵 <a class="header-anchor" href="#使用欄位別名指定排序鍵" aria-hidden="true">#</a></h3><p><code>GROUP BY 子句</code> 中不能使用在 <code>SELECT 子句</code> 命名的欄位別名，不過 <code>ORDER BY 子句</code> 中可以使用欄位的別名。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-32</p><p>ORDER BY 子句中可以使用欄位別名</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> id, shohin_name, sell_price </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> sp, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> sp, id;</span></span>
<span class="line"></span></code></pre></div><p>先按照販售單價 <code>升冪</code>、再按照商品ID <code>升冪</code>。</p><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th style="text-align:right;">sell_price</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>0008</td><td>鋼珠筆</td><td style="text-align:right;">100</td><td style="text-align:right;"></td></tr><tr><td>0002</td><td>打孔機</td><td style="text-align:right;">500</td><td style="text-align:right;">320</td></tr><tr><td>0006</td><td>叉子</td><td style="text-align:right;">500</td><td style="text-align:right;"></td></tr><tr><td>0007</td><td>刨絲器</td><td style="text-align:right;">880</td><td style="text-align:right;">790</td></tr><tr><td>0001</td><td>T恤</td><td style="text-align:right;">1000</td><td style="text-align:right;">500</td></tr><tr><td>0004</td><td>菜刀</td><td style="text-align:right;">3000</td><td style="text-align:right;">2800</td></tr><tr><td>0003</td><td>襯衫</td><td style="text-align:right;">4000</td><td style="text-align:right;">2800</td></tr><tr><td>0005</td><td>壓力鍋</td><td style="text-align:right;">6800</td><td style="text-align:right;">5000</td></tr></tbody></table></div><p><code>SELECT 敘述</code> 的內部執行順序：</p><p><code>FROM</code> -&gt; <code>WHERE</code> -&gt; <code>GROUP BY</code> -&gt; <code>HAVING</code> -&gt; <code>SELECT</code> -&gt; <code>ORDER BY</code>。</p><p><code>GROUP BY 子句</code> 執行的時間點，<code>DBMS</code> 還不知道 <code>SELECT 子句</code> 中，替欄位取的別名。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-18</p><p><code>ORDER BY 子句</code> 中可以使用在 <code>SELECT 子句</code> 取的欄位別名。</p></div><h3 id="order-by-子句可使用的欄位" tabindex="-1">ORDER BY 子句可使用的欄位 <a class="header-anchor" href="#order-by-子句可使用的欄位" aria-hidden="true">#</a></h3><p><code>ORDER BY 子句</code> 中，可以使用資料表的任意欄位當作排序鍵，即使該欄位沒有寫在 <code>SELECT 子句</code> 之中。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-33</p><p>SELECT 子句中沒有的欄位亦可寫入 ORDER BY 子句</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, sell_price, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> shohin_id;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th style="text-align:right;">sell_price</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>T恤</td><td style="text-align:right;">1000</td><td style="text-align:right;">500</td></tr><tr><td>打孔機</td><td style="text-align:right;">500</td><td style="text-align:right;">320</td></tr><tr><td>襯衫</td><td style="text-align:right;">4000</td><td style="text-align:right;">2800</td></tr><tr><td>菜刀</td><td style="text-align:right;">3000</td><td style="text-align:right;">2800</td></tr><tr><td>壓力鍋</td><td style="text-align:right;">6800</td><td style="text-align:right;">5000</td></tr><tr><td>叉子</td><td style="text-align:right;">500</td><td style="text-align:right;"></td></tr><tr><td>刨絲器</td><td style="text-align:right;">880</td><td style="text-align:right;">790</td></tr><tr><td>鋼珠筆</td><td style="text-align:right;">100</td><td style="text-align:right;"></td></tr></tbody></table></div><p>另外，<code>ORDER BY 子句</code> 中，也能使用彙總函數</p><div class="warning custom-block"><p class="custom-block-title">範例 3-34</p><p>彙總函數可以用於 ORDER BY 子句中</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> sshohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_catalg</th><th style="text-align:right;">count</th></tr></thead><tbody><tr><td>衣物</td><td style="text-align:right;">2</td></tr><tr><td>辦公用品</td><td style="text-align:right;">2</td></tr><tr><td>廚房用品</td><td style="text-align:right;">4</td></tr></tbody></table></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-19</p><p><code>ORDER BY 子句</code> 中，也能使用 <code>SELECT 子句</code> 中沒有的欄位以及彙總函數。</p></div><h3 id="請勿使用欄位編號" tabindex="-1">請勿使用欄位編號 <a class="header-anchor" href="#請勿使用欄位編號" aria-hidden="true">#</a></h3><p><code>ORDER BY 子句</code> 中，其實可以使用 <code>SELECT 子句</code> 中各欄位對應的 <code>欄位編號</code>。</p><p><code>欄位編號</code>，指的是對 <code>SELECT 子句</code> 的各欄位由左邊開始依序賦予 1、2、3、... 編號，例如：第 1 個欄位為編號 1、第 2 個欄位為編號 2。</p><div class="warning custom-block"><p class="custom-block-title">範例 3-35</p><p>ORDER BY 子句中可以使用欄位編號</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 指定欄位名稱</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name, sell_price, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#F78C6C;">DESC</span><span style="color:#A6ACCD;">, shohin_id;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 指定欄位編號</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name, sell_price, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">DESC</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 先按照 SELECT 子句 第 3 個欄位做 降冪、再按照 第 1 個欄位做 升冪排序</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th style="text-align:right;">sell_price</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>0005</td><td>壓力鍋</td><td style="text-align:right;">6800</td><td style="text-align:right;">5000</td></tr><tr><td>0003</td><td>襯衫</td><td style="text-align:right;">4000</td><td style="text-align:right;">2800</td></tr><tr><td>0004</td><td>菜刀</td><td style="text-align:right;">3000</td><td style="text-align:right;">2800</td></tr><tr><td>0001</td><td>T恤</td><td style="text-align:right;">1000</td><td style="text-align:right;">500</td></tr><tr><td>0007</td><td>刨絲器</td><td style="text-align:right;">880</td><td style="text-align:right;">790</td></tr><tr><td>0002</td><td>打孔機</td><td style="text-align:right;">500</td><td style="text-align:right;">320</td></tr><tr><td>0006</td><td>叉子</td><td style="text-align:right;">500</td><td style="text-align:right;"></td></tr><tr><td>0008</td><td>鋼珠筆</td><td style="text-align:right;">100</td><td style="text-align:right;"></td></tr></tbody></table></div><p>基於下列 2 點理由，建議避免使用此種寫法。</p><ul><li>這樣的 SQL 敘述 <code>不易閱讀</code>。</li><li>實際上，此項目編號的功能在 <code>SQL-92</code> 的規範中被列為「 將來應該刪除的功能 」，因此，即使現在沒有什麼問題，到了將來 <code>DBMS</code> 進行版本更新的時候，原本可以正常運作的 SQL 敘述可能會突然無法執行，導致嚴重的問題發生。</li></ul><div class="tip custom-block"><p class="custom-block-title">牢記的原則 3-20</p><p><code>ORDER BY 子句</code> 中請勿使用 <code>欄位編號</code>。</p></div><h2 id="自我練習" tabindex="-1">自我練習 <a class="header-anchor" href="#自我練習" aria-hidden="true">#</a></h2><ul><li><p>3.1 下列的 SELECT 敘述在語法上有誤，請指出所有有問題的地方。</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 此 SELECT 敘述有誤。</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(shohin_name)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> reg_date </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-01</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div><details class="details custom-block"><summary>練習</summary><ul><li>SELECT 子句中，SUM彙總函數的 shohin_name 無法加總，會得到 0</li><li>SELECT 子句 使用 GROUP BY 子句指定欄位以外的欄位 shohin_id，查詢結果會有誤</li><li>GROUP BY 必須寫在最後</li><li>使用 GROUP BY 後，WHERE 無意義</li></ul></details></li><li><p>3.2 請試著撰寫 <code>SELECT 敘述</code>，列出販售單價 (sell_price 欄位) 總合比購入單價 (buying_price 欄位) 總和 多 1.5倍的商品分類，執行後的結果應該如下所示。</p><table><thead><tr><th>shohin_catalg</th><th style="text-align:right;">sum</th><th style="text-align:right;">sum</th></tr></thead><tbody><tr><td>衣物</td><td style="text-align:right;">5000</td><td style="text-align:right;">3300</td></tr><tr><td>辦公用品</td><td style="text-align:right;">600</td><td style="text-align:right;">320</td></tr></tbody></table><details class="details custom-block"><summary>練習</summary><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(sell_price), </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(buying_price)</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">HAVING</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(buying_price) </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5000</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></details></li><li><p>3.3 假設您曾經執行過某段 <code>SELECT 敘述</code>，從 Shohin (商品) 資料表篩選出所有的紀錄，那個時候，您有利用 <code>ORDER BY 子句</code> 指定排序方式，不過現在卻忘記當時指定了什麼樣的規則，請參考下列的執行結果，思考一下該 <code>ORDER BY 子句</code> 的寫法。</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th>shohin_catalg</th><th>sell_price</th><th>buying_price</th><th>reg_date</th></tr></thead><tbody><tr><td>0003</td><td>襯衫</td><td>衣物</td><td>4000</td><td>2800</td><td></td></tr><tr><td>0008</td><td>鋼珠筆</td><td>辦公用品</td><td>100</td><td></td><td>2009-11-11</td></tr><tr><td>0006</td><td>叉子</td><td>廚房用品</td><td>500</td><td></td><td>2009-09-20</td></tr><tr><td>0001</td><td>T恤</td><td>衣物</td><td>1000</td><td>500</td><td>2009-09-20</td></tr><tr><td>0004</td><td>菜刀</td><td>廚房用品</td><td>3000</td><td>2800</td><td>2009-09-20</td></tr><tr><td>0002</td><td>打孔機</td><td>辦公用品</td><td>500</td><td>320</td><td>2009-09-11</td></tr><tr><td>0005</td><td>壓力鍋</td><td>廚房用品</td><td>6800</td><td>5000</td><td>2009-01-15</td></tr><tr><td>0007</td><td>刨絲器</td><td>廚房用品</td><td>880</td><td>790</td><td>2008-04-28</td></tr></tbody></table><details class="details custom-block"><summary>練習</summary><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> reg_date </span><span style="color:#F78C6C;">DESC</span><span style="color:#A6ACCD;">, sell_price;</span></span>
<span class="line"></span></code></pre></div></details></li></ul>`,151),o=[n];function p(c,d,i,r,C,y){return l(),s("div",null,o)}const A=t(e,[["render",p]]);export{g as __pageData,A as default};
