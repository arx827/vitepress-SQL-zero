import{_ as s,c as a,o as l,a as n}from"./app.12066fee.js";const D=JSON.parse('{"title":"第 6 章 函數、述詞、CASE 運算式","description":"","frontmatter":{"title":"第 6 章 函數、述詞、CASE 運算式"},"headers":[{"level":2,"title":"6-1 各式各樣的函數","slug":"_6-1-各式各樣的函數","link":"#_6-1-各式各樣的函數","children":[{"level":3,"title":"函數的類型","slug":"函數的類型","link":"#函數的類型","children":[]},{"level":3,"title":"數學函數","slug":"數學函數","link":"#數學函數","children":[]},{"level":3,"title":"字串函數","slug":"字串函數","link":"#字串函數","children":[]},{"level":3,"title":"日期函數","slug":"日期函數","link":"#日期函數","children":[]},{"level":3,"title":"轉換函數","slug":"轉換函數","link":"#轉換函數","children":[]}]},{"level":2,"title":"6-2 述詞","slug":"_6-2-述詞","link":"#_6-2-述詞","children":[{"level":3,"title":"什麼是述詞","slug":"什麼是述詞","link":"#什麼是述詞","children":[]},{"level":3,"title":"LIKE 述詞 - 搜尋相同的字串","slug":"like-述詞-搜尋相同的字串","link":"#like-述詞-搜尋相同的字串","children":[]},{"level":3,"title":"BETWEEN - 範圍搜尋","slug":"between-範圍搜尋","link":"#between-範圍搜尋","children":[]},{"level":3,"title":"IS NULL、IS NOT NULL - 判斷是否為 NULL","slug":"is-null、is-not-null-判斷是否為-null","link":"#is-null、is-not-null-判斷是否為-null","children":[]},{"level":3,"title":"IN 述詞 - OR 的簡便形式","slug":"in-述詞-or-的簡便形式","link":"#in-述詞-or-的簡便形式","children":[]},{"level":3,"title":"指定子查詢作為 IN 述詞的參數","slug":"指定子查詢作為-in-述詞的參數","link":"#指定子查詢作為-in-述詞的參數","children":[]},{"level":3,"title":"EXISTS 述詞","slug":"exists-述詞","link":"#exists-述詞","children":[]}]},{"level":2,"title":"6-3 CASE 運算式","slug":"_6-3-case-運算式","link":"#_6-3-case-運算式","children":[{"level":3,"title":"什麼是 CASE 運算式","slug":"什麼是-case-運算式","link":"#什麼是-case-運算式","children":[]},{"level":3,"title":"CASE 運算式的語法","slug":"case-運算式的語法","link":"#case-運算式的語法","children":[]},{"level":3,"title":"CASE 運算式的使用方式","slug":"case-運算式的使用方式","link":"#case-運算式的使用方式","children":[]}]},{"level":2,"title":"自我練習","slug":"自我練習","link":"#自我練習","children":[]}],"relativePath":"guide/chapter_6.md"}'),o={name:"guide/chapter_6.md"},p=n(`<h1 id="第-6-章-函數、述詞、case-運算式" tabindex="-1">第 6 章 函數、述詞、CASE 運算式 <a class="header-anchor" href="#第-6-章-函數、述詞、case-運算式" aria-hidden="true">#</a></h1><h2 id="_6-1-各式各樣的函數" tabindex="-1">6-1 各式各樣的函數 <a class="header-anchor" href="#_6-1-各式各樣的函數" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>函數按照其用途類別，大致上可分為 <code>數學函數</code>、<code>字串函數</code>、<code>日期函數</code>、<code>轉換函數</code>、以及 <code>彙總函數</code> 等類型。</li><li>由於函數的數量非常多，所以不必勉強全部記住，只要先學會經常使用的代表性函數，其他函數在需要的時候再查詢用法即可。</li></ul></div><h3 id="函數的類型" tabindex="-1">函數的類型 <a class="header-anchor" href="#函數的類型" aria-hidden="true">#</a></h3><p>所謂的函數，即是「 若 <code>輸入</code> 某個值，便會 <code>輸出</code> 對應值 」的功能。</p><p>此時的輸入值被稱為「 <code>參數 ( Parameter )</code> 」，而輸出的值則被稱為「 <code>回傳值</code> 」。</p><p>SQL 的函數大致上可分為下列幾種類型：</p><ul><li><code>數學函數</code> ( 用來計算數值的函數 )</li><li><code>字串函數</code> ( 用來操作字串的函數 )</li><li><code>日期函數</code> ( 用來操作日期的函數 )</li><li><code>轉換函數</code> ( 轉換資料型別或內容值的函數 )</li><li><code>彙總函數</code> ( 用來統計資料的函數 )</li></ul><h3 id="數學函數" tabindex="-1">數學函數 <a class="header-anchor" href="#數學函數" aria-hidden="true">#</a></h3><ul><li><code>+</code> ( 加法運算 )</li><li><code>-</code> ( 減法運算 )</li><li><code>*</code> ( 乘法運算 )</li><li><code>/</code> ( 除法運算 )</li></ul><p>因為這些運算子也具有「 針對輸入、回應輸出 」的功能，所以毫無疑問地屬於數學函數。</p><p>資料型別「 <code>NUMERIC (整體位數，小數位數)</code> 」的形式來指定數值大小。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-1</p><p>建立 SampleMath 資料表</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- DDL：建立資料表</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SampleMath</span></span>
<span class="line"><span style="color:#A6ACCD;">(m </span><span style="color:#C792EA;">NUMERIC</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">,</span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;"> n </span><span style="color:#C792EA;">NUMERIC</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;"> p </span><span style="color:#C792EA;">NUMERIC</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- DML：存入資料</span></span>
<span class="line"><span style="color:#F78C6C;">START TRANSACTION</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleMath(m, n, p) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleMath(m, n, p) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">-</span><span style="color:#F78C6C;">180</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleMath(m, n, p) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleMath(m, n, p) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">7</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleMath(m, n, p) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleMath(m, n, p) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleMath(m, n, p) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">8</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleMath(m, n, p) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">.</span><span style="color:#F78C6C;">27</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleMath(m, n, p) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">5</span><span style="color:#A6ACCD;">.</span><span style="color:#F78C6C;">555</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleMath(m, n, p) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleMath(m, n, p) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">8</span><span style="color:#A6ACCD;">.</span><span style="color:#F78C6C;">76</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">COMMIT</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">專用語法</p><p>各家 <code>DBMS</code> 交易功能的語法略有差異，如果在 <code>PostgreSQL</code> 或 <code>SQL Server</code> 執行 範例 6-1 的 <code>DML 敘述</code> 時，需要將「 <code>START TRANSACTION</code> 」改為「 <code>BEGIN TRANSACTION</code> 」，而在 <code>Oracle</code> 或 <code>DB2</code> 上執行的時候，不需要「 <code>START TRANSACTION</code> 」，直接刪除即可。</p></div><ul><li><h4 id="abs-絕對值" tabindex="-1">ABS - 絕對值 <a class="header-anchor" href="#abs-絕對值" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-1</p><p>ABS 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">ABS</span><span style="color:#A6ACCD;">(數值)</span></span>
<span class="line"></span></code></pre></div></div><p><code>ABS</code> 是能求得絕對值的函數，而 <code>絕對值 (Absolute Value)</code> 不考慮數值的正負，是用來表達和零之間距離大小的數值。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-2</p><p>求得數值的絕對值</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> m, </span><span style="color:#82AAFF;">ABS</span><span style="color:#A6ACCD;">(m) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> abs_col</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleMath;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:right;">m</th><th style="text-align:right;">abs_col</th></tr></thead><tbody><tr><td style="text-align:right;">500.000</td><td style="text-align:right;">500.000</td></tr><tr><td style="text-align:right;">-180.000</td><td style="text-align:right;">180.000</td></tr><tr><td style="text-align:right;"></td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;"></td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;"></td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;"></td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;">8.000</td><td style="text-align:right;">8.000</td></tr><tr><td style="text-align:right;">2.270</td><td style="text-align:right;">2.270</td></tr><tr><td style="text-align:right;">5.555</td><td style="text-align:right;">5.555</td></tr><tr><td style="text-align:right;"></td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;">8.760</td><td style="text-align:right;">8.760</td></tr></tbody></table></div></li><li><h4 id="mod-餘數" tabindex="-1">MOD - 餘數 <a class="header-anchor" href="#mod-餘數" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-2</p><p>MOD 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">MOD(被除數, 除數)</span></span>
<span class="line"></span></code></pre></div></div><p><code>MOD</code> 是用來求得除法運算餘數的函數，其名稱來自於 <code>Modulo</code> 的縮寫。它的使用方式若舉例來說，由於「 <code>7 ÷ 3</code> 」的餘數為 1，所以「 <code>MOD(7, 3)</code> = 1 」。另外，因為帶有小數的數值在運算上沒有「 餘數 」的概念，因此能適用 <code>MOD 函數</code>的只有 <code>整數型別</code> 的欄位。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-3</p><p>求得除法運算 (n ÷ p) 的餘數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> n, p, MOD(n, p) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> mod_col</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleMath;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">m</th><th style="text-align:center;">p</th><th style="text-align:center;">mod_col</th></tr></thead><tbody><tr><td style="text-align:center;">0</td><td style="text-align:center;"></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">0</td><td style="text-align:center;"></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">7</td><td style="text-align:center;">3</td><td style="text-align:center;">1</td></tr><tr><td style="text-align:center;">5</td><td style="text-align:center;">2</td><td style="text-align:center;">1</td></tr><tr><td style="text-align:center;">4</td><td style="text-align:center;"></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"></td><td style="text-align:center;">3</td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">1</td><td style="text-align:center;"></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">2</td><td style="text-align:center;"></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;">1</td><td style="text-align:center;"></td><td style="text-align:center;"></td></tr><tr><td style="text-align:center;"></td><td style="text-align:center;"></td><td style="text-align:center;"></td></tr></tbody></table></div><p>這裡需要特別注意的地方，在目前主要的各家 <code>DBMS</code> 之中，只有 <code>SQL Server</code> 無法使用此 <code>MOD 函數</code>。</p><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>SQL Server</code></p><p>想在 <code>SQL Server</code> 上求得餘數的時候，需要改用「 <code>%</code> 」這個特殊的運算符 (函數)，只要使用下列的 <code>SQL Server</code> 專用語法，便能獲得相同的結果，雖然有點麻煩。</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> n, p, n%p </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> mod_col</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleMath;</span></span>
<span class="line"></span></code></pre></div></div></li><li><h4 id="round-四捨五入" tabindex="-1">ROUND - 四捨五入 <a class="header-anchor" href="#round-四捨五入" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-3</p><p>ROUND 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">ROUND</span><span style="color:#A6ACCD;">(對象數值, 做捨入的小數位數)</span></span>
<span class="line"></span></code></pre></div></div><p>四捨五入可以透過名為 <code>ROUND</code> 的函數來完成。四捨五入是相當常見的數值簡化做法，英文中使用 <code>Round</code> 這個單字因而得名。如果指定做捨入的位數為 1，那麼會在小數第 1 位後面做捨入。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-4</p><p>對 m 欄位的數值在 n 欄位的位數作四捨五入</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> ｍ, n, </span><span style="color:#82AAFF;">ROUND</span><span style="color:#A6ACCD;">(m, n) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> round_col</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleMath;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:right;">m</th><th style="text-align:center;">n</th><th style="text-align:right;">round_col</th></tr></thead><tbody><tr><td style="text-align:right;">500.000</td><td style="text-align:center;">0</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">-180.000</td><td style="text-align:center;">0</td><td style="text-align:right;">-180</td></tr><tr><td style="text-align:right;"></td><td style="text-align:center;"></td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;"></td><td style="text-align:center;">7</td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;"></td><td style="text-align:center;">5</td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;"></td><td style="text-align:center;">4</td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;">8.000</td><td style="text-align:center;"></td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;">2.270</td><td style="text-align:center;">1</td><td style="text-align:right;">2.3</td></tr><tr><td style="text-align:right;">5.555</td><td style="text-align:center;">2</td><td style="text-align:right;">5.56</td></tr><tr><td style="text-align:right;"></td><td style="text-align:center;">1</td><td style="text-align:right;"></td></tr><tr><td style="text-align:right;">8.760</td><td style="text-align:center;"></td><td style="text-align:right;"></td></tr></tbody></table></div></li></ul><h3 id="字串函數" tabindex="-1">字串函數 <a class="header-anchor" href="#字串函數" aria-hidden="true">#</a></h3><p>為了便於練習字串函數的功能，需要另外建立名為 <code>SampleStr</code> 的資料表。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-5</p><p>建立 SampleStr 資料表</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- DDL：建立資料表</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SampleStr</span></span>
<span class="line"><span style="color:#A6ACCD;">(str1 </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">40</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;"> str2 </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">40</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;"> str3 </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">40</span><span style="color:#A6ACCD;">));</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>SQL Server</code>、<code>PostgreSQL</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- DML：存入資料</span></span>
<span class="line"><span style="color:#F78C6C;">START TRANSACTION</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleStr(str1, str2, str3) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">一二三</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">四五</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleStr(str1, str2, str3) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">def</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleStr(str1, str2, str3) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">山田</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">太郎</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">是也</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleStr(str1, str2, str3) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aaa</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleStr(str1, str2, str3) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">甲乙丙</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleStr(str1, str2, str3) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">@!#$%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleStr(str1, str2, str3) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ABC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleStr(str1, str2, str3) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aBC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleStr(str1, str2, str3) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abc 太郎</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ABC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleStr(str1, str2, str3) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abcdefabc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ABC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleStr(str1, str2, str3) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">言必信行必果</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">必</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">不</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">COMMIT</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>str1</th><th>str2</th><th>str3</th></tr></thead><tbody><tr><td>一二三</td><td>四五</td><td></td></tr><tr><td>abc</td><td>def</td><td></td></tr><tr><td>山田</td><td>太郎</td><td>是也</td></tr><tr><td>aaa</td><td></td><td></td></tr><tr><td></td><td>甲乙丙</td><td></td></tr><tr><td>@!#$%</td><td></td><td></td></tr><tr><td>ABC</td><td></td><td></td></tr><tr><td>aBC</td><td></td><td></td></tr><tr><td>abc 太郎</td><td>abc</td><td>ABC</td></tr><tr><td>abcdefabc</td><td>abc</td><td>ABC</td></tr><tr><td>言必信行必果</td><td>必</td><td>不</td></tr></tbody></table></div><ul><li><h4 id="concat-字串連接" tabindex="-1">CONCAT - 字串連接 <a class="header-anchor" href="#concat-字串連接" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-4</p><p>CONCAT 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">CONCAT</span><span style="color:#A6ACCD;">(字串1, 字串2, ...)</span></span>
<span class="line"></span></code></pre></div></div><p>在 <code>MySQL</code>、<code>MariaDB</code>、<code>SQL SERVER 2012 之後的版本</code>，可以使用 <code>CONCAT</code> 的函數</p><div class="warning custom-block"><p class="custom-block-title">範例 6-6</p><p>連接 2 個字串 (str1 + str2)</p><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code>、<code>SQL Server 2012 以後</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> str1, str2, </span><span style="color:#82AAFF;">CONCAT</span><span style="color:#A6ACCD;">(str1, str2) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> str_concat</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>str1</th><th>str2</th><th>str_concat</th></tr></thead><tbody><tr><td>一二三</td><td>四五</td><td>一二三四五</td></tr><tr><td>abc</td><td>def</td><td>abcdef</td></tr><tr><td>山田</td><td>太郎</td><td>山田太郎</td></tr><tr><td>aaa</td><td></td><td></td></tr><tr><td></td><td>甲乙丙</td><td></td></tr><tr><td>@!#$%</td><td></td><td></td></tr><tr><td>ABC</td><td></td><td></td></tr><tr><td>aBC</td><td></td><td></td></tr><tr><td>abc 太郎</td><td>abc</td><td>abc 太郎abc</td></tr><tr><td>abcdefabc</td><td>abc</td><td>abcdefabcabc</td></tr><tr><td>言必信行必果</td><td>必</td><td>言必信行必果必</td></tr></tbody></table></div><p>連接字串的時候，如果連接的對象當中有 <code>NULL</code>，那麼結果也必定為 <code>NULL</code>。另外，<code>CONCAT 函數</code> 也適用於連接 3 個以上的字串。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-7</p><p>連接 3 個字串 (str1 + str2 + str3)</p><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code>、<code>SQL Server 2012 以後</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> str1, str2, str3,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">CONCAT</span><span style="color:#A6ACCD;">(str1, str2, str3) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> str_concat</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> str1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">山田</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>str1</th><th>str2</th><th>str3</th><th>str_concat</th></tr></thead><tbody><tr><td>山田</td><td>太郎</td><td>是也</td><td>山田太郎是也</td></tr></tbody></table></div><p>這裡有個需要注意的地方，那便是 <code>Oracle</code> 的 <code>CONCAT 函數</code> 只能寫入 2 個參數 (1 次 只能連接 2 個字串)，而 <code>DB2</code>、<code>PostgreSQL</code> 和 <code>舊版的 SQL Server</code> 無法使用此函數。</p><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>Oracle</code>、<code>DB2</code>、<code>PostgreSQL</code>、<code>SQL Server</code></p><p>在 <code>Oracle</code>、<code>DB2</code>、<code>PostgreSQL</code> 連接字串的時候，請改用「 <code>||</code> 」這個運算子，</p><p>而 <code>SQL Server</code> 還可以使用「 <code>+</code> 」運算子，</p><p>這些運算子的作用和函數完全相同，因此亦可視為特殊形式的函數。</p><ul><li>專用語法：<code>Oracle</code>、<code>DB2</code>、<code>PostgreSQL</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> str1, str2, str3,</span></span>
<span class="line"><span style="color:#A6ACCD;">       str1 </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> str2 </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> str3 </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> str_concat</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> str1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">山田</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>SQL Server</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> str1, str2, str3,</span></span>
<span class="line"><span style="color:#A6ACCD;">       str1 </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> str2 </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> str3 </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> str_concat</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> str1 </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">山田</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div></li><li><h4 id="length-字串長度" tabindex="-1">LENGTH - 字串長度 <a class="header-anchor" href="#length-字串長度" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-5</p><p>LENGTH 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">LENGTH</span><span style="color:#A6ACCD;">(字串)</span></span>
<span class="line"></span></code></pre></div></div><p>想要查詢某個字串有幾個文字的時候，可以使用功能如同其名稱的 <code>LENGTH (長度) 函數</code>。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-8</p><p>查詢字串的長度</p><ul><li>專用語法：<code>Oracle</code>、<code>DB2</code>、<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> str1, </span><span style="color:#F78C6C;">LENGTH</span><span style="color:#A6ACCD;">(str1) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> len_str</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>str1</th><th style="text-align:center;">len_str</th></tr></thead><tbody><tr><td>一二三</td><td style="text-align:center;">3</td></tr><tr><td>abc</td><td style="text-align:center;">3</td></tr><tr><td>山田</td><td style="text-align:center;">2</td></tr><tr><td>aaa</td><td style="text-align:center;">3</td></tr><tr><td></td><td style="text-align:center;"></td></tr><tr><td>@!#$%</td><td style="text-align:center;">5</td></tr><tr><td>ABC</td><td style="text-align:center;">3</td></tr><tr><td>aBC</td><td style="text-align:center;">3</td></tr><tr><td>abc 太郎</td><td style="text-align:center;">5</td></tr><tr><td>abcdefabc</td><td style="text-align:center;">9</td></tr><tr><td>言必信行必果</td><td style="text-align:center;">6</td></tr></tbody></table></div><p>另外，請注意 <code>此 LENGTH 函數，無法在 SQL Server 上使用</code>。</p><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>SQL Server</code></p><p>取而代之地，<code>SQL Server</code> 準備了名為 <code>LEN</code> 的函數。</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> str1, </span><span style="color:#82AAFF;">LEN</span><span style="color:#A6ACCD;">(str1) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> len_str</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr;</span></span>
<span class="line"></span></code></pre></div></div></li></ul><blockquote><h3 id="column-也有-length-函數會將-1-個中文字的長度視為大於-1" tabindex="-1">COLUMN - 也有 LENGTH 函數會將 1 個中文字的長度視為大於 1 <a class="header-anchor" href="#column-也有-length-函數會將-1-個中文字的長度視為大於-1" aria-hidden="true">#</a></h3><ul><li><p>關於 <code>LENGTH 函數</code> 還有另外 1 個需要特別注意的事項，雖然這涉及了較為進階的內容，不過簡單來說就是 <code>LENGTH 函數</code> 以何種單位當作「 長度 1 」。</p></li><li><p>相對於 1 個半形英文字母會佔用 1 個 <code>位元組</code> 的空間，全形中文字在呈現上需要佔用 2 個或 2 個以上的位元組空間 (亦被稱為 <code>多位元組文字</code>)，因此，如果像 <code>MySQL</code> 或 <code>MariaDB</code> 這樣，其 <code>LENGTH 函數</code> 是以 1 個位元組來當作計算單位，那麼「 LENGTH(&#39;山田&#39;) 」將會回傳 4 的數值，即使是相同名稱的 <code>LENGTH 函數</code>，在不同的 <code>DBMS</code> 或環境狀況之下也可能得到不同的結果。</p><ul><li><code>MySQL</code> 和 <code>MariaDB</code> 另外備有以 文字數量為計算單位的 <code>CHAR_LENGTH 函數</code></li></ul></li><li><p>雖然容易造成混亂，不過還是請先記得可能會遇到這樣的狀況</p></li></ul></blockquote><ul><li><h4 id="lower-轉為小寫" tabindex="-1">LOWER - 轉為小寫 <a class="header-anchor" href="#lower-轉為小寫" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-6</p><p>LOWER 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">LOWER</span><span style="color:#A6ACCD;">(字串)</span></span>
<span class="line"></span></code></pre></div></div><p><code>LOWER</code> 是針對英文字母所設計的函數，能將參數的字串全部轉換成小寫，因此，英文字母以外的文字不會發生變化，而原本就是小寫的字母也不會受到影響。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-9</p><p>將大寫字母轉為小寫</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> str1, </span><span style="color:#82AAFF;">LOWER</span><span style="color:#A6ACCD;">(str1) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> low_str</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> str1 </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ABC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aBC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">山田</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>str1</th><th>low_str</th></tr></thead><tbody><tr><td>abc</td><td>abc</td></tr><tr><td>山田</td><td>山田</td></tr><tr><td>ABC</td><td>abc</td></tr><tr><td>aBC</td><td>abc</td></tr></tbody></table></div></li><li><h4 id="replace-字串置換" tabindex="-1">REPLACE - 字串置換 <a class="header-anchor" href="#replace-字串置換" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-7</p><p>REPLACE 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">REPLACE</span><span style="color:#A6ACCD;">(置換對象字串, 置換前的部分字串, 置換後的部分字串)</span></span>
<span class="line"></span></code></pre></div></div><p><code>REPLACE 函數</code> 的使用時機，在於想將字串中的部分字串，置換成其他字串的時候。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-10</p><p>置換字串中的部分文字</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> str1, str2, str3, </span><span style="color:#82AAFF;">REPLACE</span><span style="color:#A6ACCD;">(str1, str2, str3) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> rep_str</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>str1</th><th>str2</th><th>str3</th><th>rep_str</th></tr></thead><tbody><tr><td>一二三</td><td>四五</td><td></td><td></td></tr><tr><td>abc</td><td>def</td><td></td><td></td></tr><tr><td>山田</td><td>太郎</td><td>是也</td><td>山田</td></tr><tr><td>aaa</td><td></td><td></td><td></td></tr><tr><td></td><td>甲乙丙</td><td></td><td></td></tr><tr><td>@!#$%</td><td></td><td></td><td></td></tr><tr><td>ABC</td><td></td><td></td><td></td></tr><tr><td>aBC</td><td></td><td></td><td></td></tr><tr><td>abc 太郎</td><td>abc</td><td>ABC</td><td>ABC 太郎</td></tr><tr><td>abcdefabc</td><td>abc</td><td>ABC</td><td>ABCdefABC</td></tr><tr><td>言必信行必果</td><td>必</td><td>不</td><td>言不信行不果</td></tr></tbody></table></div></li><li><h4 id="substring-文字擷取" tabindex="-1">SUBSTRING - 文字擷取 <a class="header-anchor" href="#substring-文字擷取" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-8</p><p>SUBSTRING 函數</p><ul><li>專用語法 <code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">SUBSTRING</span><span style="color:#A6ACCD;">(擷取對象字串 </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> 擷取開始位置 FOR 擷取文字數量)</span></span>
<span class="line"></span></code></pre></div></div><p><code>SUBSTRING 函數</code> 用於從原本的字串擷取出一部分字串，參數中的 <code>擷取開始位置</code> 指的是「 從左邊起算的第幾個文字 」。</p><ul><li>不過請注意，這和 <code>LENGTH 函數</code> 同樣有多位元組文字的問題存在。</li></ul><div class="warning custom-block"><p class="custom-block-title">範例 6-11</p><p>擷取出字串左邊起算的第 3 和 第 4 個文字</p><ul><li>專用語法：<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> str1, </span><span style="color:#82AAFF;">SUBSTRING</span><span style="color:#A6ACCD;">(str1 </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;"> FOR </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> sub_str</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>str1</th><th>sub_str</th></tr></thead><tbody><tr><td>一二三</td><td>三</td></tr><tr><td>abc</td><td>c</td></tr><tr><td>山田</td><td></td></tr><tr><td>aaa</td><td>a</td></tr><tr><td></td><td></td></tr><tr><td>@!#$%</td><td>#$</td></tr><tr><td>ABC</td><td>C</td></tr><tr><td>aBC</td><td>C</td></tr><tr><td>abc 太郎</td><td>c 太</td></tr><tr><td>abcdefabc</td><td>cd</td></tr><tr><td>言必信行必果</td><td>信行</td></tr></tbody></table></div><p>此 <code>SUBSTRING 函數</code> 雖然是標準 SQL 所認可的正式語法，不過在目前的時間點上，只有 <code>PostgreSQL</code>、<code>MySQL</code> 和 <code>MariaDB</code> 能使用此函數。</p><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>SQL Server</code>、<code>Oracle</code>、<code>DB2</code></p><p><code>SQL Server</code> 採用了稍微簡略一些的語法。</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">SUBSTRING</span><span style="color:#A6ACCD;">(擷取對象字串, 擷取開始位置, 擷取文字數量)</span></span>
<span class="line"></span></code></pre></div><p>而 <code>Oracle</code> 和 <code>DB2</code> 改採更為簡略的語法。</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">SUBSTR(擷取對象字串, 擷取開始位置, 擷取文字數量)</span></span>
<span class="line"></span></code></pre></div><p>對於專用語法這麼多的狀況，真的會讓人覺得相當困擾。如果想獲得和範例相同的結果，其他 <code>DBMS</code> 的寫法範例如下所示。</p><ul><li>專用語法：<code>SQL Server</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> str1, </span><span style="color:#82AAFF;">SUBSTRING</span><span style="color:#A6ACCD;">(str1, </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> sub_str</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>Oracle</code>、<code>DB2</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> str1, SUBSTR(str1, </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> sub_str</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr;</span></span>
<span class="line"></span></code></pre></div></div></li><li><h4 id="upper-轉為大寫" tabindex="-1">UPPER - 轉為大寫 <a class="header-anchor" href="#upper-轉為大寫" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-9</p><p>UPPER 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">UPPER</span><span style="color:#A6ACCD;">(字串);</span></span>
<span class="line"></span></code></pre></div></div><p><code>UPPER</code> 也是只作用於英文字母的函數，能將參數所帶入的字串全部改為大寫，因此，英文字母以外的文字不會發生任何改變，而且原本即是大寫的字母也不會有變化。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-12</p><p>將小寫字母轉為大寫</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> str1, </span><span style="color:#82AAFF;">UPPER</span><span style="color:#A6ACCD;">(str1) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> up_str</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> str1 </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ABC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">aBC</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">山田</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>str1</th><th>up_str</th></tr></thead><tbody><tr><td>abc</td><td>ABC</td></tr><tr><td>山田</td><td>山田</td></tr><tr><td>ABC</td><td>ABC</td></tr><tr><td>aBC</td><td>ABC</td></tr></tbody></table></div></li></ul><h3 id="日期函數" tabindex="-1">日期函數 <a class="header-anchor" href="#日期函數" aria-hidden="true">#</a></h3><p><code>SQL</code> 設定了許多可以用來處理日期資料的 <code>日期函數</code>，不過大部分的 <code>日期函數 </code>在各家 <code>DBMS</code> 上的實際用法仍然相當分歧，因為這樣的緣故，無法以較為統一的方式來說明。</p><p>以下挑選「 標準 <code>SQL</code> 中有訂定，而且幾乎所有的 <code>DBMS</code> 都能使用 」的常用函數來介紹。</p><ul><li><h4 id="current-date-今天的日期" tabindex="-1">CURRENT_DATE - 今天的日期 <a class="header-anchor" href="#current-date-今天的日期" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-10</p><p>CURRENT_DATE 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">CURRENT_DATE</span></span>
<span class="line"></span></code></pre></div></div><p><code>CURRENT_DATE 函數</code> 會回傳此 <code>SQL</code> 執行時，也就是此函數執行時的當天日期，因為不必指定參數，所以不需要名稱後方的括號()。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-13</p><p>取得當天的日期</p><ul><li>專用語法：<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT_DATE;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>date</th></tr></thead><tbody><tr><td>2016-05-25</td></tr></tbody></table></div><p>另外，<code>SQL Server 無法使用此函數</code>，而 <code>Oracle</code> 和 <code>DB2</code> 上的語法有點不同</p><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>SQL Server</code></p><p>若想在 <code>SQL Server</code> 取得當天的日期，需要像下面一樣利用 <code>CURRENT_TIMESTAMP 函數</code> 的功能。</p><ul><li>專用語法：<code>SQL Server</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 利用 CAST 將 CURRENT_TIMESTAMP 轉換成日期型別</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CAST</span><span style="color:#A6ACCD;">(CURRENT_TIMESTAMP </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DATE</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> CUR_DATE;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>CUR_DATE</th></tr></thead><tbody><tr><td>2016-05-25</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>Oracle</code>、<code>DB2</code></p><p><code>Oracle</code> 的語法必須以 <code>FORM 子句</code> 指定 <code>虛擬資料表 (DUAL)</code>，相對於此， <code>DB2</code> 的 <code>CURRENT</code> 和 <code>DATE</code> 這 2 個單字是以半形空白隔開，而且需要指定名為「 <code>SYSIBM.SYSDUMMY1</code> 」的虛擬資料表 (相當於 <code>Oracle</code> 的 <code>DUAL</code>)，請注意別搞混了。</p><ul><li>專用語法：<code>Oracle</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT_DATE</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> dual;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>DB2</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT </span><span style="color:#C792EA;">DATE</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SYSIBM.SYSDUMMY1;</span></span>
<span class="line"></span></code></pre></div></div></li><li><h4 id="current-time-目前的時刻" tabindex="-1">CURRENT_TIME - 目前的時刻 <a class="header-anchor" href="#current-time-目前的時刻" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-11</p><p>CURRENT_TIME 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">CURRENT_TIME</span></span>
<span class="line"></span></code></pre></div></div><p><code>CURRENT_TIME 函數</code> 會回傳此 <code>SQL</code> 執行時，也就是此函數執行時的時刻，一樣不必指定參數所以不需要括號()。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-14</p><p>取得目前的時刻</p><ul><li>專用語法：<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT_TIME;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>timetz</th></tr></thead><tbody><tr><td>17:26:50.995+09</td></tr></tbody></table></div><p><code>SQL Server</code> 同樣無法使用此函數，而 <code>Oracle</code> 和 <code>DB2</code> 上的語法也稍有差異。</p><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>SQL Server</code></p><p>如果想在 <code>SQL Server</code> 上想取得目前的時刻，需要像下面一樣利用 <code>CURRENT_TIMESTAMP 函數</code>。</p><ul><li>專用語法：<code>SQL Server</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 利用 CAST 將 CURRENT_TIMESTAMP 轉換成時間型別</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CAST</span><span style="color:#A6ACCD;">(CURRENT_TIMESTAMP </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">TIME</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> CUR_TIME;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>CUR_TIME</th></tr></thead><tbody><tr><td>21:33:59.3400000</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>Oracle</code>、<code>DB2</code></p><p><code>Oracle</code> 和 <code>DB2</code> 必須使用下列的寫法，需要注意的地方和先前的 <code>CURRENT_DATE 函數</code> 相同，不過 <code>Oracle</code> 只能以包含日期的格式輸出結果。</p><ul><li>專用語法：<code>Oracle</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 指定虛擬資料表 (DUAL)</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> dual;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>DB2</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* CURRENT 和 TIME 之間為半形空白，</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">   而且需要指定 SYSIBM.SYSDUMMY1 虛擬資料表 */</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT </span><span style="color:#C792EA;">TIME</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SYSIBM.SYSDUMMY1;</span></span>
<span class="line"></span></code></pre></div></div></li><li><h4 id="current-timestamp-現在的日期和時刻" tabindex="-1">CURRENT_TIMESTAMP - 現在的日期和時刻 <a class="header-anchor" href="#current-timestamp-現在的日期和時刻" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-12</p><p>CURRENT_TIMESTAMP 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">CURRENT_TIMESTAMP</span></span>
<span class="line"></span></code></pre></div></div><p><code>CURRENT_TIMESTAMP 函數</code> 相當於 <code>CURRENT_DATE</code> 加上 <code>CURRENT_TIME</code> 的功能，使用此函數可以一併取得現在的日期和時刻，而針對回傳的結果，也能單純擷取出日期或時刻的部分。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-15</p><p>取得現在的日期和時刻</p><ul><li>專用語法：<code>SQL Server</code>、<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>now</th></tr></thead><tbody><tr><td>2018-04-25 18:31:03.704+09</td></tr></tbody></table></div><p>此函數的優點在於包含 <code>SQL Server</code> 在內的主要 <code>DBMS</code> 都能使用，不過 <code>Oracle</code> 和 <code>DB2</code> 上的語法同樣有些差異。</p><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>Oracle</code>、<code>DB2</code></p><ul><li>專用語法：<code>Oracle</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 指定虛擬資料表 (DUAL)</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> dual;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>DB2</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* CURRENT 和 TIMESTAMP 之間為半形空白，</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">   而且需要指定 SYSIBM.SYSDUMMY1 虛擬資料表 */</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT </span><span style="color:#C792EA;">TIMESTAMP</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SYSIBM.SYSDUMMY1;</span></span>
<span class="line"></span></code></pre></div></div></li><li><h4 id="extract-擷取日期元素" tabindex="-1">EXTRACT - 擷取日期元素 <a class="header-anchor" href="#extract-擷取日期元素" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-13</p><p>EXTRACT 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">EXTRACT(日期元素 </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> 日期資料)</span></span>
<span class="line"></span></code></pre></div></div><p><code>EXTRACT 函數</code> 能從完整的日期資料擷取出某個部分，不過，它的回傳值並非日期型別，而是 <code>數值型別</code>。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-16</p><p>擷取日期元素</p><ul><li>專用語法：<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">YEAR</span><span style="color:#A6ACCD;">   </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">year</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">MONTH</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">month</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">DAY</span><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">day</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">HOUR</span><span style="color:#A6ACCD;">   </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">hour</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">MINUTE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">minute</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">SECOND</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">second</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>now</th><th style="text-align:right;">year</th><th style="text-align:right;">month</th><th style="text-align:right;">day</th><th style="text-align:right;">hour</th><th style="text-align:right;">minute</th><th style="text-align:right;">second</th></tr></thead><tbody><tr><td>2018-04-25 19:07:33.987+09</td><td style="text-align:right;">2018</td><td style="text-align:right;">5</td><td style="text-align:right;">25</td><td style="text-align:right;">19</td><td style="text-align:right;">7</td><td style="text-align:right;">33.987</td></tr></tbody></table></div><p>請注意，<code>SQL Server</code> 無法使用此函數。</p><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>SQL Server</code>、<code>Oracle</code>、<code>DB2</code></p><p>如果想在 <code>SQL Server</code> 獲得相同結果，需要使用名為 <code>DATEPART</code> 的專有函數。</p><ul><li>專用語法：<code>SQL Server</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">DATEPART</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">YEAR</span><span style="color:#A6ACCD;">   </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">year</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">DATEPART</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">MONTH</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">month</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">DATEPART</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">DAY</span><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">day</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">DATEPART</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">HOUR</span><span style="color:#A6ACCD;">   </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">hour</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">DATEPART</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">MINUTE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">minute</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">DATEPART</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">SECOND</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">second</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>Oracle</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 在 FROM 子句指定虛擬資料表 (DUAL)</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">YEAR</span><span style="color:#A6ACCD;">   </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">year</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">MONTH</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">month</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">DAY</span><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">day</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">HOUR</span><span style="color:#A6ACCD;">   </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">hour</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">MINUTE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">minute</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">SECOND</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">second</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> DUAL;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>DB2</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* CURRENT 和 TIMESTAMP 之間為半形空白，</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">   而且需要指定 SYSIBM.SYSDUMMY1 虛擬資料表 */</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">YEAR</span><span style="color:#A6ACCD;">   </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">year</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">MONTH</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">month</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">DAY</span><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">day</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">HOUR</span><span style="color:#A6ACCD;">   </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">hour</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">MINUTE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">minute</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">       EXTARACT(</span><span style="color:#F78C6C;">SECOND</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> CURRENT_TIMESTAMP) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">second</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SYSIBM.SYSDUMMY1;</span></span>
<span class="line"></span></code></pre></div></div></li></ul><h3 id="轉換函數" tabindex="-1">轉換函數 <a class="header-anchor" href="#轉換函數" aria-hidden="true">#</a></h3><p>「 <code>轉換</code> 」這個詞彙的意義相當多，不過在 <code>SQL</code> 中大致上有 2 種意思： 1 個是 <code>資料型別的轉換</code>，一般簡稱為「 <code>型別轉換</code> 」或使用英文的「 <code>CAST</code> 」單字，另外 1 個則是 <code>內容值的轉換</code>。</p><ul><li><h4 id="cast-型別轉換" tabindex="-1">CAST - 型別轉換 <a class="header-anchor" href="#cast-型別轉換" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">語法 6-14</p><p>CAST 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">CAST</span><span style="color:#A6ACCD;">(轉換前的值 </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> 轉換後的型別)</span></span>
<span class="line"></span></code></pre></div></div><p>轉換型別可以透過名為 <code>CAST</code> 的函數來完成。</p><p>想把不符合欄位型別的資料存入資料表、或執行某些運算的時候，如果資料型別不一致可能會導致錯誤發生、或是因為 <code>DBMS</code> 自動以隱含方式進行型別轉換而造成處理效能低落，遇到這類狀況時，就必須預先將資料轉換成適當的型別。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-17</p><p>從 字串型別 轉換成 數值型別</p><ul><li>專用語法：<code>SQL Server</code>、<code>PostgreSQL</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CAST</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> int_col;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CAST</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> SIGNED </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> int_col;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>Oracle</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CAST</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> int_col</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> DUAL;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>DB2</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CAST</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> int_col</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SYSIBM.SYSDUMMY1;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>int_col</th></tr></thead><tbody><tr><td>1</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">範例 6-18</p><p>從 字串型別 轉換成 日期型別</p><ul><li>專用語法：<code>SQL Server</code>、<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CAST</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-12-14</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DATE</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> date_col;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>Oracle</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CAST</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-12-14</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DATE</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> date_col</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> DUAL;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>DB2</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">CAST</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-12-14</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">DATE</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> date_col</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SYSIBM.SYSDUMMY1;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>date_col</th></tr></thead><tbody><tr><td>2009-12-14</td></tr></tbody></table></div></li><li><h4 id="coalesce-將-null-替換成特定值" tabindex="-1">COALESCE - 將 NULL 替換成特定值 <a class="header-anchor" href="#coalesce-將-null-替換成特定值" aria-hidden="true">#</a></h4><p><code>COALESCE</code> 是 <code>SQL</code> 所特有的函數，它屬於參數個數可變的函數 (Variadic Function)，執行之後會從左邊開始回傳 1 個不是 <code>NULL</code> 的值，由於其參數個數可變，所以可以視需求填入多個參數。</p><div class="warning custom-block"><p class="custom-block-title">語法 6-15</p><p>COALESCE 函數</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(資料1, 資料2, 資料3, ...)</span></span>
<span class="line"></span></code></pre></div></div><p>最常見的便是在 <code>SQL 敘述</code> 中，需要以其他的值取代 <code>NULL</code> 的狀況。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-19</p><p>將 NULL 替換成特定值</p><ul><li>專用語法：<code>SQL Server</code>、<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> col_1,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> col_2,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-11-01</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> col_3;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>Oracle</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> col_1,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> col_2,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-11-01</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> col_3;</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> DUAL;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>DB2</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> col_1,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> col_2,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-11-01</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> col_3;</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SYSIBM.SYSDUMMY1;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:center;">col_1</th><th style="text-align:center;">col_2</th><th style="text-align:center;">col_3</th></tr></thead><tbody><tr><td style="text-align:center;">1</td><td style="text-align:center;">test</td><td style="text-align:center;">2009-11-01</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">範例 6-20</p><p>篩選出 SampleStr 資料表 str2 欄位的資料</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(str2, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">此為NULL</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleStr;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>coalesce</th></tr></thead><tbody><tr><td>四五</td></tr><tr><td>def</td></tr><tr><td>太郎</td></tr><tr><td>此為NULL</td></tr><tr><td>甲乙丙</td></tr><tr><td>此為NULL</td></tr><tr><td>此為NULL</td></tr><tr><td>此為NULL</td></tr><tr><td>abc</td></tr><tr><td>abc</td></tr><tr><td>必</td></tr></tbody></table></div></li></ul><h2 id="_6-2-述詞" tabindex="-1">6-2 述詞 <a class="header-anchor" href="#_6-2-述詞" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>述詞 是 回傳值為真偽值的函數。</li><li>請熟練 <code>LIKE</code> 的 3 種使用方式 (起始一致、中間一致、結尾一致)。</li><li>請注意 <code>BETWEEN</code> 需要指定 3 個參數。</li><li>想篩選出 <code>NULL</code> 的資料時，必須使用 <code>IS NULL</code>。</li><li><code>IN</code>、<code>EXISTS</code> 能將子查詢當作參數。</li></ul></div><h3 id="什麼是述詞" tabindex="-1">什麼是述詞 <a class="header-anchor" href="#什麼是述詞" aria-hidden="true">#</a></h3><p><code>述詞 (Predicate)</code>，是具有特殊條件的函數，「 <code>回傳值為真偽值</code> 」。</p><p>具體來說，會有下列述詞：</p><ul><li><code>LIKE</code></li><li><code>BETWEEN</code></li><li><code>IS NULL</code>、<code>IS NOT NULL</code></li><li><code>IN</code></li><li><code>EXISTS</code></li></ul><h3 id="like-述詞-搜尋相同的字串" tabindex="-1">LIKE 述詞 - 搜尋相同的字串 <a class="header-anchor" href="#like-述詞-搜尋相同的字串" aria-hidden="true">#</a></h3><p><code>LIKE 述詞</code>，允許較為模糊的條件，可用於對字串進行 <code>部分一致搜尋</code> 的需求。</p><p><code>部分一致</code> 大致上可以分為 <code>起始一致</code>、<code>中間一致</code>、<code>結尾一致</code> 等 3 種類型。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-21</p><p>建立 SampleLike 資料表</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- DDL：建立資料表</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SampleLike</span></span>
<span class="line"><span style="color:#A6ACCD;">( strcol </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">6</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (strcol));</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- DML：存入資料</span></span>
<span class="line"><span style="color:#F78C6C;">START TRANSACTION</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleLike (strcol) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abcddd</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleLike (strcol) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">dddabc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleLike (strcol) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abdddc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleLike (strcol) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abcdd</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleLike (strcol) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ddabc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> SampleLike (strcol) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abddc</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">COMMIT</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">專用語法</p><p>各家 <code>DBMS</code> 交易功能的語法略有差異，如果在 <code>PostgreSQL</code> 或 <code>SQL Server</code> 執行 範例 6-1 的 <code>DML 敘述</code> 時，需要將「 <code>START TRANSACTION</code> 」改為「 <code>BEGIN TRANSACTION</code> 」，而在 <code>Oracle</code> 或 <code>DB2</code> 上執行的時候，不需要「 <code>START TRANSACTION</code> 」，直接刪除即可。</p></div><ul><li><h5 id="起始一致-篩選出「-dddabc-」" tabindex="-1"><code>起始一致</code>：篩選出「 dddabc 」 <a class="header-anchor" href="#起始一致-篩選出「-dddabc-」" aria-hidden="true">#</a></h5><p>會針對搜尋條件的部分字串，僅篩選出搜尋對象欄位內容的開頭為此字串的紀錄。</p></li><li><h5 id="中間一致-篩選出「-abcddd-」、「-dddabc-」和「-abdddc-」" tabindex="-1"><code>中間一致</code>：篩選出「 abcddd 」、「 dddabc 」和「 abdddc 」 <a class="header-anchor" href="#中間一致-篩選出「-abcddd-」、「-dddabc-」和「-abdddc-」" aria-hidden="true">#</a></h5><p>會針對搜尋條件的部分字串，篩選出搜尋對象欄位內容的「 某個位置 」有此字串的紀錄，無論是位於起始、結尾或中間位置都會被篩選出來。</p></li><li><h5 id="結尾一致-篩選出「-abcddd-」" tabindex="-1"><code>結尾一致</code>：篩選出「 abcddd 」 <a class="header-anchor" href="#結尾一致-篩選出「-abcddd-」" aria-hidden="true">#</a></h5><p>會針對搜尋條件的部分字串，僅篩選出搜尋對象欄位內容的結尾為此字串的紀錄。</p></li></ul><p>這樣的搜尋方式並非以「 <code>=</code> 」來指定條件的字串，而是根據搜尋對象欄位所包含的規則進行搜尋，所以被稱為「 <code>模式一致 (Pattern Matching)</code> 」的方式，這裡的模式相當於「 <code>規則</code> 」的意思。</p><ul><li><h4 id="執行「-起始一致-」搜尋" tabindex="-1">執行「 起始一致 」搜尋 <a class="header-anchor" href="#執行「-起始一致-」搜尋" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">範例 6-22</p><p>以 LIKE 執行起始一致搜尋</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleLike</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> strcol </span><span style="color:#F78C6C;">LIKE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">ddd%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>strcol</th></tr></thead><tbody><tr><td>dddabc</td></tr></tbody></table></div><p>「 <code>%</code> 」是代表「 0 個文字以上字串 」的特殊符號。</p></li><li><h4 id="「-中間一致-」搜尋" tabindex="-1">「 中間一致 」搜尋 <a class="header-anchor" href="#「-中間一致-」搜尋" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">範例 6-23</p><p>以 LIKE 執行中間一致搜尋</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleLike</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> strcol </span><span style="color:#F78C6C;">LIKE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%ddd%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>strcol</th></tr></thead><tbody><tr><td>abcddd</td></tr><tr><td>dddabc</td></tr><tr><td>abdddc</td></tr></tbody></table></div></li><li><h4 id="「-結尾一致-」搜尋" tabindex="-1">「 結尾一致 」搜尋 <a class="header-anchor" href="#「-結尾一致-」搜尋" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">範例 6-24</p><p>以 LIKE 執行結尾一致搜尋</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleLike</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> strcol </span><span style="color:#F78C6C;">LIKE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%ddd</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>strcol</th></tr></thead><tbody><tr><td>abcddd</td></tr></tbody></table></div><p>另外，除了「 <code>%</code> 」之外，<code>LIKE</code> 的條件句還能使用「 <code>_(底線)</code> 」符號，此符號代表「 <code>任意 1 個文字</code> 」的意思。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-25</p><p>以 LIKE 和 _(底線) 執行起始一致搜尋</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleLike</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> strcol </span><span style="color:#F78C6C;">LIKE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abc__</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;    </span><span style="color:#676E95;font-style:italic;">-- abc + 任意 2 個文字</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>strcol</th></tr></thead><tbody><tr><td>abcdd</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">範例 6-26</p><p>搜尋「 abc + 任意 3 個文字 」</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> SampleLike</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> strcol </span><span style="color:#F78C6C;">LIKE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">abc___</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;    </span><span style="color:#676E95;font-style:italic;">-- abc + 任意 3 個文字</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>strcol</th></tr></thead><tbody><tr><td>abcddd</td></tr></tbody></table></div></li></ul><h3 id="between-範圍搜尋" tabindex="-1">BETWEEN - 範圍搜尋 <a class="header-anchor" href="#between-範圍搜尋" aria-hidden="true">#</a></h3><p>利用 <code>BETWEEN</code> 即可進行 <code>範圍搜尋</code>，這個述詞和其他述詞或函數有些不同，它需要使用到 3 個參數，也就是 <code>目標欄位名稱</code>、<code>起始值</code> 和 <code>結束值</code>。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-27</p><p>篩選出販售單價為 100 ~ 1000 元的商品</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#F78C6C;">BETWEEN</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AND</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th>sell_price</th></tr></thead><tbody><tr><td>T恤</td><td>1000</td></tr><tr><td>打孔機</td><td>500</td></tr><tr><td>叉子</td><td>500</td></tr><tr><td>刨絲器</td><td>880</td></tr><tr><td>鋼珠筆</td><td>100</td></tr></tbody></table></div><p><code>BETWEEN</code> 有個需要注意的地方，那便是符合 100 和 1000 這 2 側數值的紀錄也會出現在結果中，假若想排除符合 2 側數值的紀錄，必須改用 <code>&lt;</code> 和 <code>&gt;</code> 來撰寫條件。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-28</p><p>篩選出販售單價為 101 ~ 999 元的商品</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">100</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">AND</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th>sell_price</th></tr></thead><tbody><tr><td>打孔機</td><td>500</td></tr><tr><td>叉子</td><td>500</td></tr><tr><td>刨絲器</td><td>880</td></tr></tbody></table></div><h3 id="is-null、is-not-null-判斷是否為-null" tabindex="-1">IS NULL、IS NOT NULL - 判斷是否為 NULL <a class="header-anchor" href="#is-null、is-not-null-判斷是否為-null" aria-hidden="true">#</a></h3><p>想篩選出某個欄位為 <code>NULL</code> 的紀錄時，無法使用「 <code>=</code> 」來達成目的，必須改用 <code>IS NULL</code> 這個特殊的述詞。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-29</p><p>篩選出購入單價 (buying_price) 為 NULL 的商品</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> buying_price </span><span style="color:#F78C6C;">IS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th>buying_price</th></tr></thead><tbody><tr><td>叉子</td><td></td></tr><tr><td>鋼珠筆</td><td></td></tr></tbody></table></div><p>如果需要篩選出欄位為 <code>NULL</code> 以外的紀錄，則需要改用 <code>IS NOT NULL 述詞</code>。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-30</p><p>篩選出購入單價 (buying_price) 非 NULL 的商品</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> buying_price </span><span style="color:#F78C6C;">IS NOT NULL</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>T恤</td><td style="text-align:right;">500</td></tr><tr><td>打孔機</td><td style="text-align:right;">320</td></tr><tr><td>襯衫</td><td style="text-align:right;">2800</td></tr><tr><td>菜刀</td><td style="text-align:right;">2800</td></tr><tr><td>壓力鍋</td><td style="text-align:right;">5000</td></tr><tr><td>刨絲器</td><td style="text-align:right;">790</td></tr></tbody></table></div><h3 id="in-述詞-or-的簡便形式" tabindex="-1">IN 述詞 - OR 的簡便形式 <a class="header-anchor" href="#in-述詞-or-的簡便形式" aria-hidden="true">#</a></h3><div class="warning custom-block"><p class="custom-block-title">範例 6-31</p><p>以 OR 搜尋多個特定的購入單價</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> buying_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">320</span></span>
<span class="line"><span style="color:#A6ACCD;">      buying_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">500</span></span>
<span class="line"><span style="color:#A6ACCD;">      buying_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">5000</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>T恤</td><td style="text-align:right;">500</td></tr><tr><td>打孔機</td><td style="text-align:right;">320</td></tr><tr><td>壓力鍋</td><td style="text-align:right;">5000</td></tr></tbody></table></div><p>這樣當然也能達成目的，不過此寫法有個缺點，當篩選條件的數量越來越多時，<code>SQL 敘述</code> 的長度也會隨之變長，增加未來閱讀理解上的負擔。可以改以「 <code>IN (值1, 值2, ...)</code> 」的形式寫成較為清爽的樣子。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-32</p><p>以 IN 指定多個特定的購入單價</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> buying_price </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">320</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">5000</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>T恤</td><td style="text-align:right;">500</td></tr><tr><td>打孔機</td><td style="text-align:right;">320</td></tr><tr><td>壓力鍋</td><td style="text-align:right;">5000</td></tr></tbody></table></div><p>相反地，假如想篩選出「 購入單價為 320 元、 500 元以及 5000 元以外 」的商品紀錄，需要使用否定形的 <code>NOT IN</code>。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-33</p><p>以 IN 指定多個特定的購入單價</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> buying_price </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">320</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">5000</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>襯衫</td><td style="text-align:right;">2800</td></tr><tr><td>菜刀</td><td style="text-align:right;">2800</td></tr><tr><td>刨絲器</td><td style="text-align:right;">790</td></tr></tbody></table></div><p>不過請特別注意，無論是使用 <code>IN</code> 或 <code>NOT IN</code>，<code>都無法篩選出該欄位為 NULL 的紀錄</code>，<code>NULL</code> 必須以 <code>IS NULL</code> 和 <code>IS NOT NULL</code> 來判斷。</p><h3 id="指定子查詢作為-in-述詞的參數" tabindex="-1">指定子查詢作為 IN 述詞的參數 <a class="header-anchor" href="#指定子查詢作為-in-述詞的參數" aria-hidden="true">#</a></h3><p><code>IN 述詞</code> (以及 <code>NOT IN 述詞</code>) 具有其他述詞所不具備的特殊使用方式，那便是指定 <code>子查詢</code> 作為其參數的使用方式。<code>IN 能指定資料表、檢視表作為其參數</code>。</p><p>為了介紹其具體操作方式，這裡需要另外建立 1 個新的資料表。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-34</p><p>建立 StoreShohin (商品店鋪) 資料表的 CREATE TABLE 敘述</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">StoreShohin</span></span>
<span class="line"><span style="color:#A6ACCD;">(store_id </span><span style="color:#C792EA;">CHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">store_name </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">200</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">shohin_id </span><span style="color:#C792EA;">CHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">s_amount </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (store_id, shohin_id));</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">範例 6-35</p><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">START TRANSACTION</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000A</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">東京</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000A</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">東京</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000A</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">東京</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">15</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000B</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">名古屋</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">30</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000B</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">名古屋</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">120</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000B</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">名古屋</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0004</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000B</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">名古屋</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0006</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000B</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">名古屋</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">40</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000C</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">大阪</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">20</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000C</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">大阪</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0004</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">50</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000C</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">大阪</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0006</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">90</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000C</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">大阪</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">70</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StoreShohin (store_id, store_name, shohin_id, s_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000D</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">福岡</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">COMMIT</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:right;">store_id</th><th style="text-align:center;">store_name</th><th style="text-align:right;">shohin_id</th><th style="text-align:right;">s_amount</th></tr></thead><tbody><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td style="text-align:right;">30</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td style="text-align:right;">50</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td style="text-align:right;">15</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td style="text-align:right;">30</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td style="text-align:right;">120</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td style="text-align:right;">20</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td style="text-align:right;">10</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td style="text-align:right;">40</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td style="text-align:right;">20</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td style="text-align:right;">50</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td style="text-align:right;">90</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td style="text-align:right;">70</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td style="text-align:right;">100</td></tr></tbody></table><p>此 <code>CREATE TABLE 敘述</code> 的特點在於指定了 2 個欄位作為主鍵 (Primary Key)，組合了兩個欄位避免重複。</p></div><div class="warning custom-block"><p class="custom-block-title">專用語法</p><p>各家 <code>DBMS</code> 交易功能的語法略有差異，如果在 <code>PostgreSQL</code> 或 <code>SQL Server</code> 執行 範例 6-1 的 <code>DML 敘述</code> 時，需要將「 <code>START TRANSACTION</code> 」改為「 <code>BEGIN TRANSACTION</code> 」，而在 <code>Oracle</code> 或 <code>DB2</code> 上執行的時候，不需要「 <code>START TRANSACTION</code> 」，直接刪除即可。</p></div><ul><li><h4 id="in-與-子查詢" tabindex="-1">IN 與 子查詢 <a class="header-anchor" href="#in-與-子查詢" aria-hidden="true">#</a></h4><p>試著 列出大阪店 (<code>000C</code>) 現有的商品 (<code>shohin_id</code>) 以及各商品的販售單價 (<code>sell_price</code>)</p><ol><li>從 <code>StoreShohin 資料表</code> 篩選出大阪店 (<code>store_id = &#39;000C&#39;</code>) 的現貨商品ID (<code>shohin_id</code>)。</li><li>針對 1. 所取得的商品ID (<code>shohin_id</code>)，從 <code>Shohin 資料表</code> 篩選出對應的販售單價 (<code>sell_price</code>)。</li></ol><div class="warning custom-block"><p class="custom-block-title">範例 6-36</p><p>在 IN 的參數位置使用子查詢</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 列出「 大阪店現有的商品和販售單價 」</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_id </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> store_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000C</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th style="text-align:right;">sell_price</th></tr></thead><tbody><tr><td>叉子</td><td style="text-align:right;">500</td></tr><tr><td>襯衫</td><td style="text-align:right;">4000</td></tr><tr><td>菜刀</td><td style="text-align:right;">3000</td></tr><tr><td>刨絲器</td><td style="text-align:right;">880</td></tr></tbody></table><p>子查詢會從內部開始執行，因此這段 SELECT 敘述一開始會先執行內部的子查詢</p></div></li><li><h4 id="not-in-與-子查詢" tabindex="-1">NOT IN 與 子查詢 <a class="header-anchor" href="#not-in-與-子查詢" aria-hidden="true">#</a></h4><p><code>NOT IN</code> 同樣可以使用子查詢當作參數，其語法和 <code>IN</code> 使用方式相同</p><div class="warning custom-block"><p class="custom-block-title">範例 6-37</p><p>在 NOT IN 的參數位置使用子查詢</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 列出「 東京店(000A)現有的商品(shohin_id)以外的販售單價(sell_price) 」</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_id </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> store_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000A</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th style="text-align:right;">sell_price</th></tr></thead><tbody><tr><td>菜刀</td><td style="text-align:right;">3000</td></tr><tr><td>壓力鍋</td><td style="text-align:right;">6800</td></tr><tr><td>叉子</td><td style="text-align:right;">500</td></tr><tr><td>刨絲器</td><td style="text-align:right;">880</td></tr><tr><td>鋼珠筆</td><td style="text-align:right;">100</td></tr></tbody></table><p>子查詢會從內部開始執行，因此這段 SELECT 敘述一開始會先執行內部的子查詢</p></div></li></ul><h3 id="exists-述詞" tabindex="-1">EXISTS 述詞 <a class="header-anchor" href="#exists-述詞" aria-hidden="true">#</a></h3><p>雖然有時候還是必須使用到 <code>EXISTS 述詞</code>，不過許多狀況下都可以改用 <code>IN 述詞</code> 來取代。</p><ul><li><h4 id="exists-述詞的使用方式" tabindex="-1">EXISTS 述詞的使用方式 <a class="header-anchor" href="#exists-述詞的使用方式" aria-hidden="true">#</a></h4><p>「 查詢 &quot;符合某些條件的紀錄是否存在&quot; 」，當這樣的紀錄存在的時候回傳 <code>真(TRUE)</code>，不存在的時候則回傳 <code>偽(FALSE)</code>，而 <code>EXISTS (存在)</code> 這個述詞針對的主詞即為「 紀錄 」。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-38</p><p>以 EXISTS 列出「 大阪店內商品的販售單價 」</p><ul><li>專用語法：<code>SQL Server</code>、<code>DB2</code>、<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 列出「 大阪店現有的商品和販售單價 」</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> S</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">EXISTS</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> SS</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> SS.store_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000C</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AND</span><span style="color:#A6ACCD;"> SS.shohin_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> S.shohin_id</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th style="text-align:right;">sell_price</th></tr></thead><tbody><tr><td>叉子</td><td style="text-align:right;">500</td></tr><tr><td>襯衫</td><td style="text-align:right;">4000</td></tr><tr><td>菜刀</td><td style="text-align:right;">3000</td></tr><tr><td>刨絲器</td><td style="text-align:right;">880</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>Oracle</code></p><p><code>Oracle</code> 在 <code>FROM 子句</code> 的地方不能使用 <code>AS</code> (會發生錯誤)，因此，想要在 <code>Oracle</code> 上執行 範例 6-38 敘述的時候， 請將「 <code>FROM Shohin AS S</code> 」部分改為「 <code>FROM Shohin S</code> 」， 將「 <code>FROM StoreShohin AS SS</code> 」部分改為「 <code>FROM StoreShohin SS</code> 」(刪除 FROM 子句中的 AS)。</p></div></li><li><h4 id="exists-的參數" tabindex="-1">EXISTS 的參數 <a class="header-anchor" href="#exists-的參數" aria-hidden="true">#</a></h4><p><code>EXISTS</code> 是僅需要 1 個參數的述詞。</p><p><code>EXISTS</code> 只會在其右側寫上 1 個參數，而且此參數大多為子查詢。 如：</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">(</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> SS</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> SS.store_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000C</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AND</span><span style="color:#A6ACCD;"> SS.shohin_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> S.shohin_id</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>當中的「 <code>SS.shohin_id = S.shohin_id</code> 」，用來連結 <code>Shohin 資料表</code> 和 <code>StoreShohin 資料表</code>，此參數為 <code>關聯子查詢</code>。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 6-1</p><p>EXISTS 的參數位置通常會指定 <code>關聯子查詢</code>。</p></div></li><li><h4 id="子查詢內的「-select-」" tabindex="-1">子查詢內的「 SELECT * 」 <a class="header-anchor" href="#子查詢內的「-select-」" aria-hidden="true">#</a></h4><p>如同先前的說明，由於 <code>EXISTS</code> 的作用，僅在於確認紀錄是否存在，而子查詢回傳了什麼欄位則完全沒有差別。 <code>EXISTS 述詞</code>，會針對子查詢內 WHERE 子句所指定的條件，確認紀錄是否存在，如果存在便回傳 <code>真(TRUE)</code>。</p><p>對於 <code>EXISTS</code> 的子查詢內使用「 <code>SELECT *</code> 」的寫法，請把這當成 <code>SQL</code> 的 1 種慣用做法。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 6-2</p><p>EXISTS 參數位置的子查詢通常會使用「 <code>SELECT *</code> 」。</p></div></li><li><h4 id="將-not-in-改寫為-not-exists" tabindex="-1">將 NOT IN 改寫為 NOT EXISTS <a class="header-anchor" href="#將-not-in-改寫為-not-exists" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">範例 6-40</p><p>以 NOT EXISTS 列出「 東京店現有商品以外的販售單價 」</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> S</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">EXISTS</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> TS</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> TS.store_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000A</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AND</span><span style="color:#A6ACCD;"> TS.shohin_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> S.shohin_id</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th style="text-align:right;">sell_price</th></tr></thead><tbody><tr><td>菜刀</td><td style="text-align:right;">3000</td></tr><tr><td>壓力鍋</td><td style="text-align:right;">6800</td></tr><tr><td>叉子</td><td style="text-align:right;">500</td></tr><tr><td>刨絲器</td><td style="text-align:right;">880</td></tr><tr><td>鋼珠筆</td><td style="text-align:right;">100</td></tr></tbody></table><p>子查詢會從內部開始執行，因此這段 SELECT 敘述一開始會先執行內部的子查詢</p></div><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>Oracle</code></p><p><code>Oracle</code> 在 <code>FROM 子句</code> 的地方不能使用 <code>AS</code> (會發生錯誤)，因此，想要在 <code>Oracle</code> 上執行 範例 6-40 敘述的時候， 請將「 <code>FROM Shohin AS S</code> 」部分改為「 <code>FROM Shohin S</code> 」， 將「 <code>FROM StoreShohin AS TS</code> 」部分改為「 <code>FROM StoreShohin TS</code> 」(刪除 FROM 子句中的 AS)。</p></div></li></ul><h2 id="_6-3-case-運算式" tabindex="-1">6-3 CASE 運算式 <a class="header-anchor" href="#_6-3-case-運算式" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li><code>CASE 運算式</code> 可分為「 <code>簡單 CASE 運算式</code> 」和「 <code>搜尋 CASE 運算式</code> 」等 2 種類型，<code>搜尋 CASE 運算式</code> 包含了 <code>簡單 CASE 運算式</code> 的所有功能。</li><li>雖然 <code>CASE 運算式</code> 的 <code>ELSE 子句</code> 可以省略，不過為了讓 <code>SQL 敘述</code> 比較容易閱讀，建議不要省略。</li><li><code>CASE 運算式</code> 的 <code>END</code> 不能省略。</li><li>使用 <code>CASE 運算式</code> 便能有彈性地重組 <code>SELECT 敘述</code> 的結果。</li><li>例如：<code>Oracle</code> 的 <code>DECODE</code>、<code>MySQL</code> 的 <code>IF</code> 等，有些 <code>DBMS</code> 提供了 <code>CASE 運算式</code> 簡化後的專有函數，不過這些語法不具通用性，而且功能上也有些限制，建議避免使用。</li></ul></div><h3 id="什麼是-case-運算式" tabindex="-1">什麼是 CASE 運算式 <a class="header-anchor" href="#什麼是-case-運算式" aria-hidden="true">#</a></h3><p><code>CASE 運算式</code> 如同 CASE (狀況、事例) 的名稱所示，可用來撰寫「 <code>視狀況執行不同動作</code> 」的敘述，而這樣執行不同動作的機制，在程式語言中一般稱為「 <code>條件句</code> 」。</p><h3 id="case-運算式的語法" tabindex="-1">CASE 運算式的語法 <a class="header-anchor" href="#case-運算式的語法" aria-hidden="true">#</a></h3><p>CASE 運算式的語法可分為「 <code>簡單 CASE 運算式</code> (Simple CASE Expression) 」和「 <code>搜尋 CASE 運算式</code> (Searched CASE Expression) 」。</p><p><code>搜尋 CASE 運算式</code> 含括了 <code>簡單 CASE 運算式</code> 的所有功能。</p><div class="warning custom-block"><p class="custom-block-title">語法 6-16</p><p>搜尋 CASE 運算式</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">判斷式1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">回應結果1</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">判斷式2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">回應結果2</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">判斷式3</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">回應結果3</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">     ...</span></span>
<span class="line"><span style="color:#A6ACCD;">     </span><span style="color:#F78C6C;">ELSE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">回應結果</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F78C6C;">END</span></span>
<span class="line"></span></code></pre></div></div><p><code>WHEN 子句</code> 的 &lt;判斷式&gt; 部分通常採用「 <code>欄位 = 值</code> 」之類的形式，執行後會回傳真偽值(<code>TRUE</code> / <code>FALSE</code> / <code>UNKNOWN</code>)，只要把它理解成是使用 <code>=</code> 、 <code>!=</code> 、 <code>LIKE</code> 或 <code>BETWEEN</code> 等述詞所寫成的式子即可。</p><p><code>CASE 運算式</code> 的機制，最初會從判斷 <code>WHEN 子句</code> 的 <code>&lt;判斷式&gt;</code> 開始，而所謂的「 <code>判斷</code> 」便是確認該判斷式真偽值的動作，假如結果為 <code>真(TRUE)</code>，便會回傳後方 <code>THEN 子句</code> 的 <code>&lt;回應結果&gt;</code> 部分所指定的特定值、欄位內容或運算式的執行結果。</p><p>運算式 最終結果只會獲得 1 個值。</p><h3 id="case-運算式的使用方式" tabindex="-1">CASE 運算式的使用方式 <a class="header-anchor" href="#case-運算式的使用方式" aria-hidden="true">#</a></h3><div class="warning custom-block"><p class="custom-block-title">範例 6-41</p><p>以 CASE 運算式替商品分類分別加上 A ~ C 的字串</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">A:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">B:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">ELSE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> abc_shohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_name</th><th>abc_shohin_catalg</th></tr></thead><tbody><tr><td>T恤</td><td>A:衣物</td></tr><tr><td>打孔機</td><td>B:辦公用品</td></tr><tr><td>襯衫</td><td>A:衣物</td></tr><tr><td>菜刀</td><td>C:廚房用品</td></tr><tr><td>壓力鍋</td><td>C:廚房用品</td></tr><tr><td>叉子</td><td>C:廚房用品</td></tr><tr><td>刨絲器</td><td>C:廚房用品</td></tr><tr><td>鋼珠筆</td><td>B:辦公用品</td></tr></tbody></table></div><p>語法的規則上可以省略撰寫 <code>ELSE 子句</code> 的部分，而沒有 <code>ELSE 子句</code> 的寫法會被自動當作「 <code>ELSE NULL</code> 」來處理，不過為了避免之後查閱的時候發生漏看的狀況，建議以明示的方式寫上 <code>ELSE 子句</code>。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 6-3</p><p><code>CASE 運算式</code> 雖然可以省略 <code>ELSE 子句</code>，不過建議不要省略。</p></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 6-4</p><p><code>CASE 運算式</code> 不能省略最後的 <code>END</code>。</p></div><ul><li><h4 id="case-運算式可寫入的位置" tabindex="-1">CASE 運算式可寫入的位置 <a class="header-anchor" href="#case-運算式可寫入的位置" aria-hidden="true">#</a></h4><p>所有可以寫入運算式的地方，都可以寫入 <code>CASE 運算式</code>。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-42</p><p>一般使用 GROUP BY 無法做到縱橫轉換</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(sell_price) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> sum_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_catalg</th><th style="text-align:right;">sum_price</th></tr></thead><tbody><tr><td>衣物</td><td style="text-align:right;">5000</td></tr><tr><td>辦公用品</td><td style="text-align:right;">600</td></tr><tr><td>廚房用品</td><td style="text-align:right;">11180</td></tr></tbody></table></div><p>如果想讓各分類單價總和以「 <code>欄位</code> 」的形式，也就是橫向排列的方式呈現，必須改用 <code>CASE 運算式</code>，以便獲得 3 個欄位的結果。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-43</p><p>使用 CASE 運算式達成縱橫轉換</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 將各商品分類的販售單價總和結果進行縱橫轉換</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#F78C6C;">ELSE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> sum_price_cloth,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#F78C6C;">ELSE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> sum_price_kitchen,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#F78C6C;">ELSE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> sum_price_office,</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:right;">sum_price_cloth</th><th style="text-align:right;">sum_price_kitchen</th><th style="text-align:right;">sum_price_office</th></tr></thead><tbody><tr><td style="text-align:right;">5000</td><td style="text-align:right;">11180</td><td style="text-align:right;">600</td></tr></tbody></table><p>各段 <code>CASE 運算式</code> 的作用，在於當 <code>商品分類 (shohin_catalg)</code> 符合「衣物」、「廚房用品」或「辦公用品」等特定字串時，便輸出 (回傳) 該商品的 <code>販售單價 (sell_price)</code>，而遇到不符合的商品則輸出 (回傳) <code>0</code> 的數值，最後所有輸出結果經過 <code>SUM 函數</code> 計算之後，便可獲得特定商品分類的販售單價總和。</p></div><blockquote><h3 id="column-簡單-case-運算式" tabindex="-1">COLUMN 簡單 CASE 運算式 <a class="header-anchor" href="#column-簡單-case-運算式" aria-hidden="true">#</a></h3><p><code>簡單 CASE 運算式</code> 和 <code>搜尋 CASE 運算式</code> 相較之下，具有寫法較為簡潔的優點，不過相對地也產生條件在撰寫上較不自由的缺點，所以基本上只要學會搜尋 <code>CASE 運算式</code> 即可。</p><div class="warning custom-block"><p class="custom-block-title">語法 6-A</p><p>簡單運算式</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">判斷對象</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">對象狀況1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">回應結果1</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">對象狀況2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">回應結果2</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">對象狀況3</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">回應結果3</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;"> ...</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">ELSE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">回應結果</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F78C6C;">END</span></span>
<span class="line"></span></code></pre></div></div><p>不同之處僅在於第 1 行的「 <code>CASE &lt;判斷對象&gt;</code> 」已經決定了判斷的對象。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-A</p><p>以 CASE 運算式替商品分類分別加上 A ~ C 的字串</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 搜尋 CASE 運算式的寫法</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">A:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">B:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">ELSE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> abc_shohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 簡單 CASE 運算式的寫法</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name,</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">A:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">B:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> shohin_catalg</span></span>
<span class="line"><span style="color:#A6ACCD;">          </span><span style="color:#F78C6C;">ELSE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> abc_shohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin;</span></span>
<span class="line"></span></code></pre></div></div></blockquote><blockquote><h3 id="column-case-運算式的專用語法" tabindex="-1">COLUMN CASE 運算式的專用語法 <a class="header-anchor" href="#column-case-運算式的專用語法" aria-hidden="true">#</a></h3><p>由於 CASE 運算式是標準 SQL 所認可的功能，所以不論在哪個 DBMS 都能正常執行，不過有些 DBMS 另外準備了 CASE 運算式經過簡化的專有函數，例如 Oracle 的 DECODE、或是 MySQL 和 MariaDB 的 IF 等。</p><div class="warning custom-block"><p class="custom-block-title">範例 6-B</p><p>使用 CASE 運算式的專用語法，替商品分類分別加上 A ~ C 的字串</p><ul><li>專用語法：<code>Oracle</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 以 Oracle 的 DECODE 取代 CASE 運算式</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name,</span></span>
<span class="line"><span style="color:#A6ACCD;">      DECODE(shohin_catalg, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">A:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> shohin_catalg,</span></span>
<span class="line"><span style="color:#A6ACCD;">                            </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">B:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> shohin_catalg,</span></span>
<span class="line"><span style="color:#A6ACCD;">                            </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">||</span><span style="color:#A6ACCD;"> shohin_catalg,</span></span>
<span class="line"><span style="color:#A6ACCD;">              </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> abc_shohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 以 MySQL 的 IF 取代 CASE 運算式</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name,</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">IF</span><span style="color:#A6ACCD;">( </span><span style="color:#F78C6C;">IF</span><span style="color:#A6ACCD;">( </span><span style="color:#F78C6C;">IF</span><span style="color:#A6ACCD;">(shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#82AAFF;">CONCAT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">A:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, shohin_catalg), </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#F78C6C;">IS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AND</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#82AAFF;">CONCAT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">B:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, shohin_catalg),</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">IF</span><span style="color:#A6ACCD;">(shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#82AAFF;">CONCAT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">A:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, shohin_catalg), </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#F78C6C;">IS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AND</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#82AAFF;">CONCAT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, shohin_catalg),</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">IF</span><span style="color:#A6ACCD;">(shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#82AAFF;">CONCAT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">A:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, shohin_catalg), </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#F78C6C;">IS</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AND</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#82AAFF;">CONCAT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">B:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, shohin_catalg),</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#F78C6C;">IF</span><span style="color:#A6ACCD;">(shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">                </span><span style="color:#82AAFF;">CONCAT</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">A:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, shohin_catalg),</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">))) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> abc_shohin_catalg</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin;</span></span>
<span class="line"></span></code></pre></div></div><p>不過這些函數只能在特定的 DBMS 上使用，而且能表達的條件也比 CASE 運算式來得少，沒有什麼實用上的價&gt; 值，建議避免使用這樣的專用語法。</p></blockquote></li></ul><h2 id="自我練習" tabindex="-1">自我練習 <a class="header-anchor" href="#自我練習" aria-hidden="true">#</a></h2><ul><li><p>6.1 如果對章節內容所使用過的 Shohin (商品) 資料表，執行下列 2 段 SELECT 敘述，會分別獲得什麼樣的結果呢？</p><ul><li><ol><li></li></ol><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> buying_price </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">5000</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><details class="details custom-block"><summary>練習</summary><table><thead><tr><th>shohin_name</th><th style="text-align:right;">buying_price</th></tr></thead><tbody><tr><td>打孔機</td><td style="text-align:right;">320</td></tr><tr><td>刨絲器</td><td style="text-align:right;">790</td></tr></tbody></table></details></li><li><ol start="2"><li></li></ol><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_name, buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> buying_price </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> (</span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">5000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><details class="details custom-block"><summary>練習</summary><table><thead><tr><th>shohin_name</th><th style="text-align:right;">buying_price</th></tr></thead></table></details></li></ul></li><li><p>6.2 對於問題 6.1 所提及的 Shohin(商品) 資料表，請根據各項商品販售單價 (sell_price) 的金額，按照下列條件將商品做分類。</p><ul><li>低價商品：販售單價低於 1000 (T恤、打孔機、叉子、刨絲器、鋼珠筆)。</li><li>中價商品：販售單價高於 1001、低於 3000 (菜刀)。</li><li>低價商品：販售單價高於 3001 (襯衫、壓力鍋)。</li></ul><p>然後撰寫 SELECT 敘述，列出各價格範圍分別有幾項商品，其結果的樣貌如下所示。</p><table><thead><tr><th>low_price</th><th>mid_price</th><th>high_price</th></tr></thead><tbody><tr><td>5</td><td>1</td><td>2</td></tr></tbody></table><details class="details custom-block"><summary>練習</summary><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">ELSE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> low_price,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AND</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">ELSE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> mid_price,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">ELSE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> high_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span></code></pre></div><p>或</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- CASE 不寫 ELSE 時，預設回傳 NULL，COUNT 不計算 NULL</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> low_price,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">AND</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">&lt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> mid_price,</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#82AAFF;">COUNT</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">CASE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">WHEN</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">THEN</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#F78C6C;">END</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> high_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"></span></code></pre></div></details></li></ul>`,88),t=[p];function e(c,C,r,d,y,A){return l(),a("div",null,t)}const F=s(o,[["render",e]]);export{D as __pageData,F as default};
