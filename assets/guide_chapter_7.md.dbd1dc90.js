import{_ as t,c as s,o as l,a as n}from"./app.12066fee.js";const g=JSON.parse('{"title":"第 7 章 集合運算 (合併查詢)","description":"","frontmatter":{"title":"第 7 章 集合運算 (合併查詢)"},"headers":[{"level":2,"title":"7-1 資料表的加法與減法運算","slug":"_7-1-資料表的加法與減法運算","link":"#_7-1-資料表的加法與減法運算","children":[{"level":3,"title":"什麼是集合運算 (Set Operations)","slug":"什麼是集合運算-set-operations","link":"#什麼是集合運算-set-operations","children":[]},{"level":3,"title":"資料表的加法運算 - UNION","slug":"資料表的加法運算-union","link":"#資料表的加法運算-union","children":[]},{"level":3,"title":"集合運算的注意事項","slug":"集合運算的注意事項","link":"#集合運算的注意事項","children":[]},{"level":3,"title":"列出重複紀錄的集合運算 - ALL 選項","slug":"列出重複紀錄的集合運算-all-選項","link":"#列出重複紀錄的集合運算-all-選項","children":[]},{"level":3,"title":"篩選出資料表的共通部分 - INTERSECT","slug":"篩選出資料表的共通部分-intersect","link":"#篩選出資料表的共通部分-intersect","children":[]},{"level":3,"title":"紀錄的減法運算 - EXCEPT","slug":"紀錄的減法運算-except","link":"#紀錄的減法運算-except","children":[]}]},{"level":2,"title":"7-2 結合 (聯結多個資料表欄位)","slug":"_7-2-結合-聯結多個資料表欄位","link":"#_7-2-結合-聯結多個資料表欄位","children":[{"level":3,"title":"什麼是結合","slug":"什麼是結合","link":"#什麼是結合","children":[]},{"level":3,"title":"內部結合 - INNER JOIN","slug":"內部結合-inner-join","link":"#內部結合-inner-join","children":[]},{"level":3,"title":"外部結合 - OUTER JOIN","slug":"外部結合-outer-join","link":"#外部結合-outer-join","children":[]},{"level":3,"title":"使用 3個 以上資料表的結合","slug":"使用-3個-以上資料表的結合","link":"#使用-3個-以上資料表的結合","children":[]},{"level":3,"title":"交叉結合 - CROSS JOIN","slug":"交叉結合-cross-join","link":"#交叉結合-cross-join","children":[]},{"level":3,"title":"結合的專用語法和舊化語法","slug":"結合的專用語法和舊化語法","link":"#結合的專用語法和舊化語法","children":[]}]},{"level":2,"title":"自我練習","slug":"自我練習","link":"#自我練習","children":[]}],"relativePath":"guide/chapter_7.md"}'),e={name:"guide/chapter_7.md"},a=n(`<h1 id="第-7-章-集合運算-合併查詢" tabindex="-1">第 7 章 集合運算 (合併查詢) <a class="header-anchor" href="#第-7-章-集合運算-合併查詢" aria-hidden="true">#</a></h1><h2 id="_7-1-資料表的加法與減法運算" tabindex="-1">7-1 資料表的加法與減法運算 <a class="header-anchor" href="#_7-1-資料表的加法與減法運算" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>所謂的集合運算是對多筆紀錄執行相加或相減的動作，可以說是紀錄的四則運算。</li><li>進行集合運算的時候，需要使用 <code>UNION (聯集)</code>、<code>INTERSECT (交集)</code> 和 <code>EXCEPT (差集)</code> 等集合運算子。</li><li>集合運算子預設會排除重複的紀錄。</li><li>使用集合運算子的時候，如果想列出重複的紀錄，需要加上 <code>ALL</code> 選項。</li></ul></div><h3 id="什麼是集合運算-set-operations" tabindex="-1">什麼是集合運算 (Set Operations) <a class="header-anchor" href="#什麼是集合運算-set-operations" aria-hidden="true">#</a></h3><p>「 <code>集合 (Set)</code> 」這個名稱在數學的領域中代表著「 <code>(各種) 事物的集合體</code> 」，而在資料庫的世界指的是「 <code>紀錄的集合</code> 」。</p><p>集合運算能對多筆紀錄執行相加或相減的動作，可以說是紀錄的四則運算。而用來執行集合運算的運算子就稱為「 <code>集合運算子</code> 」。</p><p>關聯式資料庫的集合運算也特別稱為 <code>關聯式代數 (Relational Algebra)</code>。</p><h3 id="資料表的加法運算-union" tabindex="-1">資料表的加法運算 - UNION <a class="header-anchor" href="#資料表的加法運算-union" aria-hidden="true">#</a></h3><p><code>UNION (聯集)</code>，便是用來執行紀錄加法運算。</p><p>實際開始之前，請先另外新增 1 個練習用的資料表。</p><div class="warning custom-block"><p class="custom-block-title">範例 7-1</p><p>建立 Shohin2 (商品2) 資料表</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Shohin2</span></span>
<span class="line"><span style="color:#A6ACCD;">(shohin_id </span><span style="color:#C792EA;">CHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">shohin_name </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">shohin_catalg </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">32</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">sell_price </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">buying_price </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">reg_date </span><span style="color:#C792EA;">DATE</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (shohin_id));</span></span>
<span class="line"></span></code></pre></div><p>並新增 5 筆紀錄</p><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">START TRANSACTION</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin2 </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">T恤</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin2 </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">打孔機</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">320</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-11</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin2 </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">襯衫</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">4000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin2 </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0009</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">手套</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin2 </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0010</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">水壺</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1700</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">COMMIT</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">專用語法</p><p>各家 <code>DBMS</code> 交易功能的語法略有差異，如果在 <code>PostgreSQL</code> 或 <code>SQL Server</code> 執行 範例 6-1 的 <code>DML 敘述</code> 時，需要將「 <code>START TRANSACTION</code> 」改為「 <code>BEGIN TRANSACTION</code> 」，而在 <code>Oracle</code> 或 <code>DB2</code> 上執行的時候，不需要「 <code>START TRANSACTION</code> 」，直接刪除即可。</p></div><p>試著針對這 2 個資料表執行「 Shohin 資料表 + Shohin2 資料表」的加法運算。</p><div class="warning custom-block"><p class="custom-block-title">範例 7-3</p><p>以 UNION 執行資料表的加法運算</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">UNION</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin2;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th></tr></thead><tbody><tr><td>0001</td><td>T恤</td></tr><tr><td>0002</td><td>打孔機</td></tr><tr><td>0003</td><td>襯衫</td></tr><tr><td>0004</td><td>菜刀</td></tr><tr><td>0005</td><td>壓力鍋</td></tr><tr><td>0006</td><td>叉子</td></tr><tr><td>0007</td><td>刨絲器</td></tr><tr><td>0008</td><td>鋼珠筆</td></tr><tr><td>0009</td><td>手套</td></tr><tr><td>0010</td><td>水壺</td></tr></tbody></table></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 7-1</p><p><code>集合運算子</code> 會排除重複的紀錄。</p></div><h3 id="集合運算的注意事項" tabindex="-1">集合運算的注意事項 <a class="header-anchor" href="#集合運算的注意事項" aria-hidden="true">#</a></h3><ul><li><h4 id="注意事項-1-運算對象的欄位數量必須相同" tabindex="-1">注意事項 1 - 運算對象的欄位數量必須相同 <a class="header-anchor" href="#注意事項-1-運算對象的欄位數量必須相同" aria-hidden="true">#</a></h4><p>由於一方的欄位數量不同，無法進行資料集合的加法運算。</p><div class="danger custom-block"><p class="custom-block-title">DANGER</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 因欄位數量不同而發生錯誤</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">UNION</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name, sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin2;</span></span>
<span class="line"></span></code></pre></div></div></li><li><h4 id="注意事項-2-對應欄位的資料型別必須一致" tabindex="-1">注意事項 2 - 對應欄位的資料型別必須一致 <a class="header-anchor" href="#注意事項-2-對應欄位的資料型別必須一致" aria-hidden="true">#</a></h4><p>從左側起算，處於相同位置的欄位，必須具有相同的資料型別。</p><div class="danger custom-block"><p class="custom-block-title">DANGER</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 因資料型別不一致而發生錯誤</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">UNION</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, reg_date</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin2;</span></span>
<span class="line"></span></code></pre></div></div></li><li><h4 id="注意事項-3-select-敘述可寫入各種子句-但-order-by-子句只能寫在最後-1-處" tabindex="-1">注意事項 3 - SELECT 敘述可寫入各種子句，但 ORDER BY 子句只能寫在最後 1 處 <a class="header-anchor" href="#注意事項-3-select-敘述可寫入各種子句-但-order-by-子句只能寫在最後-1-處" aria-hidden="true">#</a></h4><p>以 <code>UNION</code> 進行相加的 2 段 <code>SELECT 敘述</code> 可以寫入各種子句，不過，整段敘述只能有 1 個 <code>ORDER BY 子句</code>，而且必須寫在最後的位置。</p><div class="warning custom-block"><p class="custom-block-title">範例 7-4</p><p>ORDER BY 子句只能寫在最後 1 處</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F78C6C;">UNION</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin2</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> shohin_id;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th></tr></thead><tbody><tr><td>0004</td><td>菜刀</td></tr><tr><td>0005</td><td>壓力鍋</td></tr><tr><td>0006</td><td>叉子</td></tr><tr><td>0007</td><td>刨絲器</td></tr><tr><td>0010</td><td>水壺</td></tr></tbody></table></div></li></ul><h3 id="列出重複紀錄的集合運算-all-選項" tabindex="-1">列出重複紀錄的集合運算 - ALL 選項 <a class="header-anchor" href="#列出重複紀錄的集合運算-all-選項" aria-hidden="true">#</a></h3><p>要在 <code>UNION</code> 的結果中列出重複紀錄的語法，只要在 UNION 的後方加上「 ALL 」這個關鍵字即可。 <code>ALL 選項</code> 除了 <code>UNION</code> 之外，也適用於其他的集合運算子。</p><div class="warning custom-block"><p class="custom-block-title">範例 7-5</p><p>不排除重複的紀錄</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">UNION ALL</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin2;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th></tr></thead><tbody><tr><td>0001</td><td>T恤</td></tr><tr><td>0002</td><td>打孔機</td></tr><tr><td>0003</td><td>襯衫</td></tr><tr><td>0004</td><td>菜刀</td></tr><tr><td>0005</td><td>壓力鍋</td></tr><tr><td>0006</td><td>叉子</td></tr><tr><td>0007</td><td>刨絲器</td></tr><tr><td>0008</td><td>鋼珠筆</td></tr><tr><td>0001</td><td>T恤</td></tr><tr><td>0002</td><td>打孔機</td></tr><tr><td>0003</td><td>襯衫</td></tr><tr><td>0009</td><td>手套</td></tr><tr><td>0010</td><td>水壺</td></tr></tbody></table></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 7-2</p><p>使用集合運算子想列出重複的紀錄時，請加上 <code>ALL 選項</code>。</p></div><h3 id="篩選出資料表的共通部分-intersect" tabindex="-1">篩選出資料表的共通部分 - INTERSECT <a class="header-anchor" href="#篩選出資料表的共通部分-intersect" aria-hidden="true">#</a></h3><p>由於它能篩選出 2 組紀錄集合 (<code>SELECT 敘述</code> 的執行結果) 的共通部分，所以採用了 <code>INTERSECT (交集)</code> 這個關鍵字。</p><div class="warning custom-block"><p class="custom-block-title">範例 7-6</p><p>以 <code>INTERSECT</code> 篩選資料表的共通部分</p><ul><li>專用語法：<code>Oracle</code>、<code>SQL Server</code>、<code>DB2</code>、<code>PostgreSQL</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">INTERSECT</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin2</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> shohin_id;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th></tr></thead><tbody><tr><td>0001</td><td>T恤</td></tr><tr><td>0002</td><td>打孔機</td></tr><tr><td>0003</td><td>襯衫</td></tr></tbody></table></div><p><code>MySQL</code> 和 <code>MariaDB</code> 尚未實作 <code>INTERSECT</code> 的功能，所以無法使用。</p><p><code>MySQL</code> 和 <code>MariaDB</code> 可以用 <code>IN</code> 、 <code>EXISTS</code> 或 <code>JOIN</code> 等來替代，附上 1 個 <code>IN</code> 的寫法。</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_id </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin2</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> shohin_id;</span></span>
<span class="line"></span></code></pre></div><p><code>INTERSECT</code> 需要引用 2 個資料表篩選出共通的紀錄。</p><h3 id="紀錄的減法運算-except" tabindex="-1">紀錄的減法運算 - EXCEPT <a class="header-anchor" href="#紀錄的減法運算-except" aria-hidden="true">#</a></h3><p>減法運算的 <code>EXCEPT (差集)</code>，其語法也和 <code>UNION</code> 相同。</p><p><code>Oracle</code> 以 <code>MINUS</code> 取代 <code>EXCEPT</code>，<code>Oracle</code> 請直接把 <code>EXCEPT</code> 改為 <code>MINUS</code>。</p><p><code>MySQL</code>、<code>MariaDB</code> 尚未實作 <code>EXCEPT</code> 的功能，所以無法使用</p><div class="warning custom-block"><p class="custom-block-title">範例 7-7</p><p>以 <code>EXCEPT</code> 執行紀錄的減法運算</p><ul><li>專用語法：<code>SQL Server</code>、<code>DB2</code>、<code>PostgreSQL</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">EXCEPT</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin2</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> shohin_id;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>Oracle</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#A6ACCD;">MINUS</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin2</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> shohin_id;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code></li></ul><p><code>MySQL</code>、<code>MariaDB</code> 可用 <code>NOT IN</code> 或 <code>NOT EXISTS</code> 等來替代</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_id </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin2</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> shohin_id;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th></tr></thead><tbody><tr><td>0004</td><td>菜刀</td></tr><tr><td>0005</td><td>壓力鍋</td></tr><tr><td>0006</td><td>叉子</td></tr><tr><td>0007</td><td>刨絲器</td></tr><tr><td>0008</td><td>鋼珠筆</td></tr></tbody></table><p>此段敘述將 Shohin 資料表的紀錄減掉 Shohin2 資料表的紀錄。</p></div><p><code>EXCEPT</code> 的特點，需要特別留意，以何者減去何者將會獲得不同的結果。</p><div class="warning custom-block"><p class="custom-block-title">範例 7-8</p><p>以 <code>EXCEPT</code> 執行紀錄的減法運算</p><ul><li>專用語法：<code>SQL Server</code>、<code>DB2</code>、<code>PostgreSQL</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin2</span></span>
<span class="line"><span style="color:#F78C6C;">EXCEPT</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> shohin_id;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th></tr></thead><tbody><tr><td>0009</td><td>手套</td></tr><tr><td>0010</td><td>水壺</td></tr></tbody></table></div><h2 id="_7-2-結合-聯結多個資料表欄位" tabindex="-1">7-2 結合 (聯結多個資料表欄位) <a class="header-anchor" href="#_7-2-結合-聯結多個資料表欄位" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li><code>結合 (JOIN)</code> 能帶入其他資料表的欄位資料，可以說是「 <code>增加資料表欄位</code> 」的集合運算功能。相對於 <code>UNION</code> 是按照紀錄的方向 (縱向) 聯結不同資料表的資料，<code>結合</code> 則是順著欄位的方向 (橫向) 進行聯結。</li><li>結合基本上可分為 <code>內部結合</code> 與 <code>外部結合</code> 等 2 種類型，請確實地掌握這 2 種方式。</li><li>使用結合功能的時候，請勿使用舊式語法或專用語法，務必採用標準的 SQL 語法來撰寫。</li></ul></div><h3 id="什麼是結合" tabindex="-1">什麼是結合 <a class="header-anchor" href="#什麼是結合" aria-hidden="true">#</a></h3><p><code>結合 (JOIN)</code> 運算，簡單描述它的功能，可以說是從其他的資料表帶入欄位、增加資料表欄位的操作，而這項操作適用的場合，在於想取得的資料 (欄位) 存在於多個資料表的狀況。實務上，所需的資料散布在多個資料表的狀況相當常見，利用 <code>結合功能</code> 就能從多個資料表篩選出所需的資料集合形式。</p><h3 id="內部結合-inner-join" tabindex="-1">內部結合 - INNER JOIN <a class="header-anchor" href="#內部結合-inner-join" aria-hidden="true">#</a></h3><p><code>內部結合 (INNER JOIN)</code> 的功能，也是最常被使用的結合方式。</p><p>做為練習對象的資料表除了一直使用的 <code>Shohin 資料表</code> 之外，還有在第 6 章所建立過的 <code>StoreShohin 資料表</code>。</p><div class="tip custom-block"><p class="custom-block-title">表 7-1</p><p>Shohin (商品) 資料表</p><table><thead><tr><th>shohin_id (商品ID)</th><th>shohin_name (商品名稱)</th><th>shohin_catalg (商品分類)</th><th>sell_price (販售單價)</th><th>buying_price (購入單價)</th><th>reg_date (登錄日期)</th></tr></thead><tbody><tr><td>0001</td><td>T恤</td><td>衣物</td><td>1000</td><td>500</td><td>2009-09-20</td></tr><tr><td>0002</td><td>打孔機</td><td>辦公用品</td><td>500</td><td>320</td><td>2009-09-11</td></tr><tr><td>0003</td><td>襯衫</td><td>衣物</td><td>4000</td><td>2800</td><td></td></tr><tr><td>0004</td><td>菜刀</td><td>廚房用品</td><td>3000</td><td>2800</td><td>2009-09-20</td></tr><tr><td>0005</td><td>壓力鍋</td><td>廚房用品</td><td>6800</td><td>5000</td><td>2009-01-15</td></tr><tr><td>0006</td><td>叉子</td><td>廚房用品</td><td>500</td><td></td><td>2009-09-20</td></tr><tr><td>0007</td><td>刨絲器</td><td>廚房用品</td><td>880</td><td>790</td><td>2008-04-28</td></tr><tr><td>0008</td><td>鋼珠筆</td><td>辦公用品</td><td>100</td><td></td><td>2009-11-11</td></tr></tbody></table></div><div class="tip custom-block"><p class="custom-block-title">表 7-2</p><p>StoreShohin (店鋪商品) 資料表</p><table><thead><tr><th style="text-align:right;">store_id (店鋪ID)</th><th style="text-align:center;">store_name (店鋪名稱)</th><th style="text-align:right;">shohin_id (商品ID)</th><th style="text-align:right;">s_amount (數量)</th></tr></thead><tbody><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td style="text-align:right;">30</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td style="text-align:right;">50</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td style="text-align:right;">15</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td style="text-align:right;">30</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td style="text-align:right;">120</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td style="text-align:right;">20</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td style="text-align:right;">10</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td style="text-align:right;">40</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td style="text-align:right;">20</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td style="text-align:right;">50</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td style="text-align:right;">90</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td style="text-align:right;">70</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td style="text-align:right;">100</td></tr></tbody></table></div><div class="tip custom-block"><p class="custom-block-title">表 7-3</p><p>2 個資料表的欄位 分別具有哪些欄位</p><table><thead><tr><th></th><th style="text-align:center;">Shohin</th><th style="text-align:center;">StoreShohin</th></tr></thead><tbody><tr><td>商品ID</td><td style="text-align:center;">√</td><td style="text-align:center;">√</td></tr><tr><td>商品名稱</td><td style="text-align:center;">√</td><td style="text-align:center;"></td></tr><tr><td>商品分類</td><td style="text-align:center;">√</td><td style="text-align:center;"></td></tr><tr><td>販售單價</td><td style="text-align:center;">√</td><td style="text-align:center;"></td></tr><tr><td>購入單價</td><td style="text-align:center;">√</td><td style="text-align:center;"></td></tr><tr><td>登錄日期</td><td style="text-align:center;">√</td><td style="text-align:center;"></td></tr><tr><td>店鋪ID</td><td style="text-align:center;"></td><td style="text-align:center;">√</td></tr><tr><td>店鋪名稱</td><td style="text-align:center;"></td><td style="text-align:center;">√</td></tr><tr><td>數量</td><td style="text-align:center;"></td><td style="text-align:center;">√</td></tr></tbody></table><ul><li>🅐 2 個資料表均具有欄位 ➝ 商品ID</li><li>🅑 其中 1 個資料表才具有的欄位 ➝ 商品ID 之外的欄位</li></ul><p>將屬於 🅐 群組的欄位當作溝通的橋樑，讓屬於 🅑 群組的欄位能同時呈現於 1 組結果之中。</p></div><div class="warning custom-block"><p class="custom-block-title">範例 7-9</p><p>將 2 個資料表做內部結合</p><ul><li>專用語法：<code>SQL Server</code>、<code>DB2</code>、<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> SS.store_id, SS.store_name, SS.shohin_id, S.shohin_name, S.sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> SS </span><span style="color:#F78C6C;">INNER JOIN</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> S</span></span>
<span class="line"><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> SS.shohin_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> S.shohin_id</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> store_id;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:right;">store_id</th><th style="text-align:center;">store_name</th><th style="text-align:right;">shohin_id</th><th>shohin_name</th><th style="text-align:right;">sell_price</th></tr></thead><tbody><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>T恤</td><td style="text-align:right;">1000</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>打孔機</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td>打孔機</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td>菜刀</td><td style="text-align:right;">3000</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td>叉子</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td>刨絲器</td><td style="text-align:right;">880</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td>菜刀</td><td style="text-align:right;">3000</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td>叉子</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td>刨絲器</td><td style="text-align:right;">880</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td>T恤</td><td style="text-align:right;">1000</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>Oracle</code></p><p><code>Oracle</code> 在 <code>FROM 子句</code> 的地方不能使用 <code>AS</code> (會發生錯誤)，因此，想要在 <code>Oracle</code> 上執行 範例 7-9 敘述的時候， 請將「 <code>FROM StoreShohin AS SS INNER JOIN Shohin AS S</code> 」部分改為「 <code>FROM StoreShohin SS INNER JOIN Shohin S</code> 」(刪除 FROM 子句中的 AS)。</p></div><ul><li><h4 id="關於內部結合-有-3-個重點需要特別留意" tabindex="-1">關於內部結合，有 3 個重點需要特別留意： <a class="header-anchor" href="#關於內部結合-有-3-個重點需要特別留意" aria-hidden="true">#</a></h4><ul><li><h5 id="內部結合的重點-1-from-子句" tabindex="-1">內部結合的重點 1 - FROM 子句 <a class="header-anchor" href="#內部結合的重點-1-from-子句" aria-hidden="true">#</a></h5><p>先前都只有寫著 1 個資料表名稱的 <code>FROM 子句</code>，在這裡需要寫入 <code>StoreShohin</code> 以及 <code>Shohin</code> 等 2 個資料表的名稱。</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> SS </span><span style="color:#F78C6C;">INNER JOIN</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> S</span></span>
<span class="line"></span></code></pre></div><p>此種寫法能成立的關鍵字正是「 <code>INNER JOIN</code> 」，而 <code>SS</code> 和 <code>S</code> 的部分為資料表的別名，賦予別名並非必要的寫法，在 <code>SELECT 子句</code> 中亦可採用 <code>StoreShohin.shohin_id</code> 的方式，不過會增加閱讀的困難度，一般習慣賦予較為簡潔的別名。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 7-3</p><p>進行結合的時候，<code>FROM 子句</code> 中需要寫入多個資料表名稱</p></div></li><li><h5 id="內部結合的重點-2-on-子句" tabindex="-1">內部結合的重點 2 - ON 子句 <a class="header-anchor" href="#內部結合的重點-2-on-子句" aria-hidden="true">#</a></h5><p>結合條件</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> SS.shohin_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> S.shohin_id</span></span>
<span class="line"></span></code></pre></div><p>指定了用來聯結 2 個資料表的欄位，也就是所謂的 <code>結合鍵 (Join Key)</code>。而 <code>ON</code> 有如結合條件專用的 <code>WHERE 關鍵字</code>，由於和 <code>WHERE 子句</code> 同樣能指定多個結合鍵，所以也可以使用 <code>AND</code> 和 <code>OR</code> 等運算子。</p><p>撰寫位置必須位於 FROM 和 WHERE 子句之間。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 7-4</p><p>內部結合必須有 <code>ON 子句</code>，其撰寫位置在 <code>FROM</code> 和 <code>WHERE</code> 子句之間。</p></div></li><li><h5 id="內部結合的重點-3-select-子句" tabindex="-1">內部結合的重點 3 - SELECT 子句 <a class="header-anchor" href="#內部結合的重點-3-select-子句" aria-hidden="true">#</a></h5></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> SS.store_id, SS.store_name, SS.shohin_id, S.shohin_name, S.sell_price</span></span>
<span class="line"></span></code></pre></div><p><code>SELECT 子句</code> 中採用了 <code>SS.store_id</code> 或 <code>S.sell_price</code> 這樣的寫法，也就是 <code>&lt;資料表名稱&gt;.&lt;欄位名稱&gt;</code> 的格式來指定欄位，如此方能明確指定出需要的欄位。</p><p>在語法的規定上，只有 2 個資料表都具有的欄位，才必須冠上資料表的名稱，不過為了容易閱讀理解，使用結合功能的時候，建議將 <code>SELECT 子句</code> 中的所有欄位都寫成 <code>&lt;資料表名稱&gt;.&lt;欄位名稱&gt;</code> 的格式。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 7-5</p><p>使用 <code>結合(JOIN)</code> 的時候，<code>SELECT 子句</code> 的欄位應當寫成 <code>&lt;資料表名稱&gt;.&lt;欄位名稱&gt;</code> 的格式。</p></div></li><li><h4 id="內部結合-與-where-子句-組合使用" tabindex="-1">內部結合 與 WHERE 子句 組合使用 <a class="header-anchor" href="#內部結合-與-where-子句-組合使用" aria-hidden="true">#</a></h4><p>如果不想 1 次取得全部的店舖，而只取得 東京店 (000A) 的資訊。</p><div class="warning custom-block"><p class="custom-block-title">範例 7-10</p><p>組合使用 內部結合 與 WHERE 子句</p><ul><li>專用語法：<code>SQL Server</code>、<code>DB2</code>、<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> SS.store_id, SS.store_name, SS.shohin_id, S.shohin_name, S.sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> SS </span><span style="color:#F78C6C;">INNER JOIN</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> S</span></span>
<span class="line"><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> SS.shohin_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> S.shohin_id</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> SS.store_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000A</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:right;">store_id</th><th style="text-align:center;">store_name</th><th style="text-align:right;">shohin_id</th><th>shohin_name</th><th style="text-align:right;">sell_price</th></tr></thead><tbody><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>T恤</td><td style="text-align:right;">1000</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>打孔機</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>Oracle</code></p><p><code>Oracle</code> 在 <code>FROM 子句</code> 的地方不能使用 <code>AS</code> (會發生錯誤)，因此，想要在 <code>Oracle</code> 上執行 範例 7-10 敘述的時候， 請將「 <code>FROM StoreShohin AS SS INNER JOIN Shohin AS S</code> 」部分改為「 <code>FROM StoreShohin SS INNER JOIN Shohin S</code> 」(刪除 FROM 子句中的 AS)。</p></div><p>結合運算將 2 個資料表做結合之後，同樣可以附加使用先前介紹過的 <code>WHERE</code>、<code>GROUP BY</code>、<code>HAVING</code> 以及 <code>ORDER BY</code> 等輔助功能的子句。</p></li></ul><h3 id="外部結合-outer-join" tabindex="-1">外部結合 - OUTER JOIN <a class="header-anchor" href="#外部結合-outer-join" aria-hidden="true">#</a></h3><p><code>外部結合</code> 也是以 <code>ON 子句</code> 所指定的結合鍵來聯結 2 個資料表，而能同時篩選出不同資料表欄位，不同的地方僅在於執行結果的形式。</p><div class="warning custom-block"><p class="custom-block-title">範例 7-11</p><p>將 2 個資料表進行 外部結合</p><ul><li>專用語法：<code>SQL Server</code>、<code>DB2</code>、<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> SS.store_id, SS.store_name, S.shohin_id, S.shohin_name, S.sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> SS </span><span style="color:#F78C6C;">RIGHT OUTER JOIN</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> S</span></span>
<span class="line"><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> SS.shohin_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> S.shohin_id</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> store_id;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:right;">store_id</th><th style="text-align:center;">store_name</th><th style="text-align:right;">shohin_id</th><th>shohin_name</th><th style="text-align:right;">sell_price</th></tr></thead><tbody><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>T恤</td><td style="text-align:right;">1000</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>打孔機</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td>打孔機</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td>菜刀</td><td style="text-align:right;">3000</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td>叉子</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td>刨絲器</td><td style="text-align:right;">880</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td>菜刀</td><td style="text-align:right;">3000</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td>叉子</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td>刨絲器</td><td style="text-align:right;">880</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td>T恤</td><td style="text-align:right;">1000</td></tr><tr><td style="text-align:right;"></td><td style="text-align:center;"></td><td style="text-align:right;">0005</td><td>壓力鍋</td><td style="text-align:right;">6800</td></tr><tr><td style="text-align:right;"></td><td style="text-align:center;"></td><td style="text-align:right;">0008</td><td>鋼珠筆</td><td style="text-align:right;">100</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>Oracle</code></p><p><code>Oracle</code> 在 <code>FROM 子句</code> 的地方不能使用 <code>AS</code> (會發生錯誤)，因此，想要在 <code>Oracle</code> 上執行 範例 7-11 敘述的時候， 請將「 <code>FROM StoreShohin AS SS RIGHT OUTER JOIN Shohin AS S</code> 」部分改為「 <code>FROM StoreShohin SS RIGHT OUTER JOIN Shohin S</code> 」(刪除 FROM 子句中的 AS)。</p></div><ul><li><h4 id="外部結合的重點-1-會輸出其中-1-個資料表的全部資訊" tabindex="-1">外部結合的重點 1 - 會輸出其中 1 個資料表的全部資訊 <a class="header-anchor" href="#外部結合的重點-1-會輸出其中-1-個資料表的全部資訊" aria-hidden="true">#</a></h4><p><code>外部結合</code>，代表了「 <code>原資料表中沒有，需要以資料表外部的資訊加入結果之中</code> 」的意思。 <code>內部結合</code>，只列出資料表內部既有資料的結合方式，只會篩選出 2 個資料表都具有的資訊。</p></li><li><h4 id="外部結合的重點-2-以哪個資料表為主" tabindex="-1">外部結合的重點 2 - 以哪個資料表為主？ <a class="header-anchor" href="#外部結合的重點-2-以哪個資料表為主" aria-hidden="true">#</a></h4><p>外部結合 的 篩選結果，會將被指定為主要資料表的所有資訊全部列出，而用來指定的關鍵字為「 <code>LEFT</code> 」、「 <code>RIGHT</code> 」，如果使用 <code>LEFT</code> 會指定 <code>FROM 子句</code> 中寫在左側的資料表為主要資料表，若使用 <code>RIGHT</code> 則會以右側資料表為主。</p></li></ul><div class="tip custom-block"><p class="custom-block-title">牢記的原則 7-6</p><p>外部結合 使用 LEFT 或 RIGHT 來指定主要的資料表。</p></div><h3 id="使用-3個-以上資料表的結合" tabindex="-1">使用 3個 以上資料表的結合 <a class="header-anchor" href="#使用-3個-以上資料表的結合" aria-hidden="true">#</a></h3><p>參與結合的資料表數量，原則上沒有限制。</p><p>請另外建立 表7-5，用來管理商品庫存的資料表。</p><div class="tip custom-block"><p class="custom-block-title">表 7-5</p><p>StockShohin (庫存商品) 資料表</p><table><thead><tr><th>whouse_id (倉庫ID)</th><th>shohin_id (商品ID)</th><th style="text-align:right;">stock_amount (庫存數量)</th></tr></thead><tbody><tr><td>S001</td><td>0001</td><td style="text-align:right;">0</td></tr><tr><td>S001</td><td>0002</td><td style="text-align:right;">120</td></tr><tr><td>S001</td><td>0003</td><td style="text-align:right;">200</td></tr><tr><td>S001</td><td>0004</td><td style="text-align:right;">3</td></tr><tr><td>S001</td><td>0005</td><td style="text-align:right;">0</td></tr><tr><td>S001</td><td>0006</td><td style="text-align:right;">99</td></tr><tr><td>S001</td><td>0007</td><td style="text-align:right;">999</td></tr><tr><td>S001</td><td>0008</td><td style="text-align:right;">200</td></tr><tr><td>S002</td><td>0001</td><td style="text-align:right;">10</td></tr><tr><td>S002</td><td>0002</td><td style="text-align:right;">25</td></tr><tr><td>S002</td><td>0003</td><td style="text-align:right;">34</td></tr><tr><td>S002</td><td>0004</td><td style="text-align:right;">19</td></tr><tr><td>S002</td><td>0005</td><td style="text-align:right;">99</td></tr><tr><td>S002</td><td>0006</td><td style="text-align:right;">0</td></tr><tr><td>S002</td><td>0007</td><td style="text-align:right;">0</td></tr><tr><td>S002</td><td>0008</td><td style="text-align:right;">18</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">範例 7-13</p><p>建立 StockShohin 資料表與存入資料</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- DDL：建立資料表</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">StockShohin</span></span>
<span class="line"><span style="color:#A6ACCD;">(whouse_id </span><span style="color:#C792EA;">CHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;"> shohin_id </span><span style="color:#C792EA;">CHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;"> stock_amount </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (whouse_id, shohin_id));</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- DML：存入資料</span></span>
<span class="line"><span style="color:#F78C6C;">START TRANSACTION</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">120</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">200</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0004</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">3</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0005</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0006</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">99</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">999</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0008</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">200</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">25</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">34</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0004</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">19</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0005</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">99</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0006</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> StockShohin (whouse_id, shohin_id, stock_amount) </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0008</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">18</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">COMMIT</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">專用語法</p><p>各家 <code>DBMS</code> 交易功能的語法略有差異，如果在 <code>PostgreSQL</code> 或 <code>SQL Server</code> 執行 範例 7-13 的 <code>DML 敘述</code> 時，需要將「 <code>START TRANSACTION</code> 」改為「 <code>BEGIN TRANSACTION</code> 」，而在 <code>Oracle</code> 或 <code>DB2</code> 上執行的時候，不需要「 <code>START TRANSACTION</code> 」，直接刪除即可。</p></div><div class="warning custom-block"><p class="custom-block-title">範例 7-14</p><p>以 3 個資料表做內部結合</p><ul><li>專用語法：<code>SQL Server</code>、<code>DB2</code>、<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> SS.store_id, SS.store_name, SS.shohin_id, S.shohin_name, S.sell_price, ZS.stock_amount</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> SS</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">INNER JOIN</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> S</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> SS.shohin_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> S.shohin_id</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">INNER JOIN</span><span style="color:#A6ACCD;"> StockShohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> ZS</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> SS.shohin_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ZS.shohin_id</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> ZS.whouse_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">S001</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> store_id;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:right;">store_id</th><th style="text-align:center;">store_name</th><th style="text-align:right;">shohin_id</th><th>shohin_name</th><th style="text-align:right;">sell_price</th><th style="text-align:right;">stock_amount</th></tr></thead><tbody><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>T恤</td><td style="text-align:right;">1000</td><td style="text-align:right;">0</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>打孔機</td><td style="text-align:right;">500</td><td style="text-align:right;">120</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td><td style="text-align:right;">200</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td>打孔機</td><td style="text-align:right;">500</td><td style="text-align:right;">120</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td><td style="text-align:right;">200</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td>菜刀</td><td style="text-align:right;">3000</td><td style="text-align:right;">3</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td>叉子</td><td style="text-align:right;">500</td><td style="text-align:right;">99</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td>刨絲器</td><td style="text-align:right;">880</td><td style="text-align:right;">999</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td><td style="text-align:right;">200</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td>菜刀</td><td style="text-align:right;">3000</td><td style="text-align:right;">3</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td>叉子</td><td style="text-align:right;">500</td><td style="text-align:right;">99</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td>刨絲器</td><td style="text-align:right;">880</td><td style="text-align:right;">999</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td>T恤</td><td style="text-align:right;">1000</td><td style="text-align:right;">0</td></tr></tbody></table><p>在原本進行內部結合的 <code>FROM 子句</code> 後方，再度以 <code>INNER JOIN</code> 加上 <code>StockShohin 資料表</code> 的資料。</p></div><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>Oracle</code></p><p><code>Oracle</code> 在 <code>FROM 子句</code> 的地方不能使用 <code>AS</code> (會發生錯誤)，因此，想要在 <code>Oracle</code> 上執行 範例 7-14 敘述的時候， 請將「 <code>FROM StoreShohin AS SS INNER JOIN Shohin AS S</code> 」部分改為「 <code>FROM StoreShohin SS INNER JOIN Shohin S</code> 」，將「 <code>INNER JOIN StockShohin AS ZS</code> 」部分改為「 <code>INNER JOIN StockShohin ZS</code> 」(刪除 FROM 子句中的 AS)。</p></div><h3 id="交叉結合-cross-join" tabindex="-1">交叉結合 - CROSS JOIN <a class="header-anchor" href="#交叉結合-cross-join" aria-hidden="true">#</a></h3><p>交叉結合 (CROSS JOIN) 在實務上幾乎不會使用，但交叉結合是所有結合運算的基礎。</p><div class="warning custom-block"><p class="custom-block-title">範例 7-15</p><p>2 個資料表進行交叉結合</p><ul><li>專用語法：<code>SQL Server</code>、<code>DB2</code>、<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> SS.store_id, SS.store_name, SS.shohin_id, S.shohin_name</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> SS </span><span style="color:#F78C6C;">CROSS JOIN</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> S;</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th style="text-align:right;">store_id</th><th style="text-align:center;">store_name</th><th style="text-align:right;">shohin_id</th><th>shohin_name</th></tr></thead><tbody><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>T恤</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>T恤</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>T恤</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td>T恤</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td>T恤</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td>T恤</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td>T恤</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td>T恤</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td>T恤</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td>T恤</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td>T恤</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td>T恤</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td>T恤</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>打孔機</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>打孔機</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>打孔機</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td>打孔機</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td>打孔機</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td>打孔機</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td>打孔機</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td>打孔機</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td>打孔機</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td>打孔機</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td>打孔機</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td>打孔機</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td>打孔機</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>襯衫</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>襯衫</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>襯衫</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td>襯衫</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td>襯衫</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td>襯衫</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td>襯衫</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td>襯衫</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td>襯衫</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td>襯衫</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td>襯衫</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td>襯衫</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td>襯衫</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>菜刀</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>菜刀</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>菜刀</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td>菜刀</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td>菜刀</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td>菜刀</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td>菜刀</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td>菜刀</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td>菜刀</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td>菜刀</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td>菜刀</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td>菜刀</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td>菜刀</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td>壓力鍋</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>叉子</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>叉子</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>叉子</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td>叉子</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td>叉子</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td>叉子</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td>叉子</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td>叉子</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td>叉子</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td>叉子</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td>叉子</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td>叉子</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td>叉子</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td>刨絲器</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>鋼珠筆</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>鋼珠筆</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>鋼珠筆</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td>鋼珠筆</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td>鋼珠筆</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td>鋼珠筆</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td>鋼珠筆</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td>鋼珠筆</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td>鋼珠筆</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td>鋼珠筆</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td>鋼珠筆</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td>鋼珠筆</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td>鋼珠筆</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>Oracle</code></p><p><code>Oracle</code> 在 <code>FROM 子句</code> 的地方不能使用 <code>AS</code> (會發生錯誤)，因此，想要在 <code>Oracle</code> 上執行 範例 7-15 敘述的時候， 請將「 <code>FROM StoreShohin AS SS CROSS JOIN Shohin AS S</code> 」部分改為「 <code>FROM StoreShohin SS CROSS JOIN Shohin S</code> 」(刪除 FROM 子句中的 AS)。</p></div><p><code>交叉結合</code> 用來連結 2 個資料表的集合運算子為「 <code>CROSS JOIN (笛卡兒乘積)</code> 」，進行 <code>交叉結合</code> 的時候，不能以先前內部或外部結合使用過的 <code>ON 子句</code> 來指定條件。</p><p><code>交叉結合</code> 運算時會針對 2 個資料表的全部紀錄，逐一列出所有的組合方式，因此其執行結果的紀錄筆數一定是 2 個資料表紀錄筆數的乘積 ( <code>A 資料表筆數</code> X <code>B 資料表筆數</code> )。</p><p><code>內部結合</code> 的結果 包含在交叉結合的結果 <code>之內</code>。</p><p><code>外部結合</code> 的結果 含有交叉結合結果 <code>以外</code> 的部分。</p><h3 id="結合的專用語法和舊化語法" tabindex="-1">結合的專用語法和舊化語法 <a class="header-anchor" href="#結合的專用語法和舊化語法" aria-hidden="true">#</a></h3><p><code>內部結合</code> 和 <code>外部結合</code> 的語法，皆為 <code>標準 SQL</code> 所訂定的正式寫法，可以在所有的 <code>DBMS</code> 上執行。</p><div class="warning custom-block"><p class="custom-block-title">範例 7-16</p><p>使用舊式語法的 <code>內部結合</code> (執行結果與 範例 7-9 相同)</p><ul><li>專用語法：<code>SQL Server</code>、<code>DB2</code>、<code>PostgreSQL</code>、<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> SS.store_id, SS.store_name, SS.shohin_id, S.shohin_name, S.sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin SS, Shohin S</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> SS.shohin_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> S.shohin_id</span></span>
<span class="line"><span style="color:#F78C6C;">AND</span><span style="color:#A6ACCD;"> SS.store_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">000A</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><p>雖然可以正常執行，不過此種寫法除了較為過時之外，還具有其他許多問題，建議不要再使用這些語法，其主要原因有下列 3 項理由。</p><ul><li>第 1 個，此種寫法比較難以讓人一目了然，其結合的類型到底是 <code>內部結合</code> 或 <code>外部結合</code> (或其他的結合方式)。</li><li>第 2 個，由於結合的條件是寫在 <code>WHERE 子句</code> 之中，所以比較難以看出哪裡是結合條件，哪裡又是篩選紀錄的限制條件。</li><li>第 3 個，沒有人能確定此語法可以使用到什麼時候。各家 <code>DBMS</code> 的開發廠商正在考慮捨棄此舊式語法，只支援新的語法。</li></ul><div class="tip custom-block"><p class="custom-block-title">牢記的原則 7-7</p><p>請勿再使用結合的 <code>舊式語法</code> 或 <code>專用語法</code>，不過還是需要具備解讀的能力。</p></div><blockquote><h3 id="column-關聯式除法運算" tabindex="-1">COLUMN 關聯式除法運算 <a class="header-anchor" href="#column-關聯式除法運算" aria-hidden="true">#</a></h3><p>這個章節學習過了下列 4 個集合運算子的相關使用方式。</p><ul><li><code>UNION (聯集)</code> (加)</li><li><code>EXCEPT (差集)</code> (減)</li><li><code>INTERSECT (交集)</code> (重複的部分)</li><li><code>CROSS JOIN (笛卡兒乘積)</code> (乘) 在集合運算中的除法運算一般稱為「 關聯式除法運算 (Relational Division) 」，其中關聯式的稱呼來自於目前主流資料庫的關聯式模型。</li></ul><p>後面會使用到 <code>表7-A</code> 和 <code>表7-B</code></p><div class="tip custom-block"><p class="custom-block-title">表 7-A</p><p>SKILLs (技能) 資料表：關聯式除法運算的除數</p><table><thead><tr><th>Skill</th></tr></thead><tbody><tr><td>Oracle</td></tr><tr><td>UNIX</td></tr><tr><td>Java</td></tr></tbody></table></div><div class="tip custom-block"><p class="custom-block-title">表 7-B</p><p>EmpSkills (員工技能) 資料表：關聯式除法運算的被除數</p><table><thead><tr><th>emp</th><th>skill</th></tr></thead><tbody><tr><td>相田</td><td>Oracle</td></tr><tr><td>相田</td><td>UNIX</td></tr><tr><td>相田</td><td>Java</td></tr><tr><td>相田</td><td>C#</td></tr><tr><td>神崎</td><td>Oracle</td></tr><tr><td>神崎</td><td>UNIX</td></tr><tr><td>神崎</td><td>Java</td></tr><tr><td>平井</td><td>UNIX</td></tr><tr><td>平井</td><td>Oracle</td></tr><tr><td>平井</td><td>PHP</td></tr><tr><td>平井</td><td>Perl</td></tr><tr><td>平井</td><td>C++</td></tr><tr><td>若田部</td><td>Perl</td></tr><tr><td>渡來</td><td>Oracle</td></tr></tbody></table></div><div class="warning custom-block"><p class="custom-block-title">範例 7-A</p><p>建立 Skills/EmpSkills 資料表與存入資料</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- DDL：建立資料表</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Skills</span></span>
<span class="line"><span style="color:#A6ACCD;">(skill </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">32</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (skill));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">EmpSkills</span></span>
<span class="line"><span style="color:#A6ACCD;">(emp </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">32</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;"> skill </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">32</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (emp, skill));</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- DML：存入資料</span></span>
<span class="line"><span style="color:#F78C6C;">START TRANSACTION</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Skills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Oracle</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Skills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">UNIX</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Skills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Java</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">相田</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Oracle</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">相田</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">UNIX</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">相田</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Java</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">相田</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C#</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">神崎</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Oracle</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">神崎</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">UNIX</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">神崎</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Java</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">平井</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">UNIX</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">平井</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Oracle</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">平井</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">PHP</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">平井</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Perl</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">平井</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">C++</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">若田部</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Perl</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">渡來</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Oracle</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">COMMIT</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">專用語法</p><p>各家 <code>DBMS</code> 交易功能的語法略有差異，如果在 <code>PostgreSQL</code> 或 <code>SQL Server</code> 執行 範例 7-A 的<code>DML 敘述</code> 時，需要將「 <code>START TRANSACTION</code> 」改為「 <code>BEGIN TRANSACTION</code> 」，而在 <code>Oracle</code> 或 <code>DB2</code> 上執行的時候，不需要「 <code>START TRANSACTION</code> 」，直接刪除即可。</p></div><p>這裡所要達成的目標，是根據 EmpSkills 資料表的內容，篩選出「 同時兼具 」Skills 資料表所列 3 種技能的員工名字。</p><div class="warning custom-block"><p class="custom-block-title">範例 7-B</p><p>篩選出兼具 3 種技能的員工</p><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT DISTINCT</span><span style="color:#A6ACCD;"> emp</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> ES1</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">EXISTS</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> skill</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Skills</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> skill </span><span style="color:#F78C6C;">NOT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> skill</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> EmpSkills </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> ES2</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> ES1.emp </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> ES2.emp</span></span>
<span class="line"><span style="color:#A6ACCD;">  )</span></span>
<span class="line"><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><table><thead><tr><th>emp</th></tr></thead><tbody><tr><td>神崎</td></tr><tr><td>相田</td></tr></tbody></table></div></blockquote><h2 id="自我練習" tabindex="-1">自我練習 <a class="header-anchor" href="#自我練習" aria-hidden="true">#</a></h2><ul><li><p>7.1 下列 SELECT 敘述執行之後會獲得什麼樣的結果呢？</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 使用主文中的 Shohin 資料表</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">UNION</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_id </span><span style="color:#F78C6C;">IN</span><span style="color:#A6ACCD;"> (</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> shohin_id;</span></span>
<span class="line"></span></code></pre></div><details class="details custom-block"><summary>練習</summary><table><thead><tr><th style="text-align:right;">shohin_id</th><th>shohin_name</th><th>shohin_catalg</th><th style="text-align:right;">sell_price</th><th style="text-align:right;">buying_price</th><th>reg_date</th></tr></thead><tbody><tr><td style="text-align:right;">0001</td><td>T恤</td><td>衣物</td><td style="text-align:right;">1000</td><td style="text-align:right;">500</td><td>2009-09-20</td></tr><tr><td style="text-align:right;">0002</td><td>打孔機</td><td>辦公用品</td><td style="text-align:right;">500</td><td style="text-align:right;">320</td><td>2009-09-11</td></tr><tr><td style="text-align:right;">0003</td><td>襯衫</td><td>衣物</td><td style="text-align:right;">4000</td><td style="text-align:right;">2800</td><td></td></tr><tr><td style="text-align:right;">0004</td><td>菜刀</td><td>廚房用品</td><td style="text-align:right;">3000</td><td style="text-align:right;">2800</td><td>2009-09-20</td></tr><tr><td style="text-align:right;">0005</td><td>壓力鍋</td><td>廚房用品</td><td style="text-align:right;">6800</td><td style="text-align:right;">5000</td><td>2009-01-15</td></tr><tr><td style="text-align:right;">0006</td><td>叉子</td><td>廚房用品</td><td style="text-align:right;">500</td><td style="text-align:right;"></td><td>2009-09-20</td></tr><tr><td style="text-align:right;">0007</td><td>刨絲器</td><td>廚房用品</td><td style="text-align:right;">880</td><td style="text-align:right;">790</td><td>2008-04-28</td></tr><tr><td style="text-align:right;">0008</td><td>鋼珠筆</td><td>辦公用品</td><td style="text-align:right;">100</td><td style="text-align:right;"></td><td>2009-11-11</td></tr></tbody></table></details></li><li><p>7.2 7-2節範例7-11 進行外部結合的結果中，壓力鍋和鋼珠筆這 2 筆紀錄的店舖 ID (store_id) 和店舖名稱 (store_name) 為 NULL，請試著將這些 NULL 都轉換成 「 未知 」的字串，最後的結果如下所示。 執行結果</p><table><thead><tr><th style="text-align:right;">store_id</th><th style="text-align:center;">store_name</th><th style="text-align:right;">shohin_id</th><th>shohin_name</th><th style="text-align:right;">sell_price</th></tr></thead><tbody><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0001</td><td>T恤</td><td style="text-align:right;">1000</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0002</td><td>打孔機</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000A</td><td style="text-align:center;">東京</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0002</td><td>打孔機</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0004</td><td>菜刀</td><td style="text-align:right;">3000</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0006</td><td>叉子</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000B</td><td style="text-align:center;">名古屋</td><td style="text-align:right;">0007</td><td>刨絲器</td><td style="text-align:right;">880</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0003</td><td>襯衫</td><td style="text-align:right;">4000</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0004</td><td>菜刀</td><td style="text-align:right;">3000</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0006</td><td>叉子</td><td style="text-align:right;">500</td></tr><tr><td style="text-align:right;">000C</td><td style="text-align:center;">大阪</td><td style="text-align:right;">0007</td><td>刨絲器</td><td style="text-align:right;">880</td></tr><tr><td style="text-align:right;">000D</td><td style="text-align:center;">福岡</td><td style="text-align:right;">0001</td><td>T恤</td><td style="text-align:right;">1000</td></tr><tr><td style="text-align:right;">未知</td><td style="text-align:center;">未知</td><td style="text-align:right;">0005</td><td>壓力鍋</td><td style="text-align:right;">6800</td></tr><tr><td style="text-align:right;">未知</td><td style="text-align:center;">未知</td><td style="text-align:right;">0008</td><td>鋼珠筆</td><td style="text-align:right;">100</td></tr></tbody></table><details class="details custom-block"><summary>練習</summary><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- COALESCE 會逐一回傳 不是 NULL 的值</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(SS.store_id, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">未知</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> s_id, </span><span style="color:#82AAFF;">COALESCE</span><span style="color:#A6ACCD;">(SS.store_name, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">未知</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> s_name, S.shohin_id, S.shohin_name, S.sell_price</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> StoreShohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> SS </span><span style="color:#F78C6C;">RIGHT OUTER JOIN</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> S</span></span>
<span class="line"><span style="color:#F78C6C;">ON</span><span style="color:#A6ACCD;"> SS.shohin_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> S.shohin_id</span></span>
<span class="line"><span style="color:#F78C6C;">ORDER BY</span><span style="color:#A6ACCD;"> store_id;</span></span>
<span class="line"></span></code></pre></div></details></li></ul>`,79),o=[a];function d(p,r,c,i,y,C){return l(),s("div",null,o)}const A=t(e,[["render",d]]);export{g as __pageData,A as default};
