<!DOCTYPE html>
<html lang="zh-TW" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第 4 章 更新資料 | 從零開始 邁向數據分析 SQL 資料庫語法入門</title>
    <meta name="description" content="閱讀筆記">
    <link rel="preload stylesheet" href="/vitepress-SQL-zero/assets/style.721c165b.css" as="style">
    <link rel="modulepreload" href="/vitepress-SQL-zero/assets/app.12066fee.js">
    <link rel="modulepreload" href="/vitepress-SQL-zero/assets/guide_chapter_4.md.443483c4.lean.js">
    
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-93a960b4><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-93a960b4 data-v-790c334c><div class="VPNavBar has-sidebar" data-v-790c334c data-v-eda5fd6f><div class="container" data-v-eda5fd6f><div class="title" data-v-eda5fd6f><div class="VPNavBarTitle has-sidebar" data-v-eda5fd6f data-v-6d2fb2d9><a class="title" href="/vitepress-SQL-zero/" data-v-6d2fb2d9><!--[--><!--]--><!--[--><img class="VPImage logo" src="/vitepress-SQL-zero/apple-touch-icon.png" alt data-v-6db2186b><!--]--><!--[-->從零開始 邁向數據分析 SQL 資料庫語法入門<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-eda5fd6f><div class="curtain" data-v-eda5fd6f></div><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-eda5fd6f data-v-bdedfc22><span id="main-nav-aria-label" class="visually-hidden" data-v-bdedfc22>Main Navigation</span><!--[--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-eda5fd6f data-v-da3f667a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-da3f667a data-v-0d529b6d data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-0d529b6d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-0d529b6d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-eda5fd6f data-v-f38c483a data-v-96001b6b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-96001b6b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-96001b6b><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-96001b6b><div class="VPMenu" data-v-96001b6b data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-f38c483a><div class="item appearance" data-v-f38c483a><p class="label" data-v-f38c483a>Appearance</p><div class="appearance-action" data-v-f38c483a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-f38c483a data-v-0d529b6d data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-0d529b6d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-0d529b6d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-eda5fd6f data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-93a960b4 data-v-2817d72e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2817d72e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-2817d72e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-2817d72e>Menu</span></button><a class="top-link" href="#" data-v-2817d72e>Return to top</a></div><aside class="VPSidebar" data-v-93a960b4 data-v-941101de><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-941101de><span class="visually-hidden" id="sidebar-aria-label" data-v-941101de> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-941101de><section class="VPSidebarGroup" data-v-941101de data-v-c88a18d6><div class="title" data-v-c88a18d6><h2 class="title-text" data-v-c88a18d6>目錄</h2><div class="action" data-v-c88a18d6><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-c88a18d6><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-c88a18d6><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-c88a18d6><!--[--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_0.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 0 章 建構 SQL 執行環境</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_1.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 1 章 資料庫與SQL</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_2.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 2 章 查詢的基本語法</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_3.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 3 章 彙總與排序</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link active" href="/vitepress-SQL-zero/guide/chapter_4.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 4 章 更新資料</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_5.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 5 章 進階查詢功能</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_6.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 6 章 函數、述詞、CASE 運算式</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_7.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 7 章 集合運算 (合併查詢)</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_8.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 8 章 SQL 進階處理功能</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_9.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 9 章 從應用程式連接資料庫</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-93a960b4 data-v-0bd490fb><div class="VPDoc has-sidebar has-aside" data-v-0bd490fb data-v-c5936a1e><div class="container" data-v-c5936a1e><div class="aside" data-v-c5936a1e><div class="aside-curtain" data-v-c5936a1e></div><div class="aside-container" data-v-c5936a1e><div class="aside-content" data-v-c5936a1e><div class="VPDocAside" data-v-c5936a1e data-v-cdc66372><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-cdc66372 data-v-0627715d><div class="content" data-v-0627715d><div class="outline-marker" data-v-0627715d></div><div class="outline-title" data-v-0627715d>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-0627715d><span class="visually-hidden" id="doc-outline-aria-label" data-v-0627715d> Table of Contents for current page </span><ul class="root" data-v-0627715d data-v-1188541a><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-cdc66372></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-c5936a1e><div class="content-container" data-v-c5936a1e><!--[--><!--]--><main class="main" data-v-c5936a1e><div style="position:relative;" class="vp-doc _vitepress-SQL-zero_guide_chapter_4" data-v-c5936a1e><div><h1 id="第-4-章-更新資料" tabindex="-1">第 4 章 更新資料 <a class="header-anchor" href="#第-4-章-更新資料" aria-hidden="true">#</a></h1><h2 id="_4-1-新增資料-insert" tabindex="-1">4-1 新增資料 (INSERT) <a class="header-anchor" href="#_4-1-新增資料-insert" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>想在資料表中新增資料 (紀錄) 需要使用 <code>INSERT</code> 敘述，原則上，每執行 1 次 <code>INSERT</code> 敘述可新增 1 筆紀錄。</li><li>將多個欄位名稱或內容值以逗號隔開、前後加上括號圍起來，這樣的形式稱為「 <code>串列 (List)</code> 」。</li><li>對資料表所有欄位執行 <code>INSERT</code> 的時候，資料表名稱後方的欄位串列可以省略。</li><li>若想存入 <code>NULL</code>，可在 <code>VALUES 子句</code> 的內容值串列中直接寫入 <code>NULL</code>。</li><li>資料表的欄位可以設定預設值 (初始值)，而想設定預設值時，需要在 <code>CREATE TABLE 敘述</code> 中，對欄位加上 <code>DEFAULT</code> 條件約束。</li><li>想存入預設值成為內容值時，可以採用在 <code>INSERT 敘述</code> 的 <code>VALUES 子句</code> 中，寫入 <code>DEFAULT</code> 關鍵字 (明示方法)、或省略欄位名稱和內容值串列 (默認方法) 等 2 種方式。</li><li>從其他資料表複製資料時，可使用 <code>INSERT...SELECT 敘述</code>。</li></ul></div><h3 id="什麼是-insert" tabindex="-1">什麼是 INSERT <a class="header-anchor" href="#什麼是-insert" aria-hidden="true">#</a></h3><p>用來存入資料的 SQL 便是 <code>INSERT</code> (插入) 敘述，作用是將紀錄插入資料表中。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-1</p><p>建立 ShohinIns 資料表的 <code>CREATE TABLE</code> 敘述</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ShohinIns</span></span>
<span class="line"><span style="color:#A6ACCD;">(shohin_id     </span><span style="color:#C792EA;">CHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">)      </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  shohin_name   </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  shohin_catalg </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">32</span><span style="color:#A6ACCD;">)  </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  sell_price    </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  buying_price  </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">      ,</span></span>
<span class="line"><span style="color:#A6ACCD;">  reg_date      </span><span style="color:#C792EA;">DATE</span><span style="color:#A6ACCD;">         ,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (shohin_id));</span></span>
<span class="line"></span></code></pre></div></div><h3 id="insert-敘述的基本語法" tabindex="-1">INSERT 敘述的基本語法 <a class="header-anchor" href="#insert-敘述的基本語法" aria-hidden="true">#</a></h3><div class="warning custom-block"><p class="custom-block-title">語法 4-1</p><p>INSERT 敘述</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">資料表名稱</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱1</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱2</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">, ...)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (內容值1, 內容值2, ...)</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">範例 4-2</p><p>在資料表中新增 1 筆紀錄資料</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns (shohin_id, shohin_name, shohin_catalg, sell_price, buying_price, reg_date)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">T恤</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></div><p>將多個欄位名稱或內容值以逗號隔開，前後加上括號圍起來，這樣的形式就稱為 <code>串列 (List)</code>。</p><ul><li>A. <code>欄位串列</code>： <code>(shohin_id, shohin_name, shohin_catalg, sell_price, buying_price, reg_date)</code></li><li>B. <code>內容值串列</code>： <code>(&#39;0001&#39;, &#39;T恤&#39;, &#39;衣物&#39;, 1000, 500, &#39;2009-09-20&#39;)</code></li></ul><p>資料表後方的 <code>欄位串列</code>、和 <code>VALUES子句</code> 後方的 <code>內容串列</code>，其中列出的項目數量必須一致。</p><div class="danger custom-block"><p class="custom-block-title">DANGER</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- VALUES 子句的內容值串列少了 1 個欄位！</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns (shohin_id, shohin_name, shohin_catalg, sell_price, buying_price, reg_date)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">T恤</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></div><p>每執行 1 次 <code>INSERT 敘述</code>，基本上只會新增 1 筆紀錄，想要新增多筆紀錄的時候，原則上必須按照紀錄筆數多次執行 <code>INSERT 敘述</code>。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 7-2</p><p>使用集合運算子想列出重複的紀錄時，請加上 <code>ALL 選項</code>。</p></div><blockquote><h3 id="column-insert-多筆紀錄" tabindex="-1">COLUMN - INSERT 多筆紀錄 <a class="header-anchor" href="#column-insert-多筆紀錄" aria-hidden="true">#</a></h3></blockquote><p>雖然大部分的情況，「 每執行 1 次 <code>INSERT 敘述</code>，只會新增 1 筆紀錄 」，不過並不是絕對的原則。以實際的狀況來說，很多 <code>DBMS</code> 都能做到 1 次 <code>INSERT</code> 多筆紀錄，而這樣的功能就稱為「 <code>多行 INSERT (multi row INSERT)</code> 」。</p><p>在 <code>VALUES 子句</code> 中，寫入多段以 <code>逗號</code> 區隔開來的內容值串列。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-A</p><p>一般的 INSERT 與 多行 INSERT</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 一般的 INSERT</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">打孔機</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">320</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-11</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">襯衫</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">4000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0004</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">菜刀</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 多行的 INSERT (Oracle 除外)</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns </span><span style="color:#F78C6C;">VALUES</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">打孔機</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">320</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-11</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">襯衫</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">4000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">),</span></span>
<span class="line"><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0004</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">菜刀</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div></div><p>不過使用上有些需要注意的事項：</p><ul><li><code>INSERT 敘述</code> 輸入時出錯、甚至導致存入錯誤資料的狀況。當然有時候 <code>DBMS</code> 會擋下錯誤的 <code>SQL 敘述</code>，不過想要找出 <code>多行 INSERT</code> 哪裡有誤，會比一般單筆紀錄的 <code>INSERT 敘述</code> 更加辛苦。</li><li>此語法無法在所有的 <code>DBMS</code> 上正常執行。上述的 <code>多行 INSERT</code> 語法，僅適用於 <code>DB2</code>、<code>SQL Server</code>、<code>PostgreSQL</code>、<code>MySQL</code>和<code>MariaDB</code> 等資料庫，而 <code>Oracle</code> 不接受此語法。</li></ul><div class="warning custom-block"><p class="custom-block-title">專用語法：<code>Oracle</code></p><p><code>Oracle</code> 必須改用下面看起來有點奇怪的語法。</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- Oracle 上的多行 INSERT</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT</span><span style="color:#A6ACCD;"> ALL </span><span style="color:#F78C6C;">INTO</span><span style="color:#A6ACCD;"> ShohinIns </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">打孔機</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">320</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-11</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT</span><span style="color:#A6ACCD;"> ShohinIns </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">襯衫</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">4000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT</span><span style="color:#A6ACCD;"> ShohinIns </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0004</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">菜刀</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> DUAL;</span></span>
<span class="line"></span></code></pre></div><p><code>DUAL</code> 是 <code>Oracle</code> 特有的 1 種 <code>虛擬資料表 (Dummy Table)</code>，安裝後會自動產生，而最後一行 「 <code>SELECT * FROM DUAL</code> 」的部分引用此虛擬資料表，不具實質的意義。</p></div><h3 id="省略欄位串列" tabindex="-1">省略欄位串列 <a class="header-anchor" href="#省略欄位串列" aria-hidden="true">#</a></h3><p>如果是對資料表的所有欄位執行 <code>INSERT</code> 動作，那麼便可省略資料表名稱後方的欄位名稱串列， <code>VALUES 子句</code> 所列舉的各個內容值，會從左邊第 1 個欄位依序存入資料表成為 1 筆紀錄。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-3</p><p>省略欄位串列</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 有欄位串列</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns (shohin_id, shohin_name, shohin_catalg, sell_price, buying_price, reg_date)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0005</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">壓力鍋</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">6800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">5000</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-01-15</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 無欄位串列</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0005</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">壓力鍋</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">6800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">5000</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-01-15</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></div><h3 id="存入-null" tabindex="-1">存入 NULL <a class="header-anchor" href="#存入-null" aria-hidden="true">#</a></h3><p>想要以 <code>SELECT 敘述</code> 讓 1 筆紀錄的某個欄位為 <code>NULL</code> 的時候，可以在 <code>VALUES 子句</code> 內容值串列的相對位置直接寫入「 <code>NULL</code> 」。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-4</p><p>在 <code>buying_price</code> 欄位存入 NULL</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 有欄位串列</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns (shohin_id, shohin_name, shohin_catalg, sell_price, buying_price, reg_date)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0006</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">叉子</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></div><p>請注意，能存入 <code>NULL</code> 的欄位，當然僅限於沒有加上 <code>NOT NULL</code> 條件約束的欄位，如果對加上 <code>NOT NULL</code> 條件約束的欄位存入 <code>NULL</code>，<code>INSERT 敘述</code> 將會發生錯誤，造成插入資料的動作失敗。</p><p>不只是 <code>INSERT</code>，還有 <code>DELETE</code> 和 <code>UPDATE</code> 等更新資料用的 <code>SQL 敘述</code>，執行失敗的時候都不會對資料表中既有的資料造成任何影響。</p><h3 id="存入預設值" tabindex="-1">存入預設值 <a class="header-anchor" href="#存入預設值" aria-hidden="true">#</a></h3><p>資料表的欄位可以設定 <code>預設值 (初始值)</code>，若想對欄位設定 預設值，需要在建立資料表的 <code>CREATE TABLE 敘述</code> 中，對該欄位加上 <code>DEFAULT 條件</code> 約束。</p><p>使用「 <code>DEFAULT &lt;預設值&gt;</code> 」的形式，即可指定欄位的預設值。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-5</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ShohinIns</span></span>
<span class="line"><span style="color:#A6ACCD;">(shohin_id     </span><span style="color:#C792EA;">CHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">)      </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  (略)</span></span>
<span class="line"><span style="color:#A6ACCD;">  sell_price    </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">0</span><span style="color:#A6ACCD;">, </span><span style="color:#676E95;font-style:italic;">-- 設定販售單價的預設值為 0</span></span>
<span class="line"><span style="color:#A6ACCD;">  (略)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (shohin_id));</span></span>
<span class="line"></span></code></pre></div></div><p>之後以 <code>INSERT 敘述</code> 新增紀錄的時候，就能引用預設值作為欄位的內容值，而引用的做法可分為「 <code>明示方法</code> 」和「 <code>默認方法</code> 」等 2 種方式。</p><ul><li><h4 id="以-明示方法-存入預設值" tabindex="-1">以 <code>明示方法</code> 存入預設值 <a class="header-anchor" href="#以-明示方法-存入預設值" aria-hidden="true">#</a></h4><p>此方法需要在 <code>VALUES 子句</code> 中寫入 <code>DEFAULT 關鍵字</code>。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-6</p><p>以 <code>明示方法</code> 存入預設值</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns (shohin_id, shohin_name, shohin_catalg, sell_price, buying_price, reg_date)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">刨絲器</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#C792EA;">DEFAULT</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">790</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2008-04-28</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>執行上面的敘述，<code>RDBMS</code> 便會自動使用該欄位的預設值取代 <code>DEFAULT</code> 的部分，在資料表中新增 1 筆紀錄。</p></div></li><li><h4 id="以-默認方法-存入預設值" tabindex="-1">以 <code>默認方法</code> 存入預設值 <a class="header-anchor" href="#以-默認方法-存入預設值" aria-hidden="true">#</a></h4><p>其實不使用 <code>DEFAULT</code> 關鍵字也能對欄位存入預設值。如果想讓欄位存入預設值，只要從 <code>欄位串列</code> 和 <code>內容值串列</code> 中，省略該欄位名稱和內容值的部分即可。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-7</p><p>以 <code>默認方法</code> 存入預設值</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns (shohin_id, shohin_name, shohin_catalg, buying_price, reg_date)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">刨絲器</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">790</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2008-04-28</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div><p>此種方式同樣會在 <code>sell_price</code> 欄位中存入預設值 0。</p></div><p>推薦使用「 <code>明示方法</code> 」，因為這樣可以讓人一眼就能看出 <code>sell_price</code> 欄位被指定存入預設值，成為比較容易閱讀的 <code>SQL 敘述</code>。</p><p>另外，對於省略欄位名稱的方式，如果被省略掉的欄位沒有設定預設值，那麼執行後將會存入 <code>NULL</code>，若是這個欄位還具有 <code>NOT NULL</code> 的條件約束，將會導致 <code>INSERT 敘述</code> 發生錯誤。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-8</p><p>沒有設定預設值的狀況</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 省略無條件約束的 `buying_price` 欄位：存入「 NULL 」</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns (shohin_id, shohin_name, shohin_catalg, sell_price, reg_date)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0008</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">鋼珠筆</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-11-11</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></div><div class="danger custom-block"><p class="custom-block-title">範例 4-8</p><p>沒有設定預設值的狀況</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 省略有 `NOT NULL` 條件約束的 `shohin_name` 欄位：將發生錯誤！</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinIns (shohin_id, shohin_catalg, sell_price, buying_price, reg_date)</span></span>
<span class="line"><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0009</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-12-12</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"></span></code></pre></div></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 4-2</p><p>省略 <code>INSERT 敘述</code> 中的欄位名稱，將會對該欄位存入預設值，如果沒有設定預設值則改存入 <code>NULL</code>。</p></div></li></ul><h3 id="從其他資料表複製資料" tabindex="-1">從其他資料表複製資料 <a class="header-anchor" href="#從其他資料表複製資料" aria-hidden="true">#</a></h3><p>想要在資料表中新增紀錄，除了以 <code>VALUES 子句</code> 具體指定存入的資料之外，還有「 <code>從其他資料表篩選資料存入</code> 」的方式。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-9</p><p>建立 ShohinCopy 資料表的 <code>CREATE TABLE</code> 敘述</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ShohinCopy</span></span>
<span class="line"><span style="color:#A6ACCD;">(shohin_id     </span><span style="color:#C792EA;">CHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">)      </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  shohin_name   </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  shohin_catalg </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">32</span><span style="color:#A6ACCD;">)  </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  sell_price    </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">      ,</span></span>
<span class="line"><span style="color:#A6ACCD;">  buying_price  </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">      ,</span></span>
<span class="line"><span style="color:#A6ACCD;">  reg_date      </span><span style="color:#C792EA;">DATE</span><span style="color:#A6ACCD;">         ,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (shohin_id));</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">範例 4-10</p><p><code>INSERT...SELECT 敘述</code></p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 將商品資料表的資料「 複製 」至 ShohinCopy 資料表</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinCopy (shohin_id, shohin_name, shohin_catalg, sell_price, buying_price, reg_date)</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name, shohin_catalg, sell_price, buying_price, reg_date</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin;</span></span>
<span class="line"></span></code></pre></div><p>假如作為資料來源的 <code>Shohin</code> 資料表當中儲存著 8 筆紀錄，此 <code>INSERT...SELECT 敘述</code> 執行之後， <code>ShohinCopy</code> 資料表中便會新增完全相同的 8 筆紀錄，而且 <code>Shohin</code> 資料表中的資料不會有任何變化。所以也適合用於資料的備份工作。</p></div><h4 id="select-敘述部分的變化用法" tabindex="-1">SELECT 敘述部分的變化用法 <a class="header-anchor" href="#select-敘述部分的變化用法" aria-hidden="true">#</a></h4><p>此 <code>INSERT 敘述</code> 內的 <code>SELECT 敘述</code> 部分，可以加上 <code>WHERE 子句</code> 或 <code>GROUP BY 子句</code> 等子句，但是加上 <code>ORDER BY 子句</code> 將不具有任何意義，因為資料表內部的各筆紀錄並沒有一定的順序。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-11</p><p>建立 ShohinCatalg 資料表的 <code>CREATE TABLE</code> 敘述</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 存放個商品分類價格總計的資料表</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ShohinCatalg</span></span>
<span class="line"><span style="color:#A6ACCD;">(shohin_catalg </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">32</span><span style="color:#A6ACCD;">)  </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">  sum_sell_price    </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">      ,</span></span>
<span class="line"><span style="color:#A6ACCD;">  sum_buying_price  </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">      ,</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (shohin_catalg));</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">範例 4-12</p><p>彙總其他資料表的資料再行新增的 <code>INSERT...SELECT 敘述</code></p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinCatalg (shohin_catalg, sum_sell_price, sum_buying_price)</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_catalg, </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(sell_price), </span><span style="color:#82AAFF;">SUM</span><span style="color:#A6ACCD;">(buying_price)</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">GROUP BY</span><span style="color:#A6ACCD;"> shohin_catalg;</span></span>
<span class="line"></span></code></pre></div></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 4-3</p><p><code>INSERT...SELECT 敘述</code> 內的 <code>SELECT 敘述</code> 部分，可以使用 <code>WHERE 子句</code> 和 <code>GROUP BY 子句</code> 等語法，不過 <code>ORDER BY 子句</code> 無法發揮作用。</p></div><h2 id="_4-2-刪除資料-delete" tabindex="-1">4-2 刪除資料 (DELETE) <a class="header-anchor" href="#_4-2-刪除資料-delete" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>將整個資料表完全刪除需要使用 <code>DROP TABLE 敘述</code>，而想留下資料表本身結構、僅刪除所有紀錄時，則應該使用 <code>DELETE 敘述</code>。</li><li>想刪除部分的紀錄時，可使用 <code>WHERE 子句</code> 指定刪除對象的條件。而加上 <code>WHERE 子句</code> 限制刪除對象紀錄的 <code>DELETE 敘述</code> 稱為「 <code>搜尋式 DELETE</code> 」。</li></ul></div><h3 id="drop-table-敘述與-delete-敘述" tabindex="-1">DROP TABLE 敘述與 DELETE 敘述 <a class="header-anchor" href="#drop-table-敘述與-delete-敘述" aria-hidden="true">#</a></h3><p>刪除資料的方法大致上可分為 2 類。</p><ol><li>透過 <code>DROP TABLE 敘述</code> 將整個資料表刪除。</li><li>透過 <code>DELETE 敘述</code>，保留資料表這個儲存用的容器、結構，僅刪除其中的所有資料紀錄。</li></ol><p>由於 <code>DROP TABLE 敘述</code> 會將整個資料表完全刪除，之後若想再將資料新增至相同的資料表，必須以 <code>CREATE TABLE</code> 重新建立此資料表。</p><p><code>DELETE 敘述</code> 只能刪除資料表中的資料(紀錄)，不會影響到資料表本身的結構，所以之後只要使用 <code>INSERT 敘述</code> 便能再度新增資料。</p><h3 id="delete-敘述的基本語法" tabindex="-1">DELETE 敘述的基本語法 <a class="header-anchor" href="#delete-敘述的基本語法" aria-hidden="true">#</a></h3><div class="warning custom-block"><p class="custom-block-title">語法 4-2</p><p>保留資料表，刪除所有紀錄的 DELETE 敘述</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">DELETE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">資料表名稱</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">範例 4-13</p><p>清空 Shohin 資料表</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">DELETE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin;</span></span>
<span class="line"></span></code></pre></div></div><ol><li>若不小心漏掉 <code>FROM</code> 而寫成「 <code>DELETE &lt;資料表名稱&gt;</code> 」、</li><li>或加上多餘的欄位名稱而變成「 <code>DELETE &lt;欄位名稱&gt; FROM &lt;資料表名稱&gt;</code> 」等， 都是常見的錯誤寫法，這些都只會獲得錯誤訊息，無法正常執行，撰寫時請多注意。</li></ol><p>第 1 種錯誤寫法之所以無法順利執行，是因為 <code>DELETE 敘述</code> 所刪除的對象並非資料表，而是資料表中包含的「 <code>紀錄</code> 」。</p><p>第 2 種錯誤寫法也是基於完全相同的理由，由於刪除的對象並非欄位，而是「 <code>紀錄</code> 」，所以無法以 <code>DELETE 敘述</code> 刪除掉某些欄位。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 4-4</p><p><code>DELETE 敘述</code> 的刪除對象並非資料表和欄位，而是「 <code>紀錄</code> 」。</p></div><h3 id="刪除特定紀錄的-delete-敘述-搜尋式-delete" tabindex="-1">刪除特定紀錄的 DELETE 敘述 (搜尋式 DELETE) <a class="header-anchor" href="#刪除特定紀錄的-delete-敘述-搜尋式-delete" aria-hidden="true">#</a></h3><p>如果不想 1 次刪除資料表中的所有資料，只刪除特定的紀錄，和 <code>SELECT 敘述</code> 的作法相同，可以加上 <code>WHERE 子句</code> 並在其中寫入條件，像這樣能限制刪除對象紀錄的 <code>DELETE 敘述</code>，就稱為「 <code>搜尋式DELETE</code> 」。</p><div class="warning custom-block"><p class="custom-block-title">語法 4-3</p><p>僅刪除特定紀錄</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">DELETE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">資料表名稱</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">條件</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">範例 4-14</p><p>只刪除販售單價大於或等於 4000 元的紀錄</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">DELETE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">&gt;=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">4000</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 4-5</p><p>刪除特定紀錄的時候，需要以 <code>WHERE 子句</code> 撰寫刪除對象紀錄的條件。</p></div><p>此外，<code>DELETE 敘述</code> 和 <code>SELECT 敘述</code> 不同，不能加上 <code>GROUP BY</code>、<code>HAVING</code>、<code>ORDER BY</code> 等 3 個子句，能使用的僅有 <code>WHERE 子句</code>。</p><blockquote><h3 id="column-刪除與捨棄" tabindex="-1">COLUMN - 刪除與捨棄 <a class="header-anchor" href="#column-刪除與捨棄" aria-hidden="true">#</a></h3><p>做為從資料表刪除資料的實作方法，標準 <code>SQL</code> 只有提供了 <code>DELETE 敘述</code>，不過在眾多的各家資料庫之中，很多都有提供另外 1 個名為「 <code>TRUNCATE</code> 」的指令，以主流的資料庫來說，<code>Oracle</code>、<code>SQL Server</code>、<code>PostgreSQL</code>、<code>MySQL (MariaDB)</code> 和 <code>DB2</code> 等資料庫都具有此指令。</p></blockquote><blockquote><p><code>TRUNCATE</code> 這個單字具有「 <code>捨棄</code> 」意思，其具體的使用方式如下：</p><div class="warning custom-block"><p class="custom-block-title">語法 4-A</p><p>直接刪除資料表中所有紀錄</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">TRUNCATE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">資料表名稱</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div></blockquote><blockquote><p>和 <code>DELETE 敘述</code> 不同，<code>TRUNCATE 敘述</code> 會直接刪除資料表中的所有紀錄，不能以 <code>WHERE 子句</code> 指定條件，僅刪除特定的紀錄，因此無法精細控制刪除的對象，不過相對地，比起 <code>DELETE 敘述</code> 的處理速度，<code>TRUNCATE 敘述</code> 具有更加快速的優點。實際上，由於<code>DELETE 敘述</code> 在 <code>DML 敘述</code> 中算是需要花費許多時間的指令，如果不必保留任何紀錄，改用 <code>TRUNCATE</code> 可以縮短執行的時間。</p></blockquote><blockquote><p>不過，例如 <code>Oracle</code> 將 <code>TRUNCATE</code> 定義為 <code>DDL</code> 而不是 <code>DML</code> 的狀況，各家資料庫之間的些許差異是必須留意的地方。使用 <code>TRUNCATE</code> 的時候，必須先詳加閱讀廠商所提供的說明手冊，再謹慎運用，因為越是方便的工具通常也有相對的缺點。</p></blockquote><blockquote><blockquote><p><code>Oracle</code> 的 <code>ROLLBACK</code> 對 <code>TRUNCATE</code> 無效，<code>TRUNCATE</code> 在執行上都預設採用 <code>COMMIT</code> 的方式。</p></blockquote></blockquote><h2 id="_4-3-修改資料-update" tabindex="-1">4-3 修改資料 (UPDATE) <a class="header-anchor" href="#_4-3-修改資料-update" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>修改資料表中的資料時，需要使用 <code>UPDATE 敘述</code>。</li><li>若想修改特定的紀錄，可以使用 <code>WHERE 子句</code> 指定修改對象的條件，而已 <code>WHERE 子句</code> 限制修改對象的 <code>UPDATE 敘述</code> 稱為「 <code>搜尋式 UPDATE</code> 」。</li><li><code>UPDATE 敘述</code> 能將欄位的的值清空為 <code>NULL</code>。</li><li>同時更新多個欄位的時候，可在 <code>UPDATE 敘述</code> 的 <code>SET 子句</code> 中，列出多個欄位並以逗號隔開。</li></ul></div><h3 id="update-的基本語法" tabindex="-1">UPDATE 的基本語法 <a class="header-anchor" href="#update-的基本語法" aria-hidden="true">#</a></h3><p>以 <code>INSERT 敘述</code> 新增資料之後，未來有可能需要修改這些已經儲存在資料表中的資料，只要改用 <code>UPDATE 敘述</code>，便能修正先前錯誤輸入的資料。</p><p><code>UPDATE 敘述</code> 和 <code>INSERT 敘述</code> 以及 <code>DELETE 敘述</code> 同樣屬於 <code>DML敘述</code>，利用此敘述即能修改資料表中的資料。</p><div class="warning custom-block"><p class="custom-block-title">語法 4-4</p><p>修改資料表中資料的 UPDATE 敘述</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">資料表名稱</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">新值或算式</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><p>被修改的欄位以及更新後的內容值應當寫在 <code>SET 子句</code> 的部分。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-15</p><p>將全部的登錄日期改為「 2009年10月10日 」</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> reg_date </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-10-10</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"></span></code></pre></div></div><h3 id="指定條件的-update-敘述-搜尋式-update" tabindex="-1">指定條件的 UPDATE 敘述 (搜尋式 UPDATE) <a class="header-anchor" href="#指定條件的-update-敘述-搜尋式-update" aria-hidden="true">#</a></h3><p>想針對特定紀錄修改資料的時候，和 <code>DELETE 敘述</code> 相同，只要使用 <code>WHERE 子句</code> 即可做到，像這樣能限制修改範圍的 <code>UPDATE 敘述</code> 亦稱為「 <code>搜尋式 UPDATE</code> 」。</p><div class="warning custom-block"><p class="custom-block-title">語法 4-5</p><p>僅修改特定紀錄的 <code>搜尋式 UPDATE</code></p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">資料表名稱</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">欄位名稱</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">新值或算式</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">條件</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">範例 4-16</p><p>針對商品分類為「 廚房用品 」的紀錄，將販售單價改為 10 倍</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><h3 id="將資料改為-null" tabindex="-1">將資料改為 NULL <a class="header-anchor" href="#將資料改為-null" aria-hidden="true">#</a></h3><p>使用 <code>UPDATE 敘述</code> 也能將欄位的內容值改為 <code>NULL</code> (這樣的更新資料方式一般稱為「 <code>NULL 清空</code> 」)，而想將欄位改為 <code>NULL</code> 的時候，只要在 <code>SET 子句</code> 的等號右側直接寫上 <code>NULL</code> 即可。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-17</p><p>將商品 ID 為「 0008 」的鋼珠筆的登錄日期改為 NULL</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> reg_date </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">NULL</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_id </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0008</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><p>這樣的用法和之前的 <code>INSERT 敘述</code> 相同，在 <code>UPDATE 敘述</code> 中也能把 <code>NULL</code> 當成 1 個內容值來使用。</p><p>不過，將欄位內容值改為 <code>NULL</code> 的操作，僅適用於沒有加上 <code>NOT NULL</code> 或 主鍵條件約束的欄位，如果試圖把帶有這些條件約束的欄位改為 <code>NULL</code>，將會出現錯誤訊息，而先前的 <code>INSERT 敘述</code> 在此點上也是相同的。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 4-6</p><p><code>UPDATE 敘述</code> 亦能將欄位內容值改為 <code>NULL</code>，不過僅限於沒有 <code>NOT NULL</code> 條件約束的欄位。</p></div><h3 id="修改多個欄位的資料" tabindex="-1">修改多個欄位的資料 <a class="header-anchor" href="#修改多個欄位的資料" aria-hidden="true">#</a></h3><p><code>UPDATE 敘述</code> 的 <code>SET 子句</code> 部分，其實可以寫成同時修改多個欄位的形式。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-18</p><p>能正確執行卻有些冗長的 <code>UPDATE 敘述</code></p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 1 段 UPDATE 敘述僅修改 1 個欄位</span></span>
<span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> buying_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> buying_price </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><p>實際上，上面的處理動作可以彙整成單一的 <code>UPDATE 敘述</code>。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-19</p><ul><li>適用於所有的 <code>DBMS</code></li></ul><p>將範例 4-18 的處理彙整成單一 <code>UPDATE 敘述</code> 的方式 ①</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 將各欄位的部分以逗號隔開</span></span>
<span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    buying_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> buying_price </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><div class="warning custom-block"><p class="custom-block-title">範例 4-20</p><ul><li>專用語法：<code>PostgreSQL</code>、<code>DB2</code></li></ul><p>將範例 4-18 的處理彙整成單一 <code>UPDATE 敘述</code> 的方式 ②</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 使用串列的形式將欄位和值分別以括號 () 圍起來</span></span>
<span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> (sell_price, buying_price) </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> (sell_price </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">10</span><span style="color:#A6ACCD;">, buying_price </span><span style="color:#89DDFF;">/</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">2</span><span style="color:#A6ACCD;">)</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_catalg </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><p>此 2 種形式的 <code>UPDATE 敘述</code> 執行之後，都會獲得相同的結果。</p><p>而且 <code>SET 子句</code> 中不僅可以列出 2 個欄位，同時能對更多的欄位修改資料。</p><h2 id="_4-4-交易功能" tabindex="-1">4-4 交易功能 <a class="header-anchor" href="#_4-4-交易功能" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>1 筆交易包含了 1 個以上的資料更新動作，而且這些更新動作應該一併執行完畢。藉由交易功能，對於多個資料更新的動作，就能進行確認或取消等管控工作。</li><li>交易的所有處理動作結束時，需要使用 <code>COMMIT (確認處理動作)</code> 或 <code>ROLLBACK (取消處理動作)</code> 等 2 個指令。</li><li><code>DBMS</code> 的交易必須遵守 <code>不可分割性 (Atomicity)</code>、<code>一致性 (Consistency)</code>、<code>隔離性 (Isolation)</code> 以及 <code>持續性 (Durability)</code> 等 4 項原則，取這些單字的第 1 個字母亦稱為 ACID 特性。</li></ul></div><h3 id="什麼是交易功能" tabindex="-1">什麼是交易功能 <a class="header-anchor" href="#什麼是交易功能" aria-hidden="true">#</a></h3><p>交易 (Transaction) 這個詞彙，在 <code>RDBMS</code> 的世界中，它代表了「 對資料表中資料，執行更新動作的基本單位 」，交易是「 <code>對資料庫執行 1 個以上的更新動作時，這些更新動作的代稱</code> 」。</p><p>更新資料表中的資料時，需要使用 <code>INSERT</code>、<code>DELETE</code> 以及 <code>UPDATE</code> 等敘述來完成，不過實務上更新資料的時候，一般無法單靠 1 段敘述就達成目的，經常必須組合多段敘述並連續執行，而交易功能可以將這些操作整合成比較容易理解和使用的形式。</p><p>「 需要一併執行完畢的多個更新動作 」，應當整合成單一的「 交易 」來運用。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 4-7</p><p>1 筆交易包含了 1 個以上的更新動作，而且應該一併執行完畢。</p></div><h3 id="如何設定交易功能" tabindex="-1">如何設定交易功能 <a class="header-anchor" href="#如何設定交易功能" aria-hidden="true">#</a></h3><div class="warning custom-block"><p class="custom-block-title">語法 4-6</p><p>交易的語法</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">交易起始敘述;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">  DML 敘述①</span></span>
<span class="line"><span style="color:#A6ACCD;">  DML 敘述②</span></span>
<span class="line"><span style="color:#A6ACCD;">  DML 敘述③</span></span>
<span class="line"><span style="color:#A6ACCD;">  ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">交易結束敘述 (</span><span style="color:#F78C6C;">COMMIT</span><span style="color:#A6ACCD;"> 或 </span><span style="color:#F78C6C;">ROLLBACK</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div></div><p>以「 交易起始敘述 」和「 交易結束敘述 」圍住用來更新資料的 <code>DML 敘述</code> (<code>INSERT</code>/<code>UPDATE</code>/<code>DELETE</code> 敘述)，此即為交易的形式。</p><p>實際上在 標準 SQL 的規範中，並沒有明確定義交易起始敘述的格式，因此各家 <code>DBMS</code> 分別採用了不同的專用語法。</p><ul><li><p><code>SQL SERVER</code>、<code>PostgreSQL</code></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">BEGIN</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TRANSACTION</span></span>
<span class="line"></span></code></pre></div></li><li><p><code>MySQL</code>、<code>MariaDB</code></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">START TRANSACTION</span></span>
<span class="line"></span></code></pre></div></li><li><p><code>Oracle</code>、<code>DB2</code></p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">無</span></span>
<span class="line"></span></code></pre></div></li></ul><p>結束敘述僅有 <code>COMMIT</code> 和 <code>ROLLBACK</code> 兩種寫法。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-21</p><ul><li>專用語法：<code>SQL Server</code>、<code>PostgreSQL</code></li></ul><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">BEGIN</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TRANSACTION</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">-- 將襯衫的販售單價降低 1000 元</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">襯衫</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">-- 將T恤的販售單價調高 1000 元</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">T恤</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">COMMIT</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>MySQL</code>、<code>MariaDB</code></li></ul><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">START TRANSACTION</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">-- 將襯衫的販售單價降低 1000 元</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">襯衫</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">-- 將T恤的販售單價調高 1000 元</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">T恤</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">COMMIT</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><ul><li>專用語法：<code>Oracle</code>、<code>DB2</code></li></ul><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 將襯衫的販售單價降低 1000 元</span></span>
<span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">襯衫</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 將T恤的販售單價調高 1000 元</span></span>
<span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">T恤</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">COMMIT</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><p>交易的結束點必須由使用者以明確的方式來指定，而結束交易需要使用下列 2 個 指令：</p><ul><li><h4 id="commit-確認處理動作" tabindex="-1"><code>COMMIT</code> - 確認處理動作 <a class="header-anchor" href="#commit-確認處理動作" aria-hidden="true">#</a></h4><p>這個交易結束指令，會實際套用交易中所有處理動作產生的資料變動。</p><p>執行了 <code>COMMIT</code> 之後，因為無法再度回到交易開始前的狀態，所以執行前請再次自行確認是否真的可以變更資料。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 4-8</p><p>不清楚交易何時開始也沒有關係，但是結束時必須再三確認，以免事後懊悔不已。</p></div></li><li><h4 id="rollback-取消處理動作" tabindex="-1"><code>ROLLBACK</code> - 取消處理動作 <a class="header-anchor" href="#rollback-取消處理動作" aria-hidden="true">#</a></h4><p><code>ROLLBACK</code> 這個交易結束指令，會捨棄交易中所有處理動作產生的資料變動。</p><p>執行了 <code>ROLLBACK</code> 之後，資料庫會回復到交易開始前的狀態。</p><div class="warning custom-block"><p class="custom-block-title">範例 4-22</p><p>ROLLBACK 交易的實例</p><ul><li>專用語法：<code>SQL Server</code>、<code>PostgreSQL</code></li></ul><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">BEGIN</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TRANSACTION</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">-- 將襯衫的販售單價降低 1000 元</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">襯衫</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">-- 將T恤的販售單價調高 1000 元</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> Shohin</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">T恤</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">ROLLBACK</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div><p>不同的 <code>DBMS</code> 的交易功能語法也會有些差異，如果想在 <code>MariaDB</code> 上執行，請改為 「 START TRANSACTION; 」，另外，在 <code>Oracle</code> 和 <code>DB2</code> 上執行時，不需要 <code>TRANSACTION</code> 的部分。</p></div></li></ul><blockquote><h3 id="column-交易功能的起始點" tabindex="-1">COLUMN - 交易功能的起始點 <a class="header-anchor" href="#column-交易功能的起始點" aria-hidden="true">#</a></h3><p>交易起始的標準指令並不存在，因此各家 <code>DBMS</code> 分別採用了不同的指令。</p><p>在大部分的狀況之下，當連上資料庫的時候，其實就已經是默認啟動交易的狀態，因此使用者不必特別明確下達指令來啟動交易。</p><p>像這樣不需要指令便默認啟動交易功能的資料庫，應該如何區隔各筆交易呢？</p><p>有下列 2 種方式可供選擇：</p><ul><li>Ⓐ 採用 「 1 段 SQL 敘述即是 1 筆交易 」的規則 (<code>自動確認模式</code>)。</li><li>Ⓑ 到使用者執行 <code>COMMIT</code> 或 <code>ROLLBACK</code> 為止，視為 1 筆交易。</li></ul><p>在一般的 <code>DBMS</code> 上，通常可以自行選擇其中 1 種模式。而 <code>預設</code> 為自動確認模式的 <code>DBMS</code> 有 <code>SQL Server</code>、<code>PostgreSQL</code>、<code>MySQL</code> 和 <code>MariaDB</code> 等資料庫。</p><p>另一方面，以預設為 Ⓑ 模式的 <code>Oracle</code> 來說，在使用者自行發送 <code>COMMIT</code> 或 <code>ROLLBACK</code> 之前，此筆交易都不會結束。</p></blockquote><h3 id="acid-特性" tabindex="-1">ACID 特性 <a class="header-anchor" href="#acid-特性" aria-hidden="true">#</a></h3><p>關於 <code>DBMS</code> 的交易功能，在標準規範中訂定有應當遵守的 4 大原則，取各個單字的第 1 個字母稱之為「 <code>ACID 特性</code> 」，這些原則是所有 <code>DBMS</code> 都必須遵守的通用原則。</p><ul><li><h4 id="不可分割性-atomicity" tabindex="-1">不可分割性 (Atomicity) <a class="header-anchor" href="#不可分割性-atomicity" aria-hidden="true">#</a></h4><p>當 1 筆交易結束的時候，對於當中所包含的更新處理動作，確保結束時的狀態為全部執行完畢、或全部取消執行的特性，也稱為「 <code>All or Nothing</code> 」。</p></li><li><h4 id="一致性-consistency" tabindex="-1">一致性 (Consistency) <a class="header-anchor" href="#一致性-consistency" aria-hidden="true">#</a></h4><p>交易中所包含的處理動作，都需要滿足資料庫預先設定的條件約束，例如 <code>主鍵</code> 或 <code>NOT NULL</code> 等條件約束。</p></li><li><h4 id="隔離性-isolation" tabindex="-1">隔離性 (Isolation) <a class="header-anchor" href="#隔離性-isolation" aria-hidden="true">#</a></h4><p>確保各筆交易之間不會相互受到干涉影響的性質。交易之間不會相互包容行成巢狀結構，另外，某筆交易結束之前，其他交易無法得知此筆交易所造成的變動。</p></li><li><h4 id="持續性-durability" tabindex="-1">持續性 (Durability) <a class="header-anchor" href="#持續性-durability" aria-hidden="true">#</a></h4><p>亦稱為持久性，當交易在 <code>COMMIT</code> 或 <code>ROLLBACK</code> 結束之後，確保資料內容會維持在該時間點狀態的性質，即使未來系統發生故障而遺失資料，資料庫也不會回復到交易更新前的內容。</p><p>確保此持續性的方法在實務上各有差異，不過其中最受到歡迎的做法，便是將交易的執行紀錄先儲存至硬碟等裝置之中，而這樣的執行紀錄稱為「 <code>日誌(Log)</code> 」，當發生系統故障的時候，便可以利用日誌內容回復到故障前 (交易完成後) 的狀態。</p></li></ul><h2 id="自我練習" tabindex="-1">自我練習 <a class="header-anchor" href="#自我練習" aria-hidden="true">#</a></h2><ul><li><p>4.1 A 先生從自己的電腦連上資料庫，針對剛以 <code>CREATE TABLE 敘述</code> 建立完成、尚未存入任何資料的 <code>Shohin (商品) 資料表</code>，執行以下 <code>SQL 敘述</code> 新增資料。</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">START TRANSACTION</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">T恤</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">打孔機</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">320</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-11</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">襯衫</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">4000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div><p>之類，剛好 B 先生也立即操作自己的電腦連上同一資料庫，執行了下面的 <code>SELECT 敘述</code>，這個時候 B 先生會獲得什麼樣的結果呢？</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin;</span></span>
<span class="line"></span></code></pre></div><details class="details custom-block"><summary>提示</summary><ul><li>可以先使用 <code>DELETE 敘述</code>，將資料表清空成為剛建立完成的狀態，然後模擬 A 與 B 的操作並觀察執行結果</li></ul></details><details class="details custom-block"><summary>練習</summary><p>B 先生會得到空的資料表查詢，因為 A 先生並未執行交易結束的動作，資料表不會做任何變更。</p></details></li><li><p>4.2 假設資料庫中有個內容下列 3 筆紀錄的 <code>Shohin</code> 資料表。</p><table><thead><tr><th>商品ID</th><th>商品名稱</th><th>商品分類</th><th>販售單價</th><th>購入單價</th><th>登錄日期</th></tr></thead><tbody><tr><td>0001</td><td>T恤</td><td>衣物</td><td>1000</td><td>500</td><td>2009-09-20</td></tr><tr><td>0002</td><td>打孔機</td><td>辦公用品</td><td>500</td><td>320</td><td>2009-09-11</td></tr><tr><td>0003</td><td>襯衫</td><td>衣物</td><td>4000</td><td>2800</td><td>NULL</td></tr></tbody></table><p>如果想直接複製這 3 筆紀錄將資料增加為 6 筆，所以執行了以下的 <code>INSERT 敘述</code>，如此一來會得到什麼樣的結果呢？</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> Shohin;</span></span>
<span class="line"></span></code></pre></div><details class="details custom-block"><summary>練習</summary><p>會得到 <code>PRIMARY KEY</code> 重複的錯誤訊息。</p></details></li><li><p>4.3 假設已有問題 <code>4.2</code> 所示的 <code>Shohin</code> 資料表以及當中的資料，這裡需要另外建立 1 個新的資料表，此 <code>ShohinProfit (商品利潤)</code> 資料表的結構如下所示，它具有名為 <code>s_profit (利潤)</code> 的欄位。</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 商品利潤資料表</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">ShohinProfit</span></span>
<span class="line"><span style="color:#A6ACCD;">(shohin_id </span><span style="color:#C792EA;">CHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">shohin_name </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">sell_price </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">buying_price </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">s_profit </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (shohin_id));</span></span>
<span class="line"></span></code></pre></div><p>請撰寫 <code>SQL 敘述</code>，根據 <code>Shohin</code> 資料表求得個商品的利潤，然後將結果存入 <code>ShohinProfit</code> 資料表成為如下所示的狀況，利潤單純以「 販售單價 - 購入單價 」來計算即可。</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th>sell_price</th><th>buying_price</th><th>s_profit</th></tr></thead><tbody><tr><td>0001</td><td>T恤</td><td>1000</td><td>500</td><td>500</td></tr><tr><td>0002</td><td>打孔機</td><td>500</td><td>320</td><td>180</td></tr><tr><td>0003</td><td>襯衫</td><td>4000</td><td>2800</td><td>1200</td></tr></tbody></table><details class="details custom-block"><summary>練習</summary><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> ShohinProfit (shohin_id, shohin_name, sell_price, buying_price, s_profit)</span></span>
<span class="line"><span style="color:#F78C6C;">SELECT</span><span style="color:#A6ACCD;"> shohin_id, shohin_name, sell_price, buying_price, (sell_price </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> buying_price) </span><span style="color:#F78C6C;">AS</span><span style="color:#A6ACCD;"> s_profit</span></span>
<span class="line"><span style="color:#F78C6C;">FROM</span><span style="color:#A6ACCD;"> shohin;</span></span>
<span class="line"></span></code></pre></div></details></li><li><p>4.4 對於問題 <code>4.3</code> 中已經存入資料的 <code>ShohinProfit</code> 資料表，這裡需要完成以下的資料更新動作。</p><ol><li>將襯衫的販售單價從 <code>4000</code> 元降至 <code>3000</code> 元。</li><li>承接上述的結果，重新計算襯衫的利潤。 更新後的 <code>ShohinProfit</code> 資料表如下所示，請寫出能達成此目的的 <code>SQL 敘述</code>。</li></ol><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th>sell_price</th><th>buying_price</th><th>s_profit</th></tr></thead><tbody><tr><td>0001</td><td>T恤</td><td>1000</td><td>500</td><td>500</td></tr><tr><td>0002</td><td>打孔機</td><td>500</td><td>320</td><td>180</td></tr><tr><td>0003</td><td>襯衫</td><td>3000</td><td>2800</td><td>200</td></tr></tbody></table><details class="details custom-block"><summary>練習</summary><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 將襯衫的販售單價降至 3000 元</span></span>
<span class="line"><span style="color:#F78C6C;">UPDATE</span><span style="color:#A6ACCD;"> ShohinProfit</span></span>
<span class="line"><span style="color:#F78C6C;">SET</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">    s_profit </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> sell_price </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;"> buying_price</span></span>
<span class="line"><span style="color:#F78C6C;">WHERE</span><span style="color:#A6ACCD;"> shohin_name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">襯衫</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></details></li></ul></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-c5936a1e data-v-e033cd21><!----><div class="prev-next" data-v-e033cd21><div class="pager" data-v-e033cd21><a class="pager-link prev" href="/vitepress-SQL-zero/guide/chapter_3.html" data-v-e033cd21><span class="desc" data-v-e033cd21>Previous page</span><span class="title" data-v-e033cd21>第 3 章 彙總與排序</span></a></div><div class="has-prev pager" data-v-e033cd21><a class="pager-link next" href="/vitepress-SQL-zero/guide/chapter_5.html" data-v-e033cd21><span class="desc" data-v-e033cd21>Next page</span><span class="title" data-v-e033cd21>第 5 章 進階查詢功能</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-93a960b4 data-v-d24360a6><div class="container" data-v-d24360a6><!----><p class="copyright" data-v-d24360a6>MIT Lincensed | Copyright © 2023-present Eason</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"guide_chapter_0.md\":\"de036069\",\"guide_chapter_1.md\":\"ca727084\",\"guide_chapter_2.md\":\"a4eb522b\",\"guide_chapter_3.md\":\"4a9ef05f\",\"guide_chapter_5.md\":\"3d608a90\",\"guide_chapter_4.md\":\"443483c4\",\"index.md\":\"04c6d6e3\",\"guide_chapter_8.md\":\"6e316234\",\"guide_chapter_9.md\":\"9c9f9594\",\"guide_chapter_7.md\":\"dbd1dc90\",\"guide_chapter_6.md\":\"fdc0f91d\"}")</script>
    <script type="module" async src="/vitepress-SQL-zero/assets/app.12066fee.js"></script>
    
  </body>
</html>