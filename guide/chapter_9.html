<!DOCTYPE html>
<html lang="zh-TW" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>第 9 章 從應用程式連接資料庫 | 從零開始 邁向數據分析 SQL 資料庫語法入門</title>
    <meta name="description" content="閱讀筆記">
    <link rel="preload stylesheet" href="/vitepress-SQL-zero/assets/style.721c165b.css" as="style">
    <link rel="modulepreload" href="/vitepress-SQL-zero/assets/app.12066fee.js">
    <link rel="modulepreload" href="/vitepress-SQL-zero/assets/guide_chapter_9.md.9c9f9594.lean.js">
    
    <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-93a960b4><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-93a960b4 data-v-790c334c><div class="VPNavBar has-sidebar" data-v-790c334c data-v-eda5fd6f><div class="container" data-v-eda5fd6f><div class="title" data-v-eda5fd6f><div class="VPNavBarTitle has-sidebar" data-v-eda5fd6f data-v-6d2fb2d9><a class="title" href="/vitepress-SQL-zero/" data-v-6d2fb2d9><!--[--><!--]--><!--[--><img class="VPImage logo" src="/vitepress-SQL-zero/apple-touch-icon.png" alt data-v-6db2186b><!--]--><!--[-->從零開始 邁向數據分析 SQL 資料庫語法入門<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-eda5fd6f><div class="curtain" data-v-eda5fd6f></div><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-eda5fd6f data-v-bdedfc22><span id="main-nav-aria-label" class="visually-hidden" data-v-bdedfc22>Main Navigation</span><!--[--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-eda5fd6f data-v-da3f667a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-da3f667a data-v-0d529b6d data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-0d529b6d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-0d529b6d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><!----><div class="VPFlyout VPNavBarExtra extra" data-v-eda5fd6f data-v-f38c483a data-v-96001b6b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-96001b6b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-96001b6b><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-96001b6b><div class="VPMenu" data-v-96001b6b data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-f38c483a><div class="item appearance" data-v-f38c483a><p class="label" data-v-f38c483a>Appearance</p><div class="appearance-action" data-v-f38c483a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-f38c483a data-v-0d529b6d data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-0d529b6d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-0d529b6d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><!----><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-eda5fd6f data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div><!----></header><div class="VPLocalNav" data-v-93a960b4 data-v-2817d72e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2817d72e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-2817d72e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-2817d72e>Menu</span></button><a class="top-link" href="#" data-v-2817d72e>Return to top</a></div><aside class="VPSidebar" data-v-93a960b4 data-v-941101de><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-941101de><span class="visually-hidden" id="sidebar-aria-label" data-v-941101de> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-941101de><section class="VPSidebarGroup" data-v-941101de data-v-c88a18d6><div class="title" data-v-c88a18d6><h2 class="title-text" data-v-c88a18d6>目錄</h2><div class="action" data-v-c88a18d6><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 24 24" class="icon minus" data-v-c88a18d6><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2zM20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h8c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg><svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="icon plus" data-v-c88a18d6><path d="M19,2H5C3.3,2,2,3.3,2,5v14c0,1.7,1.3,3,3,3h14c1.7,0,3-1.3,3-3V5C22,3.3,20.7,2,19,2z M20,19c0,0.6-0.4,1-1,1H5c-0.6,0-1-0.4-1-1V5c0-0.6,0.4-1,1-1h14c0.6,0,1,0.4,1,1V19z"></path><path d="M16,11h-3V8c0-0.6-0.4-1-1-1s-1,0.4-1,1v3H8c-0.6,0-1,0.4-1,1s0.4,1,1,1h3v3c0,0.6,0.4,1,1,1s1-0.4,1-1v-3h3c0.6,0,1-0.4,1-1S16.6,11,16,11z"></path></svg></div></div><div class="items" data-v-c88a18d6><!--[--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_0.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 0 章 建構 SQL 執行環境</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_1.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 1 章 資料庫與SQL</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_2.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 2 章 查詢的基本語法</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_3.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 3 章 彙總與排序</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_4.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 4 章 更新資料</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_5.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 5 章 進階查詢功能</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_6.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 6 章 函數、述詞、CASE 運算式</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_7.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 7 章 集合運算 (合併查詢)</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link" href="/vitepress-SQL-zero/guide/chapter_8.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 8 章 SQL 進階處理功能</span><!--]--><!----></a><!----><!--]--><!--[--><a class="VPLink link link active" href="/vitepress-SQL-zero/guide/chapter_9.html" style="padding-left:0px;" tabindex="-1" data-v-4a1a7e6c data-v-3c355974><!--[--><span class="link-text" data-v-4a1a7e6c>第 9 章 從應用程式連接資料庫</span><!--]--><!----></a><!----><!--]--><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-93a960b4 data-v-0bd490fb><div class="VPDoc has-sidebar has-aside" data-v-0bd490fb data-v-c5936a1e><div class="container" data-v-c5936a1e><div class="aside" data-v-c5936a1e><div class="aside-curtain" data-v-c5936a1e></div><div class="aside-container" data-v-c5936a1e><div class="aside-content" data-v-c5936a1e><div class="VPDocAside" data-v-c5936a1e data-v-cdc66372><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-cdc66372 data-v-0627715d><div class="content" data-v-0627715d><div class="outline-marker" data-v-0627715d></div><div class="outline-title" data-v-0627715d>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-0627715d><span class="visually-hidden" id="doc-outline-aria-label" data-v-0627715d> Table of Contents for current page </span><ul class="root" data-v-0627715d data-v-1188541a><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-cdc66372></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-c5936a1e><div class="content-container" data-v-c5936a1e><!--[--><!--]--><main class="main" data-v-c5936a1e><div style="position:relative;" class="vp-doc _vitepress-SQL-zero_guide_chapter_9" data-v-c5936a1e><div><h1 id="第-9-章-從應用程式連接資料庫" tabindex="-1">第 9 章 從應用程式連接資料庫 <a class="header-anchor" href="#第-9-章-從應用程式連接資料庫" aria-hidden="true">#</a></h1><h2 id="_9-1-串聯資料庫和應用程式" tabindex="-1">9-1 串聯資料庫和應用程式 <a class="header-anchor" href="#_9-1-串聯資料庫和應用程式" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>實務上的資訊系統，會採用從程式發出 <code>SQL 敘述</code> 來操作資料庫的運作形式。</li><li>在程式世界和資料庫世界之間，扮演中介角色的便是「 <code>驅動程式</code> 」的小零件，如果沒有它的存在將無法透過程式連上資料庫。</li><li>按照各家資料庫和程式語言的搭配方式，所需的驅動程式也各有不同，若忽略此點可能無法順利連線。</li></ul></div><h3 id="資料庫與應用程式的關係" tabindex="-1">資料庫與應用程式的關係 <a class="header-anchor" href="#資料庫與應用程式的關係" aria-hidden="true">#</a></h3><p>在架設個人專屬的 Web 網站、或在工作上構建資訊系統的時候，無法只靠資料庫來形成完整的系統。資料庫具有儲存資料的重要功能，所以無論建構什麼樣的資訊系統，都必須使用到資料庫，不過單靠資料庫本身，無法涵蓋系統所需的所有功能。</p><p>構建資訊系統的時候，必須以某些程式和資料庫搭配使用，這些程式可以採用各式各樣的程式語言來撰寫，目前比較具代表性的程式語言有 <code>Java</code>、<code>C#</code>、<code>Python</code> 和 <code>Perl</code> 等。</p><p>使用這些程式語言所撰寫完成的程式稱為「 <code>Application Program (應用程式)</code> 」或簡稱「 <code>Application</code> 」。</p><h3 id="驅動程式-2個世界的橋樑" tabindex="-1">驅動程式 - 2個世界的橋樑 <a class="header-anchor" href="#驅動程式-2個世界的橋樑" aria-hidden="true">#</a></h3><p>由於撰寫應用程式可以採用各式各樣的程式語言，其語法和功能都不盡相同，另外在資料庫這端，各家 <code>DBMS</code> 在功能和 <code>SQL 語法</code>上也會有些差異，因此，應用程式和資料庫之間傳遞 SQL 敘述和結果資料的方法，也相當紛亂而具有許多不確定的因素。</p><p>因應上述問題而引進的解決方法，便是在 2 個世界之間安插名為「 <code>驅動程式 (Driver)</code> 」的中介程式。此 <code>驅動程式</code> 是專門設計用來連接應用程式和資料庫的小型程式，以檔案容量來說僅有數百 KB 的程度，由於驅動程式介於 2 者之間，讓 <code>應用程式</code> 和 <code>資料庫</code> 都能保持原本的狀況和發展方向，無論哪方提升版本或變更規格，只要稍微修改一下驅動程式的連接部分即能完成修正的工作。</p><h3 id="驅動程式的種類" tabindex="-1">驅動程式的種類 <a class="header-anchor" href="#驅動程式的種類" aria-hidden="true">#</a></h3><p>驅動程式，在大部分的狀況之下，<code>DBMS</code> 的開發廠商等單位都會提供，而需要注意的地方，只有必須配合 <code>DBMS</code> 和 <code>程式語言</code> 選擇適用的驅動程式。進一步來說，<code>DBMS</code> 的版本為 <code>32位元</code> 或 <code>64位元</code> 的時候，可能需要使用不同的驅動程式 (<code>MariaDB</code> 的 <code>JDBC</code> 驅動程式沒有區分 32位元 或 64位元)，如果沒有使用正確的驅動程式，不僅無法傳送 <code>SQL 敘述</code>，甚至可能完全連不上資料庫。</p><p>目前被廣泛採用的驅動程式規格有 <code>ODBC (Open DataBase Connectivity)</code> 和 <code>JDBC (Java DataBase Connectivity)</code> 等 2 類。 <code>ODBC</code> 是 <code>Microsoft</code> 公司在 1992 年所發表的 <code>DBMS 連接介面規格</code>，之後成為業界的標準，而 <code>JDBC</code> 則是參考前者，另外彙整成 <code>Java</code> 應用程式連接資料庫的規格。</p><p><code>MariaDB</code> 的 <code>JDBC</code> 驅動程式稱為 <code>Connector/J</code>，可由下方的網址頁面下載取得，由於不同版本的 <code>MariaDB</code> 以及 <code>Java</code> 所對應的驅動程式版本也可能不同，請下載適用的版本。</p><ul><li>MariaDB Connector/J (JDBC Driver) <a href="https://downloads.mariadb.org/connector-java/" target="_blank" rel="noreferrer">https://downloads.mariadb.org/connector-java/</a><a href="https://mvnrepository.com/artifact/org.mariadb.jdbc/mariadb-java-client/2.2.5" target="_blank" rel="noreferrer">https://mvnrepository.com/artifact/org.mariadb.jdbc/mariadb-java-client/2.2.5</a></li></ul><p>本教學採用 <code>Java Version 8</code> 的開發執行環境，目前頁面上最新的「 1.5.9 」版本即可適用，點選「 <code>Download 1.5.9 Stable Now!</code> 」按鈕之後會進入該版本的下載頁面，這裡請選擇直接下載 <code>jar</code> 格式檔案，取得 <code>mariadb-java-client-1.5.9.jar</code>。</p><p>此即為驅動程式的檔案，此檔案建議放在先前安裝 <code>xampp</code> 時 <code>MariaDB</code> 的預設路徑「 <code>C:\xampp\mysql</code> 」，在其下新建名為「 <code>jdbc</code> 」的資料夾，將先前下載的驅動程式檔案放置於此。<code>C:\xampp\mysql\jdbc</code>。</p><p>如此便完成從程式連接至資料庫的準備工作，可以準備實際使用 <code>Java</code> 連上 <code>MariaDB</code> 了。</p><h2 id="_9-2-程式的基礎知識" tabindex="-1">9-2 程式的基礎知識 <a class="header-anchor" href="#_9-2-程式的基礎知識" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>若想讓 Java 程式能順利運行，在原始碼撰寫完成之後，必須先進行編譯的動作。</li><li>和 SQL 敘述不同，Java 的原始碼會區分保留字的大小寫。</li></ul></div><h3 id="一如往例的「hello-world」" tabindex="-1">一如往例的「Hello, World」 <a class="header-anchor" href="#一如往例的「hello-world」" aria-hidden="true">#</a></h3><p>試著以 <code>Java</code> 語言來 <code>撰寫程式碼(Coding)</code> 並實際執行看看吧。 先不急著連上資料庫，此程式的內容僅具有「 在畫面上顯示簡短字串 」的單純功能，而輸出的字串設定成「 <code>Hello, World</code> 」。</p><ul><li><h4 id="撰寫原始碼-儲存成原始碼檔案" tabindex="-1">撰寫原始碼，儲存成原始碼檔案 <a class="header-anchor" href="#撰寫原始碼-儲存成原始碼檔案" aria-hidden="true">#</a></h4><div class="warning custom-block"><p class="custom-block-title">範例 9-1</p><p>在畫面上顯示簡短字串的 Java 程式</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Hello</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">args</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Hello, World</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div><p>開啟編輯軟體，輸入上述的範例原始碼之後，儲存成檔名為「 <code>Hello.java</code> 」的檔案，並放置在如下所示的資料夾路徑： <code>C:\xampp\jsva\src</code></p><p>此資料夾實際上可以放置在任意的路徑位置，不過為了容易理解與方便取用，建議集中在 <code>xampp</code> 的資料夾之下。</p></li></ul><h3 id="編譯與執行程式" tabindex="-1">編譯與執行程式 <a class="header-anchor" href="#編譯與執行程式" aria-hidden="true">#</a></h3><p>將原始碼存成檔案放在資料夾之後，便完成了 <code>Java</code> 的原始碼檔案，不過此檔案無法直接運行，接下來還必須經過「 <code>編譯 (Compile)</code> 」的步驟，才能製作出可執行的 <code>Java</code> 程式檔案。<code>Compile</code>，被用來表是「 <code>將人員所編寫的原始碼，轉換成電腦能執行的程式碼</code> 」的意思。</p><p>進行編譯的時候，需要使用到「 <code>javac.exe</code> 」這隻程式，它被包含在先前安裝完成的 <code>JDK</code> 之中，其名稱結尾的「 <code>c</code> 」為 <code>compile</code> 的縮寫。</p><p>使用 javac.exe 的時候，必須在 <code>終端機(命令提示字元)</code> 視窗中執行指令。</p><p>首先，為了移動至原始碼檔案所在的資料夾，請輸入下列指令，輸入完畢後按下「 <code>Enter</code> 」送出執行。</p><p>cd 指令 (移動至指定的資料夾)</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#82AAFF;">cd</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\x</span><span style="color:#C3E88D;">ampp</span><span style="color:#A6ACCD;">\j</span><span style="color:#C3E88D;">ava</span><span style="color:#A6ACCD;">\s</span><span style="color:#C3E88D;">rc</span></span>
<span class="line"></span></code></pre></div><ul><li><h4 id="以-javac-指令編譯出-class-檔案" tabindex="-1">以 javac 指令編譯出 class 檔案 <a class="header-anchor" href="#以-javac-指令編譯出-class-檔案" aria-hidden="true">#</a></h4><p>已經移動至指定的資料夾，再來，請在命令提示字元視窗中，輸入下列指令：</p><p>javac 指令 (編譯程式)</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">C:\xampp\java\jdk\bin\javac</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Hello.java</span></span>
<span class="line"></span></code></pre></div><blockquote><p>實際上可以設定成只需輸入「 <code>javac</code> 」而省略掉資料夾路徑，這需要設定作業系統的「 <code>環境變數 PATH </code>」。</p></blockquote></li></ul><div class="tip custom-block"><p class="custom-block-title">牢記的原則 9-1</p><p>若想讓 <code>Java</code> 程式能實際執行，在原始碼撰寫完成之後，必須先進行編譯的動作。</p></div><p>編譯成功之後，在放置原始碼檔案的資料夾中，會產生 1 個名為「 <code>Hello.class</code> 」的新檔案，這是稱為「 <code>類別檔案 (Class File)</code> 」的 <code>Java 可執行檔案</code>。</p><ul><li><h4 id="以-java-指令執行程式" tabindex="-1">以 java 指令執行程式 <a class="header-anchor" href="#以-java-指令執行程式" aria-hidden="true">#</a></h4><p>成為這種狀態之後，程式已經可以實際執行，而若想執行此種格式的程式，需要使用包含在「 <code>C:\xampp\java\jdk\bin</code> 」資料夾內的「 <code>java.exe</code> 」執行檔，請在命令提示字元中輸入下列指令：</p><p>java 指令 (執行程式)</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">C:\xampp\java\jdk\bin\java</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Hello</span></span>
<span class="line"></span></code></pre></div><p>如果命令提示字元視窗顯示「 <code>Hello, World</code> 」的訊息，代表成功執行完畢。</p></li></ul><p>如上所述，以 Java 語言撰寫程式的時候，必須按照下列的順序操作：</p><ol><li>撰寫原始碼，儲存原始碼檔案</li><li>以 <code>javac</code> 指令進行編譯，產生類別檔案</li><li>以 <code>java</code> 指令執行類別檔案</li></ol><h3 id="常見的錯誤" tabindex="-1">常見的錯誤 <a class="header-anchor" href="#常見的錯誤" aria-hidden="true">#</a></h3><p>以 <code>Java</code> 撰寫原始碼的時候，初學者會有一些常犯的錯誤，這裡列出幾點，請撰寫時多加留意。</p><ul><li><h4 id="弄錯大寫與小寫字母" tabindex="-1">弄錯大寫與小寫字母 <a class="header-anchor" href="#弄錯大寫與小寫字母" aria-hidden="true">#</a></h4><p>撰寫 <code>SQL 敘述</code> 時，保留字的大寫或小寫在功能上沒有分別，都能正常執行並獲得相同的結果，不過 <code>Java</code> 語言會區分英文字母的大小寫。</p><div class="danger custom-block"><p class="custom-block-title">範例 9-2</p><p>[錯誤範例] 將大寫字母輸入成小寫字母</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight has-highlighted-lines"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Hello</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">args</span><span style="color:#89DDFF;">){</span></span>
<span class="line highlighted"><span style="color:#A6ACCD;">    system</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Hello, World</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">Hello</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">java</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#F78C6C;">3</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> error</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">package</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">system does not exist</span></span>
<span class="line"><span style="color:#C792EA;">            system</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">out</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">print(&quot;Hello, World&quot;)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">                  </span><span style="color:#89DDFF;">^</span></span>
<span class="line"><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> error</span></span>
<span class="line"></span></code></pre></div><p>這段訊息主要在表示「 <code>Hello.java</code> 」檔案的 <code>第 3 行</code> 部分有誤。</p></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 9-2</p><p><code>Java</code> 的原始碼會區分保留字的大小寫，這是不同於 <code>SQL</code> 的差異。</p></div></li><li><h4 id="使用全形空白" tabindex="-1">使用全形空白 <a class="header-anchor" href="#使用全形空白" aria-hidden="true">#</a></h4><p>原始碼中不能使用 <code>全形</code> 的文字 (除了中文的字串資料和註解)，此規則和 <code>SQL 敘述</code> 相同，不過有時候可能會不小心把半形空白輸入成全形空白。</p><div class="danger custom-block"><p class="custom-block-title">範例 9-3</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Hello</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">　  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">args</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#A6ACCD;">        System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">Hello, World</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>雖然看不出來全形空白，但如果將這樣的原始碼儲存成檔案，交給 <code>javac</code> 指令進行編譯，畫面上會顯示如下的錯誤訊息。</p><p>執行結果</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">Hello</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">java</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#F78C6C;">2</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> error</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> illegal character</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">\u</span><span style="color:#C3E88D;">3000</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#A6ACCD;">      </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> args</span><span style="color:#89DDFF;">){</span></span>
<span class="line"><span style="color:#89DDFF;">^</span></span>
<span class="line"><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> error</span></span>
<span class="line"></span></code></pre></div><p>這段訊息主要在說明「 <code>Hello.java</code> 」檔案內容的第 2 行有誤，其中的「 <code>\u300</code> 」是全形空白對應的文字編碼，因為「 <code>使用了不能使用的文字</code> 」而導致無法進行編譯。</p></div><div class="tip custom-block"><p class="custom-block-title">牢記的原則 9-3</p><p><code>Java</code> 的原始碼中沒有 <code>全形文字</code>／<code>全形空白</code> 出場的機會 (註解除外)。</p></div></li><li><h4 id="原始碼檔案的-檔名-和-類別名稱-不一致" tabindex="-1">原始碼檔案的 檔名 和 類別名稱 不一致 <a class="header-anchor" href="#原始碼檔案的-檔名-和-類別名稱-不一致" aria-hidden="true">#</a></h4><p>如果試著把先前建立的原始碼檔案「 <code>Hello.java</code> 」直接改名為「 <code>Test.java</code> 」，再進行編譯的動作，當然編譯指令也需要改成如下的樣子。</p><div class="danger custom-block"><p class="custom-block-title">編譯</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">C:\xampp\java\jdk\bin\javac</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Test.java</span></span>
<span class="line"></span></code></pre></div><p>不過卻出現以下的錯誤訊息。</p><p>執行結果</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#A6ACCD;">Test</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">java</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#F78C6C;">1</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> error</span><span style="color:#89DDFF;font-style:italic;">:</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Hello</span><span style="color:#A6ACCD;"> is </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;">, should be declared in a file named Hello.java</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">Hello</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">       </span><span style="color:#89DDFF;">^</span></span>
<span class="line"><span style="color:#F78C6C;">1</span><span style="color:#A6ACCD;"> error</span></span>
<span class="line"></span></code></pre></div><p>這是因為原始碼檔案內所命名的類別名稱「 <code>Hello</code> 」，和檔案名稱的「 <code>Test</code> 」不一致而發生的錯誤。</p><p><code>Java</code> 原始碼檔案的名稱必須和其內容第 1 行的類別名稱相同。而且連英文字母的大小寫都必須相同。</p></div></li><li><h4 id="資料夾路徑或檔案名稱等輸入錯誤" tabindex="-1">資料夾路徑或檔案名稱等輸入錯誤 <a class="header-anchor" href="#資料夾路徑或檔案名稱等輸入錯誤" aria-hidden="true">#</a></h4><p>進行編譯或執行的時候，如果不小心輸入錯誤的 <code>資料夾名稱</code> 或 <code>指令名稱</code>，當然只會獲得錯誤的訊息，尤其請特別留意 <code>javac</code> 或 <code>java</code> 指令前方的資料夾名稱是否正確。</p><p>錯把「 <code>bin</code> 」打成「 <code>vin</code> 」。</p><p>執行 (資料夾路徑錯誤)</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">C:\xampp\java\jdk\vin\java</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Hello</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">系統找不到指定的路徑。</span></span>
<span class="line"></span></code></pre></div><p>路徑指的是一連串資料夾所構成的存放位置，因為「 <code>找不到指定的資料夾</code> 」而無法順利執行。</p><p>或是將類別名稱「 <code>Hello</code> 」錯誤輸入成「 <code>Hallo</code> 」，也會發生錯誤：</p><p>執行 (類別名稱錯誤)</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">C:\xampp\java\jdk\bin\java</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Hallo</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">錯誤：找不到或無法載入主要類別</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">Hallo。</span></span>
<span class="line"></span></code></pre></div><p>這次則是因為「 <code>找不到指定的類別</code> 」而無法順利執行。</p></li></ul><h2 id="_9-3-利用程式連到-mariadb" tabindex="-1">9-3 利用程式連到 MariaDB <a class="header-anchor" href="#_9-3-利用程式連到-mariadb" aria-hidden="true">#</a></h2><div class="info custom-block"><p class="custom-block-title">學習重點</p><ul><li>在 <code>Java</code> 程式中，可以透過資料庫的驅動程式執行各式各樣的 SQL 敘述。</li><li>資料庫將 <code>SELECT 敘述</code> 的結果資料回傳給 <code>Java</code> 程式之後，程式需要以迴圈方式逐一處理每一行資料，這是能 1 次處理多行資料的資料庫世界，以及 1 次只能處理 1 行資料的程式世界之間的差異。</li></ul></div><h3 id="執行-sql-敘述的-java-程式" tabindex="-1">執行 SQL 敘述的 Java 程式 <a class="header-anchor" href="#執行-sql-敘述的-java-程式" aria-hidden="true">#</a></h3><p>首先所要撰寫的程式，其功能為執行「 SELECT 1 AS col_1 」這樣非常簡單的 SELECT 敘述，並且將執行的結果顯示於畫面之上。</p><div class="warning custom-block"><p class="custom-block-title">範例 9-4</p><p>執行 SELECT 敘述 的 Java 程式</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">sql</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">*</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DBConnect1</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 1) 連接至 MariaDB 的資訊 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Connection</span><span style="color:#A6ACCD;"> con</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Statement</span><span style="color:#A6ACCD;"> st</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">ResultSet</span><span style="color:#A6ACCD;"> rs</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">jdbc:mariadb://localhost:3306/mysql</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> user </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;帳號&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> password </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;密碼&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 2) 載入 JDBC 驅動程式 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    Class</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forName</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">org.mariadb.jdbc.Driver</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 3) 連接至 MariaDB */</span></span>
<span class="line"><span style="color:#A6ACCD;">    con </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> DriverManager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getConnection</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> password</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    st </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> con</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createStatement</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 4) 執行 SELECT 敘述 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    rs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeQuery</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">SELECT 1 AS col_1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 5) 將結果顯示於畫面上 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    rs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">next</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getInt</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">col_1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 6) 關閉和 MariaDB 之間的連線 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    rs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    con</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div><h3 id="java-如何從資料庫取得資料" tabindex="-1">Java 如何從資料庫取得資料 <a class="header-anchor" href="#java-如何從資料庫取得資料" aria-hidden="true">#</a></h3><p>首先，原始碼的第 1 行為「 <code>import java.sql.*;</code> 」，這是為了能連上資料庫以及傳送執行 <code>SQL 敘述</code>，預先宣告匯入 <code>Java</code> 的相關必要功能，少了這行程式碼，下面所要介紹的 <code>Connection</code> 和 <code>Statement</code> 等類別將無法使用。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* 1) 連接至 MariaDB 的資訊 */</span></span>
<span class="line"></span></code></pre></div><p>這裡宣告了連線所需的物件 (<code>Object</code>)，並且帶入 <code>使用者帳號</code> 和 <code>密碼</code> 等必要資訊，以便之後連接登入資料庫。從 <code>Java 程式</code> 連接至 <code>資料庫</code>的時候，下列 3 個物件是不可缺少的要素。</p><h5 id="connection-連線-負責連接資料庫的任務。" tabindex="-1"><code>Connection</code>：連線，負責連接資料庫的任務。 <a class="header-anchor" href="#connection-連線-負責連接資料庫的任務。" aria-hidden="true">#</a></h5><h5 id="statement-陳述-負責儲存想要執行的-sql-敘述。" tabindex="-1"><code>Statement</code>：陳述，負責儲存想要執行的 SQL 敘述。 <a class="header-anchor" href="#statement-陳述-負責儲存想要執行的-sql-敘述。" aria-hidden="true">#</a></h5><h5 id="resultset-結果集合-負責儲存-sql-敘述的執行結果。" tabindex="-1"><code>ResultSet</code>：結果集合，負責儲存 SQL 敘述的執行結果。 <a class="header-anchor" href="#resultset-結果集合-負責儲存-sql-敘述的執行結果。" aria-hidden="true">#</a></h5><ul><li><p>另外還宣告了 <code>url</code>、<code>user</code> 和 <code>password</code> 等 3 個字串變數，其中的 <code>user</code> 和 <code>password</code> 是用來登入資料庫的使用者帳號和密碼，而 <code>url</code> 的用途，相當於目標資料庫的「 <code>地址</code> 」，其表達方式有點類似 Web 網站的 URL，以 <code>斜線(/)</code> 區隔各項資訊。</p></li><li><p>從左邊開始依序說明，「 <code>jdbc:mariadb://</code> 」的部分代表了連線的協定，表示「 <code>使用 JDBC 連接至 MariaDB 資料庫</code> 」的意思，類似網站URL的「 <code>http://</code> 」部分。</p></li><li><p>「 <code>localhost</code> 」用來指定安裝著 <code>MariaDB</code> 的電腦主機或設備的網路位置，由於目前 Java 程式 和 資料庫 同在 1 部電腦上運行，所以寫著代表本機電腦的「 <code>localhost</code> 」字串，這等同於寫入「 <code>127.0.0.1</code> 」的 <code>IP 位址</code>。實際的系統或進行開發的時候，<code>Java 應用程式</code> 和 <code>資料庫</code> 分別運行於不同的電腦主機是相當常見的狀況，在這種狀況之下，此處需要改成 <code>資料庫</code> 運行設備的 <code>IP 位址</code> 或 <code>主機名稱</code>。</p></li><li><p>「 <code>3306</code> 」的數字代表 MariaDB 所使用的 <code>埠號 (Port)</code>，而所謂的 <code>埠號</code>，相當於電腦中運行程式對外通訊用的「 <code>窗口</code> 」，換個說法，如果把 IP 位址或主機名稱比喻成住宅大樓的地址或大樓名稱，那麼 <code>埠號</code> 就相當於 各住戶單元的房號。安裝 <code>MariaDB</code> 的時候若沒有特別做變更，使用預設的 <code>埠號</code> 「 <code>3306</code> 」即可連線。</p></li><li><p>「 <code>mysql</code> 」用來指定登入 <code>MariaDB</code> 之後所使用的資料庫名稱 (作用中的資料庫)。其實各家 <code>DBMS</code> 都可以在內建建立多個不同名稱的資料庫，由於 <code>MariaDB</code> 安裝後必定會產生「 <code>mysql</code> 」資料庫，用來儲存系統相關的設定。</p></li></ul><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* 2) 載入 JDBC 驅動程式 */</span></span>
<span class="line"></span></code></pre></div><ul><li><p>段落 2 的功用為載入 <code>JDBC 驅動程式</code>，此行程式碼表達連線時，應該使用何種驅動程式，當中的「 <code>org.mariadb.jdbc.Driver</code> 」是 <code>MariaDB</code> 的 <code>JDBC 驅動程式</code> 的 <code>類別名稱</code>。如果使用其他的 <code>DBMS</code> 或 其他的驅動程式時，需要配合修改成適當的文字。</p></li><li><p>附帶一提，<code>MariaDB Connector/J</code> 的說明有提到，現在可以省略這行程式碼，實際試過註解掉也能正常執行。</p></li></ul><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* 3) 連接至 MariaDB */</span></span>
<span class="line"></span></code></pre></div><p>這裡才實際使用 <code>URL</code>、<code>使用者帳號</code>、<code>密碼</code> 等資訊連上 <code>MariaDB</code>。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* 4) 執行 SELECT 敘述 */</span></span>
<span class="line"></span></code></pre></div><p>執行 <code>SELECT 敘述</code></p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* 5) 將結果顯示於畫面上 */</span></span>
<span class="line"></span></code></pre></div><p>負責將獲得的結果顯示於畫面上</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* 6) 關閉和 MariaDB 之間的連線 */</span></span>
<span class="line"></span></code></pre></div><p>會 <code>關閉(Close)</code> 與 <code>資料庫</code> 之間的連線。為什麼需要這個關閉連線的動作呢？因為和資料庫建立連線之後，會消耗 2 端設備連線所需的 <code>記憶體容量</code>，若是每次操作資料庫之後都沒有關閉連線，隨著連線所造成的「 <code>佔用片段</code> 」越來越多，勢必會壓迫到記憶體的容量而引起效能上的問題。</p><h3 id="執行連接至資料庫的程式" tabindex="-1">執行連接至資料庫的程式 <a class="header-anchor" href="#執行連接至資料庫的程式" aria-hidden="true">#</a></h3><p>編譯的指令和之前差不多，如果原始碼檔案的名稱為「 <code>DBConnect1.java</code> 」，並且存放在「 <code>C:\xampp\java\src</code> 」的資料夾之中，那麼便可在命令提示字元中執行如下的 <code>javac</code> 指令，將原始碼檔案編譯成可執行的類別檔案。</p><ul><li>編譯<div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">C:\xampp\java\jdk\bin\javac</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DBConnect1.java</span></span>
<span class="line"></span></code></pre></div></li></ul><p>另外，執行此段指令之前，也需要先將當前資料夾移動至存放原始碼檔案的資料夾，否則會因為找不到原始碼檔案，而產生「 <code>資料夾路徑或檔案名稱等輸入錯誤</code> 」無法順利編譯。</p><p>編譯成功之後，存放原始碼檔案的資料夾中會產生名為「 <code>DBConnect1.class</code> 」的新檔案，雖然同樣需要以 <code>java 指令</code> 來執行此檔案，不過此次的指令必須增加 1 個附加參數。</p><ul><li>指定 <code>JDBC 驅動程式</code> 檔案的同時執行 <code>Java 程式</code><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">C:\xampp\java\jdk\bin\java</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-cp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\x</span><span style="color:#C3E88D;">ampp</span><span style="color:#A6ACCD;">\m</span><span style="color:#C3E88D;">ysql</span><span style="color:#A6ACCD;">\j</span><span style="color:#C3E88D;">dbc</span><span style="color:#A6ACCD;">\*</span><span style="color:#89DDFF;">;</span><span style="color:#82AAFF;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DBConnect1</span></span>
<span class="line"></span></code></pre></div><blockquote><p>mac 要執行</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">java</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-cp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.:/xampp/mysql/jdbc/</span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DBConnect1</span></span>
<span class="line"></span></code></pre></div></blockquote></li></ul><p>此次在 java 指令和類別名稱「 <code>DBConnect1</code> 」之間，增加寫入了「 <code>-cp C:\xampp\mysql\jdbc\*;.</code> 」的文字，這是為了告知 <code>Java 程式</code>，<code>JDBC 驅動程式</code> 的檔案「 <code>mariadb-java-client-1.5.9.jar</code> 」存放於何處，「 <code>cp</code> 」是「 <code>類別路徑 (Classpath)</code> 」的縮寫，代表「<code> 類別檔案存放位置</code> 」的意思。</p><p>「 <code>JDBC 驅動程式的副檔名明明是 jar 而非 class，為什麼稱之為類別路徑呢？</code> 」，這是因為 <code>jar 檔案</code> 其實是彙集了多個類別檔案的壓縮檔，所以也可以將類別路徑指向 <code>jar 檔案</code>。</p><p>而「 <code>C:\xampp\mysql\jdbc\*;.</code> 」這段文字，代表了 「 <code>C:\xampp\mysql\jdbc</code> 」資料夾內的所有檔案，</p><p>「 <code>*</code> 」星號是 Windows 系統中代替「 <code>任意長度字串</code> 」的萬用字元。</p><p>「 <code>;</code> 」分號是用來隔開多個指定路徑 (mac 以「 : 」串接)，</p><p>而「 <code>.</code> 」句點則代表當前的路徑，</p><p>這是為了納入「 <code>DBConnect1.class</code> 」所在的資料夾路徑。</p><h3 id="嘗試篩選出資料表的資料" tabindex="-1">嘗試篩選出資料表的資料 <a class="header-anchor" href="#嘗試篩選出資料表的資料" aria-hidden="true">#</a></h3><p>試著從儲存著多筆資料的資料表篩選出資料，並且顯示於畫面之上，而操作對象的範例資料表，將採用 <code>商品(Shohin)資料表</code>。</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th>shohin_catalg</th><th>sell_price</th><th>buying_price</th><th>reg_date</th></tr></thead><tbody><tr><td>0001</td><td>T恤</td><td>衣物</td><td>1000</td><td>500</td><td>2009-09-20</td></tr><tr><td>0002</td><td>打孔機</td><td>辦公用品</td><td>500</td><td>320</td><td>2009-09-11</td></tr><tr><td>0003</td><td>襯衫</td><td>衣物</td><td>4000</td><td>2800</td><td></td></tr><tr><td>0004</td><td>菜刀</td><td>廚房用品</td><td>3000</td><td>2800</td><td>2009-09-20</td></tr><tr><td>0005</td><td>壓力鍋</td><td>廚房用品</td><td>6800</td><td>5000</td><td>2009-01-15</td></tr><tr><td>0006</td><td>叉子</td><td>廚房用品</td><td>500</td><td></td><td>2009-09-20</td></tr><tr><td>0007</td><td>刨絲器</td><td>廚房用品</td><td>880</td><td>790</td><td>2008-04-28</td></tr><tr><td>0008</td><td>鋼珠筆</td><td>辦公用品</td><td>100</td><td></td><td>2009-11-11</td></tr></tbody></table><p>如果已經完成建立資料表和存入資料的動作，可略過 範例 9-5</p><div class="warning custom-block"><p class="custom-block-title">範例 9-5</p><p>建立 Shohin 資料表的 SQL 敘述</p><div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- 建立 shop 資料庫</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">DATABASE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">shop</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 暫時以「 \q 」退出 MariaDB，再度從命令提示字元登入 MariaDB 並啟用 shop 資料庫，這裡需要使用安裝時指定的帳號和密碼。</span></span>
<span class="line"><span style="color:#A6ACCD;">C:\xampp\mysql\bin\mysql.exe </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">u</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">帳號</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">-</span><span style="color:#A6ACCD;">p</span><span style="color:#89DDFF;">&lt;</span><span style="color:#A6ACCD;">密碼</span><span style="color:#89DDFF;">&gt;</span><span style="color:#A6ACCD;"> shop</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 建立 Shohin 資料表</span></span>
<span class="line"><span style="color:#F78C6C;">CREATE</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">TABLE</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">Shohin</span></span>
<span class="line"><span style="color:#A6ACCD;">(shohin_id </span><span style="color:#C792EA;">CHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">4</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">shohin_name </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">shohin_catalg </span><span style="color:#C792EA;">VARCHAR</span><span style="color:#A6ACCD;">(</span><span style="color:#F78C6C;">32</span><span style="color:#A6ACCD;">) </span><span style="color:#F78C6C;">NOT NULL</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">sell_price </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">buying_price </span><span style="color:#C792EA;">INTEGER</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#A6ACCD;">reg_date </span><span style="color:#C792EA;">DATE</span><span style="color:#A6ACCD;">,</span></span>
<span class="line"><span style="color:#C792EA;">PRIMARY KEY</span><span style="color:#A6ACCD;"> (shohin_id));</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">-- 存入商品資料</span></span>
<span class="line"><span style="color:#F78C6C;">START TRANSACTION</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">T恤</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">打孔機</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">320</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-11</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">襯衫</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">4000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0004</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">菜刀</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0005</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">壓力鍋</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">6800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">5000</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-01-15</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0006</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">叉子</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">刨絲器</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">880</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">790</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2008-04-28</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0008</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">鋼珠筆</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-11-11</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#F78C6C;">COMMIT</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></div><p>程式將從此資料表篩選出「 <code>shohin_id</code> 」和「 <code>shohin_name</code> 」這 2 個欄位的全部紀錄，原始碼檔案的名稱請命名為「 <code>DBConnect2.java</code> 」。</p><div class="warning custom-block"><p class="custom-block-title">範例 9-6</p><p>從 <code>Shohin 資料表</code> 篩選出「 <code>shohin_id</code> 」和「 <code>shohin_name</code> 」這 2 個欄位的所有紀錄</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">sql</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">*</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DBConnect2</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 1) 連接至 MariaDB 的資訊*/</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Connection</span><span style="color:#A6ACCD;"> con</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Statement</span><span style="color:#A6ACCD;"> st</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">ResultSet</span><span style="color:#A6ACCD;"> rs</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">jdbc:mariadb://localhost:3306/shop</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> user </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;帳號&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> password </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;密碼&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 2) 載入 JDBC 驅動程式 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    Class</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forName</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">org.mariadb.jdbc.Driver</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 3) 連接至 MariaDB */</span></span>
<span class="line"><span style="color:#A6ACCD;">    con </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> DriverManager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getConnection</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> password</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    st </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> con</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createStatement</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 4) 執行 SELECT 敘述 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    rs </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeQuery</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">SELECT shohin_id, shohin_name FROM Shohin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 5) 將結果顯示於畫面上 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">next</span><span style="color:#89DDFF;">())</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">      System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getString</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">shohin_id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">, </span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">      System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">rs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getString</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">shohin_name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">));</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 6) 關閉和 MariaDB 之間的連線 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    rs</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    con</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>執行結果</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">0001</span><span style="color:#A6ACCD;">, T恤</span></span>
<span class="line"><span style="color:#F78C6C;">0002</span><span style="color:#A6ACCD;">, 打孔機</span></span>
<span class="line"><span style="color:#F78C6C;">0003</span><span style="color:#A6ACCD;">, 襯衫</span></span>
<span class="line"><span style="color:#F78C6C;">0004</span><span style="color:#A6ACCD;">, 菜刀</span></span>
<span class="line"><span style="color:#F78C6C;">0005</span><span style="color:#A6ACCD;">, 壓力鍋</span></span>
<span class="line"><span style="color:#F78C6C;">0006</span><span style="color:#A6ACCD;">, 叉子</span></span>
<span class="line"><span style="color:#F78C6C;">0007</span><span style="color:#A6ACCD;">, 刨絲器</span></span>
<span class="line"><span style="color:#F78C6C;">0008</span><span style="color:#A6ACCD;">, 鋼珠筆</span></span>
<span class="line"></span></code></pre></div></div><ul><li><p>編譯</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">C:\xampp\java\jdk\bin\javac</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DBConnect2.java</span></span>
<span class="line"></span></code></pre></div></li><li><p>執行</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">C:\xampp\java\jdk\bin\java</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-cp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\x</span><span style="color:#C3E88D;">ampp</span><span style="color:#A6ACCD;">\m</span><span style="color:#C3E88D;">ysql</span><span style="color:#A6ACCD;">\j</span><span style="color:#C3E88D;">dbc</span><span style="color:#A6ACCD;">\*</span><span style="color:#89DDFF;">;</span><span style="color:#82AAFF;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DBConnect2</span></span>
<span class="line"></span></code></pre></div><blockquote><p>mac 要執行</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">java</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-cp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.:/xampp/mysql/jdbc/</span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DBConnect2</span></span>
<span class="line"></span></code></pre></div></blockquote></li></ul><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* 1) 連接至 MariaDB 的資訊 */</span></span>
<span class="line"></span></code></pre></div><p>請注意連接資訊的 <code>字串 url</code> 最後的資料庫名稱，需要從先前的「 <code>mysql</code> 」改為「 <code>shop</code> 」，而登入帳號使用具有 shop 資料表 <code>權限</code> 的帳號即可。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* 2) 載入 JDBC 驅動程式 */</span></span>
<span class="line"><span style="color:#676E95;font-style:italic;">/* 3) 連接至 MariaDB */</span></span>
<span class="line"></span></code></pre></div><p>由於是使用相同的 <code>JDBC 驅動程式</code>，所以這部分不必做修改。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* 4) 執行 SELECT 敘述 */</span></span>
<span class="line"></span></code></pre></div><p><code>SQL 敘述</code>，需要改成此次執行目標的 <code>SELECT 敘述</code>。</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* 5) 將結果顯示於畫面上 */</span></span>
<span class="line"></span></code></pre></div><p>由於最後要呈現多行資料的結果，所以需要使用 <code>while 迴圈</code> 逐行取得資料，再顯示於畫面之上。</p><p><code>rs</code>，是名為 <code>ResultSet (結果集合)</code> 的物件，負責儲存 <code>SELECT 敘述</code>，執行之後回傳的結果，可以把它儲存資料的方式想像成 2次元表格形式。由於 <code>Java</code> 之類的一般 <code>程式型語言 (Procedural Language)</code> 基本上需要逐行處理資料，所以想要操作多行資料的時候，必須使用 <code>迴圈</code> 的功能來達成。</p><p>「 <code>rs.next()</code> 」會將當前的讀取位置移動至下 1 行，所以「 <code>while(rs.next())</code> 」代表每輪迴圈移動到下 1 行資料的意思，如此一來就像是有個游標在結果集合中由上往下移動，而此游標亦稱為「 <code>指標 (cursor)</code> 」。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 9-4</p><p>在 Java 等程式的世界中，1 次僅能處理 1 行資料，而需要處理多行資料的時候，需要寫成迴圈的形式。</p></div><h3 id="嘗試修改資料表的資料" tabindex="-1">嘗試修改資料表的資料 <a class="header-anchor" href="#嘗試修改資料表的資料" aria-hidden="true">#</a></h3><p>嘗試從 <code>Java 程式</code> 送出能修改資料的 <code>SQL 敘述</code>，改變資料表中儲存的資料，而從此次範例的目標，便能傳送能刪除商品資料表中所有資料的 <code>DELETE 敘述</code>。</p><div class="warning custom-block"><p class="custom-block-title">範例 9-7</p><p>刪除 Shohin 資料表中所有紀錄的 Java 程式</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">sql</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">*</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DBConnect3</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 1) 連接至 MariaDB 的資訊*/</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Connection</span><span style="color:#A6ACCD;"> con</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Statement</span><span style="color:#A6ACCD;"> st</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">jdbc:mariadb://localhost:3306/shop</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> user </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;帳號&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> password </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;密碼&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 2) 載入 JDBC 驅動程式 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    Class</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forName</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">org.mariadb.jdbc.Driver</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 3) 連接至 MariaDB */</span></span>
<span class="line"><span style="color:#A6ACCD;">    con </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> DriverManager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getConnection</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> password</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    st </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> con</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createStatement</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 4) 執行 SELECT 敘述 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">int</span><span style="color:#A6ACCD;"> delcnt </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeUpdate</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">DELETE FROM Shohin</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 5) 將結果顯示於畫面上 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">刪除了</span><span style="color:#89DDFF;">&quot;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> delcnt </span><span style="color:#89DDFF;">+</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">筆紀錄</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 6) 關閉和 MariaDB 之間的連線 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    con</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></div><p>此段原始碼主要改變的地方，在於</p><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/* 4) 執行 SELECT 敘述 */</span></span>
<span class="line"></span></code></pre></div><p>改為 <code>DELETE 敘述</code>，以及傳送執行 <code>SQL 敘述</code> 的指令從 <code>executeQuery</code> 改成 <code>executeUpdate</code>。無論是 INSERT 敘述或 UPDATE 敘述，從 Java 程式送出更新資料的 SQL 敘述時，需要使用 <code>executeUpdate</code> 的方法。</p><p>由於這次不會從資料表取得資料，用不到 <code>ResultSet 類別</code> 的物件。所以原始碼刪除了相關的部分。</p><ul><li><p>編譯</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">C:\xampp\java\jdk\bin\javac</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DBConnect3.java</span></span>
<span class="line"></span></code></pre></div></li><li><p>執行</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">C:\xampp\java\jdk\bin\java</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-cp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">C:</span><span style="color:#A6ACCD;">\x</span><span style="color:#C3E88D;">ampp</span><span style="color:#A6ACCD;">\m</span><span style="color:#C3E88D;">ysql</span><span style="color:#A6ACCD;">\j</span><span style="color:#C3E88D;">dbc</span><span style="color:#A6ACCD;">\*</span><span style="color:#89DDFF;">;</span><span style="color:#82AAFF;">.</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DBConnect3</span></span>
<span class="line"></span></code></pre></div><blockquote><p>mac 要執行</p><div class="language-sh"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#FFCB6B;">java</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">-cp</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">.:/xampp/mysql/jdbc/</span><span style="color:#A6ACCD;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#C3E88D;">DBConnect3</span></span>
<span class="line"></span></code></pre></div></blockquote></li></ul><p>若最後執行成功，命令提示字元視窗中，應該會顯示「 <code>刪除了 8 筆紀錄</code> 」的訊息。而想要執行多段更新資料的 <code>SQL 敘述</code> 時，原始碼撰寫上需要注意 <code>交易功能控制</code> 的問題，不過基本做法還是相同的。附帶一提，以 <code>DBConnect3</code> 執行 <code>DELETE</code> 敘述的時候，會自動執行 <code>認可 (COMMIT)</code> 的動作。</p><div class="tip custom-block"><p class="custom-block-title">牢記的原則 9-5</p><p>透過資料庫的驅動程式，便能從程式執行 <code>SELECT</code>、<code>DELETE</code>、<code>UPDATE</code> 和<code>INSERT</code> 敘述等所有的 <code>SQL 敘述</code>。</p></div><h3 id="小結" tabindex="-1">小結 <a class="header-anchor" href="#小結" aria-hidden="true">#</a></h3><p>如果能完成前面所有的練習範例，之後只要修改 <code>段落 4</code> 和 <code>段落 5</code> 的部分，那麼無論多麽複雜的 <code>SQL 敘述</code> 都能透過程式來執行。</p><p>在實際運作的資訊系統上，會在程式中以動態的方式組合出所需的 <code>SQL 敘述</code>，或先從 <code>資料庫</code> 篩選出資料，經過編輯之後再回存至 <code>資料庫</code> 中，還會根據複雜的商業邏輯撰寫出各種與 <code>資料庫</code> 連動的程式。</p><h2 id="自我練習" tabindex="-1">自我練習 <a class="header-anchor" href="#自我練習" aria-hidden="true">#</a></h2><ul><li><p>9.1 執行了 <code>DBConnect3</code> 之後，<code>Shohin 資料表</code> 將成為空無一物的狀態，所以這裡要再次以 <code>範例 1-6</code> 所示的 <code>INSERT 敘述</code>重新存入資料，不過需要透過 <code>Java 程式</code> 來進行，請您先撰寫出 <code>Java 程式</code> 的原始碼，再完成編譯以及執行的動作。</p><div class="warning custom-block"><p class="custom-block-title">範例 1-6</p><p>在 <code>Shohin</code> 資料表中新增資料的 SQL 敘述 (重列)</p><div class="language-SQL"><button title="Copy Code" class="copy"></button><span class="lang">SQL</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">-- DBConnect4 新增資料</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">T恤</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">1000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">打孔機</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">320</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-11</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0003</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">襯衫</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">衣物</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">4000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0004</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">菜刀</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">3000</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">2800</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0005</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">壓力鍋</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">6800</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">5000</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-01-15</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0006</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">叉子</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">500</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-09-20</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0007</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">刨絲器</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">廚房用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">880</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">790</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2008-04-28</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"><span style="color:#F78C6C;">INSERT INTO</span><span style="color:#A6ACCD;"> Shohin </span><span style="color:#F78C6C;">VALUES</span><span style="color:#A6ACCD;"> (</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">0008</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">鋼珠筆</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">辦公用品</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">100</span><span style="color:#A6ACCD;">, </span><span style="color:#F78C6C;">NULL</span><span style="color:#A6ACCD;">, </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">2009-11-11</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">);</span></span>
<span class="line"></span></code></pre></div></div><details class="details custom-block"><summary>練習</summary><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">sql</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">*</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DBConnect4</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 1) 連接至 MariaDB 的資訊 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Connection</span><span style="color:#A6ACCD;"> con</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Statement</span><span style="color:#A6ACCD;"> st</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">jdbc:mariadb://localhost:3306/shop</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> user </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;帳號&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> password </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;密碼&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 2) 載入 JDBC 驅動程式 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    Class</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forName</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">org.mariadb.jdbc.Driver</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 3) 連接至 MariaDB */</span></span>
<span class="line"><span style="color:#A6ACCD;">    con </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> DriverManager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getConnection</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> password</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    st </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> con</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createStatement</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 4) 執行 SELECT 敘述 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeUpdate</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">INSERT INTO Shohin VALUES (&#39;0001&#39;, &#39;T恤&#39;, &#39;衣物&#39;, 1000, 500, &#39;2009-09-20&#39;);</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeUpdate</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">INSERT INTO Shohin VALUES (&#39;0002&#39;, &#39;打孔機&#39;, &#39;辦公用品&#39;, 500, 320, &#39;2009-09-11&#39;);</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeUpdate</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">INSERT INTO Shohin VALUES (&#39;0003&#39;, &#39;襯衫&#39;, &#39;衣物&#39;, 4000, 2800, NULL);</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeUpdate</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">INSERT INTO Shohin VALUES (&#39;0004&#39;, &#39;菜刀&#39;, &#39;廚房用品&#39;, 3000, 2800, &#39;2009-09-20&#39;);</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeUpdate</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">INSERT INTO Shohin VALUES (&#39;0005&#39;, &#39;壓力鍋&#39;, &#39;廚房用品&#39;, 6800, 5000, &#39;2009-01-15&#39;);</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeUpdate</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">INSERT INTO Shohin VALUES (&#39;0006&#39;, &#39;叉子&#39;, &#39;廚房用品&#39;, 500, NULL, &#39;2009-09-20&#39;);</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeUpdate</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">INSERT INTO Shohin VALUES (&#39;0007&#39;, &#39;刨絲器&#39;, &#39;廚房用品&#39;, 880, 790, &#39;2008-04-28&#39;);</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeUpdate</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">INSERT INTO Shohin VALUES (&#39;0008&#39;, &#39;鋼珠筆&#39;, &#39;辦公用品&#39;, 100, NULL, &#39;2009-11-11&#39;);</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 5) 將結果顯示於畫面上 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">print</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">新增了所有紀錄</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 6) 關閉和 MariaDB 之間的連線 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    con</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"></span></code></pre></div></details></li><li><p>9.2 對於問題 9.1 所重新存入的資料，請試著修改其中的部分內容，如下所示將商品「 T恤 」的名稱改為「 <code>Polo 衫</code> 」。</p><ul><li><p>修改前</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th>shohin_catalg</th><th>sell_price</th><th>buying_price</th><th>reg_date</th></tr></thead><tbody><tr><td>0001</td><td>T恤</td><td>衣物</td><td>1000</td><td>500</td><td>2009-09-20</td></tr></tbody></table></li><li><p>修改後</p><table><thead><tr><th>shohin_id</th><th>shohin_name</th><th>shohin_catalg</th><th>sell_price</th><th>buying_price</th><th>reg_date</th></tr></thead><tbody><tr><td>0001</td><td>Polo 衫</td><td>衣物</td><td>1000</td><td>500</td><td>2009-09-20</td></tr></tbody></table></li></ul><p>請您撰寫出完成此修改動作的 Java 程式原始碼，並且完成編譯以及執行的動作。</p><details class="details custom-block"><summary>練習</summary><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-palenight"><code><span class="line"><span style="color:#F78C6C;">import</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">java</span><span style="color:#89DDFF;">.</span><span style="color:#C792EA;">sql</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">*</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DBConnect5</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">static</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">main</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">String</span><span style="color:#89DDFF;">[]</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">args</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">throws</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">Exception</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 1) 連接至 MariaDB 的資訊 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Connection</span><span style="color:#A6ACCD;"> con</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">Statement</span><span style="color:#A6ACCD;"> st</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> url </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">jdbc:mariadb://localhost:3306/shop</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> user </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;帳號&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">String</span><span style="color:#A6ACCD;"> password </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">&lt;密碼&gt;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 2) 載入 JDBC 驅動程式 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    Class</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">forName</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">org.mariadb.jdbc.Driver</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 3) 連接至 MariaDB */</span></span>
<span class="line"><span style="color:#A6ACCD;">    con </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> DriverManager</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">getConnection</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;">url</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> password</span><span style="color:#89DDFF;">);</span></span>
<span class="line"><span style="color:#A6ACCD;">    st </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> con</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createStatement</span><span style="color:#89DDFF;">();</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 4) 執行 SELECT 敘述 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">executeUpdate</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">UPDATE Shohin SET shohin_name = &#39;Polo 衫&#39; WHERE shohin_name = &#39;T恤&#39;;</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 5) 將結果顯示於畫面上 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    System</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">out</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">資料已變更為 Polo 衫</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#676E95;font-style:italic;">/* 6) 關閉和 MariaDB 之間的連線 */</span></span>
<span class="line"><span style="color:#A6ACCD;">    st</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">    con</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">close</span><span style="color:#89DDFF;">();</span></span>
<span class="line"><span style="color:#A6ACCD;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div></details></li></ul></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-c5936a1e data-v-e033cd21><!----><div class="prev-next" data-v-e033cd21><div class="pager" data-v-e033cd21><a class="pager-link prev" href="/vitepress-SQL-zero/guide/chapter_8.html" data-v-e033cd21><span class="desc" data-v-e033cd21>Previous page</span><span class="title" data-v-e033cd21>第 8 章 SQL 進階處理功能</span></a></div><div class="has-prev pager" data-v-e033cd21><!----></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-93a960b4 data-v-d24360a6><div class="container" data-v-d24360a6><!----><p class="copyright" data-v-d24360a6>MIT Lincensed | Copyright © 2023-present Eason</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"guide_chapter_0.md\":\"de036069\",\"guide_chapter_1.md\":\"ca727084\",\"guide_chapter_2.md\":\"a4eb522b\",\"guide_chapter_3.md\":\"4a9ef05f\",\"guide_chapter_5.md\":\"3d608a90\",\"guide_chapter_4.md\":\"443483c4\",\"index.md\":\"04c6d6e3\",\"guide_chapter_8.md\":\"6e316234\",\"guide_chapter_7.md\":\"dbd1dc90\",\"guide_chapter_9.md\":\"9c9f9594\",\"guide_chapter_6.md\":\"fdc0f91d\"}")</script>
    <script type="module" async src="/vitepress-SQL-zero/assets/app.12066fee.js"></script>
    
  </body>
</html>